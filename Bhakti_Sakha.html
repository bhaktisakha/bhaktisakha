<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#0d1b2a">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192x192.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Bhakti Sakha">
<meta name="mobile-web-app-capable" content="yes">
<meta name="msapplication-TileColor" content="#0d1b2a">
<meta name="msapplication-TileImage" content="icon-144x144.png">
<title>Bhakti Sakha</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Philosopher:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0d1b2a;
  --bg2: #112035;
  --bg3: #162847;
  --card: #1a3050;
  --border: rgba(255,255,255,0.08);
  --accent-blue: #3d7fd4;
  --accent-red: #c0392b;
  --accent-gold: #d4a017;
  --accent-green: #27ae60;
  --text: #e8edf2;
  --text2: #8fa8c0;
  --text3: #5a7a99;
  --ekadashi-green: #1a7a3a;
  --appearance-yellow: #7a6800;
  --festival-saffron: #b05000;
  
  --today-ring: #4a90d9;
  --lavender: #a78bfa;
  --lavender-glow: rgba(167,139,250,0.4);
  --selected-ring: #c0392b;
}
* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
html,body { height:100%; overflow:hidden; }
body {
  font-family: 'Inter', system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  display: flex;
  flex-direction: column;
  max-width: 430px;
  margin: 0 auto;
  position: relative;
}

/* ===== APP BRAND BAR ===== */
.app-brand {
  background:linear-gradient(135deg, var(--bg2) 0%, rgba(17,32,53,0.97) 100%);
  padding:10px 18px;
  display:flex; align-items:center; justify-content:center; gap:10px;
  flex-shrink:0;
  border-bottom:1px solid rgba(167,139,250,0.12);
  position:relative;
  overflow:hidden;
}
.app-brand::before {
  content:''; position:absolute; inset:0;
  background:radial-gradient(ellipse at 50% 100%, rgba(167,139,250,0.06) 0%, transparent 70%);
  pointer-events:none;
}
.app-brand-logo {
  width:28px; height:28px; flex-shrink:0; position:relative; z-index:1;
  filter:drop-shadow(0 0 8px rgba(232,200,0,0.25));
}
.app-brand-logo:last-of-type {
  filter:drop-shadow(0 0 8px rgba(236,140,180,0.3));
}
.app-brand-logo[alt="Lotus"] {
  width:30px; height:auto;
  border-radius:4px;
}
.app-brand-name {
  font-family:'Philosopher', serif;
  font-size:1.2rem; font-weight:700;
  background:linear-gradient(135deg, #e8c800 0%, #f0d860 40%, #e8c800 70%, #c8a800 100%);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  background-clip:text;
  letter-spacing:1px;
  position:relative; z-index:1;
}
.app-brand-sub {
  font-size:0.55rem; color:var(--text3);
  letter-spacing:2px; text-transform:uppercase;
  position:relative; z-index:1;
  margin-left:2px;
}

/* ===== HEADER ===== */
.header {
  background: var(--bg2);
  padding: 12px 18px 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-shrink: 0;
  border-bottom: 1px solid var(--border);
}
.header-date-wrap {
  display: flex; flex-direction: column;
}
.header-date {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text);
  letter-spacing: 0.2px;
}
.header-masa {
  font-size: 0.72rem;
  color: var(--text3);
  margin-top: 1px;
  letter-spacing: 0.3px;
}
.header-icons { display:flex; gap:14px; align-items:center; }
.header-icons button {
  background: none; border: none; color: var(--text2);
  cursor: pointer; padding: 4px; font-size: 1.1rem;
  transition: color 0.2s;
}
.header-icons button:active { color: var(--text); }
.header.header-songs { justify-content:center; }
.header.header-songs .header-date-wrap { width:100%; text-align:center; }
.header-date.songs-title {
  font-family:'Playfair Display', serif;
  font-style:italic; font-weight:600;
  font-size:1.2rem; letter-spacing:0.5px;
  background:linear-gradient(135deg, #c9a84c, #f0d68a, #c9a84c);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  background-clip:text;
}

/* ===== SCREENS ===== */
.screens { flex:1; overflow:hidden; display:flex; flex-direction:column; }
.screen { display:none; flex-direction:column; height:100%; overflow:hidden; }
.screen.active { display:flex; }


/* ===== CALENDAR LOCATION BAR ===== */
.cal-loc-bar {
  display:flex; align-items:center; gap:5px;
  padding:5px 18px 7px;
  background:var(--bg2);
  cursor:pointer;
  border-bottom:1px solid var(--border);
  flex-shrink:0;
}
.cal-loc-bar svg { color:var(--accent-gold); stroke:var(--accent-gold); flex-shrink:0; }
.cal-loc-bar span:first-of-type {
  font-size:0.75rem; color:var(--accent-gold); font-weight:500; flex:1;
}
.cal-loc-change {
  font-size:0.68rem !important; color:var(--accent-blue) !important;
  font-weight:400 !important; text-decoration:underline; flex:0 !important;
}

/* ===== CALENDAR ===== */
.cal-wrapper { display:flex; flex-direction:column; height:100%; overflow:hidden; min-height:0; }

/* Month nav */
.month-nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 18px 8px;
  background: var(--bg2);
  flex-shrink: 0;
}
.month-nav-btn {
  background: none; border: none; color: var(--text2);
  font-size: 1.1rem; cursor: pointer; padding: 4px 10px;
  transition: color 0.2s;
}
.month-nav-btn:active { color: var(--text); }
.month-display { text-align:center; }
.month-name {
  font-size: 1rem; font-weight: 600; color: var(--text);
  display: block; line-height: 1.2;
}
.month-vaishnava {
  font-size: 0.68rem; color: var(--accent-gold);
}

/* Day headers */
.day-headers {
  display: grid; grid-template-columns: repeat(7,1fr);
  padding: 6px 8px 2px;
  background: var(--bg2);
  flex-shrink: 0;
}
.day-hdr {
  text-align:center; font-size: 0.7rem;
  color: var(--text3); font-weight: 500; letter-spacing: 0.5px;
  text-transform: uppercase; padding: 2px 0;
}

/* Days grid */
.days-grid-wrap {
  padding: 4px 8px 8px;
  background: var(--bg2);
  flex-shrink: 0;
}
.days-grid {
  display: grid; grid-template-columns: repeat(7,1fr); column-gap: 3px; row-gap: 8px;
}
.day-cell {
  display: flex; flex-direction:column; align-items:center;
  padding: 5px 1px; cursor: pointer;
  min-width: 0;
  justify-content: center; transition: background 0.15s;
  position: relative;
}
/* Date number â€” plain, no circle */
.day-num {
  font-size: 0.9rem; font-weight: 400;
  color: var(--text); line-height: 1;
  width: 30px; height: 30px;
  display: flex; align-items: center; justify-content: center;
  border-radius: 8px;
  transition: background 0.2s, color 0.2s, box-shadow 0.2s;
}
.day-cell.other-month { opacity: 0.10; }
.day-cell.other-month .day-num { color: var(--text3); }

/* â”€â”€ SOFT PILL GLOW â€” Option 2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
/* Ekadashi flag icon */
.ek-flag {
  position: absolute;
  top: 0px;
  right: 2px;
  pointer-events: none;
  z-index: 2;
}
.ek-flag-inline {
  vertical-align: middle;
  margin-right: 2px;
  position: relative;
  top: -1px;
}
/* Ekadashi â€” emerald green soft pill */
.day-cell.has-ekadashi .day-num {
  background: linear-gradient(135deg, rgba(29,185,84,0.28), rgba(17,120,54,0.18));
  color: #5eed7e; font-weight: 700;
  border-radius: 10px;
  box-shadow: 0 0 12px 2px rgba(45,184,77,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
}
/* Appearance â€” warm gold soft pill */
.day-cell.has-appearance .day-num {
  background: linear-gradient(135deg, rgba(212,168,0,0.30), rgba(160,120,0,0.18));
  color: #f5d040; font-weight: 700;
  border-radius: 10px;
  box-shadow: 0 0 12px 2px rgba(200,168,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
}
/* Festival â€” saffron soft pill */
.day-cell.has-festival .day-num {
  background: linear-gradient(135deg, rgba(224,120,0,0.28), rgba(160,80,0,0.18));
  color: #ffaa40; font-weight: 700;
  border-radius: 10px;
  box-shadow: 0 0 12px 2px rgba(224,120,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
}

/* â”€â”€ TODAY â€” lavender soft pill glow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.day-cell.today .day-num {
  background: linear-gradient(135deg, rgba(139,92,246,0.30), rgba(109,40,217,0.20));
  color: #c4b5fd; font-weight: 700;
  border-radius: 10px;
  box-shadow: 0 0 14px 3px rgba(139,92,246,0.45), inset 0 1px 0 rgba(255,255,255,0.12);
}
/* Selected â€” solid lavender pill */
.day-cell.selected .day-num {
  background: var(--lavender);
  color: white; font-weight: 700;
  border-radius: 10px;
  box-shadow: 0 0 10px 2px var(--lavender-glow), 0 2px 6px rgba(139,92,246,0.3);
  text-shadow: 0 1px 4px rgba(255,255,255,0.3);
}
/* Today + selected */
.day-cell.today.selected .day-num {
  background: var(--lavender);
  box-shadow: 0 0 12px 3px var(--lavender-glow), 0 2px 6px rgba(139,92,246,0.35);
}
/* Today + event: event glow, lavender outline */
.day-cell.today.has-ekadashi .day-num {
  background: linear-gradient(135deg, rgba(29,185,84,0.32), rgba(17,120,54,0.22));
  color: #5eed7e;
  box-shadow: 0 0 14px 3px rgba(45,184,77,0.4), 0 0 0 2px rgba(139,92,246,0.6);
}
.day-cell.today.has-appearance .day-num {
  background: linear-gradient(135deg, rgba(212,168,0,0.34), rgba(160,120,0,0.22));
  color: #f5d040;
  box-shadow: 0 0 14px 3px rgba(200,168,0,0.4), 0 0 0 2px rgba(139,92,246,0.6);
}
.day-cell.today.has-festival .day-num {
  background: linear-gradient(135deg, rgba(224,120,0,0.32), rgba(160,80,0,0.22));
  color: #ffaa40;
  box-shadow: 0 0 14px 3px rgba(224,120,0,0.4), 0 0 0 2px rgba(139,92,246,0.6);
}

/* dot indicators â€” keep as tiny accent dots below number */
.day-dot-row { display:flex; gap:2px; margin-top:3px; justify-content:center; }
.day-dot { width:3px; height:3px; border-radius:50%; opacity:0.7; }
.day-dot.ekadashi  { background:#2db84d; }
.day-dot.appearance{ background:#c8a800; }
.day-dot.festival  { background:#e07800; }

/* ===== DAY DETAIL PANEL ===== */
.day-detail {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  background: var(--bg);
  padding: 0 0 100px;
}

/* Fast notice bar */
.fast-notice {
  background: transparent;
  padding: 14px 18px 4px;
  display: none;
}
.fast-notice.visible { display: block; }
.fast-text {
  color: #e74c3c;
  font-size: 0.9rem;
  font-style: italic;
  font-weight: 400;
  line-height: 1.4;
}

/* Festival row */
.festival-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 18px;
  border-bottom: 1px solid var(--border);
  cursor: pointer;
  display: none;
  border-left: 3px solid transparent;
}
.festival-row.visible { display:flex; }
.festival-row.type-ekadashi { border-left-color: #2db84d; background: rgba(34,139,58,0.05); }
.festival-row.type-appearance { border-left-color: #c8a800; background: rgba(230,200,0,0.06); }
.festival-row.type-festival { border-left-color: #e07800; background: rgba(210,100,0,0.06); }
.festival-row-name {
  font-size: 0.95rem;
  color: var(--text);
  font-weight: 400;
}
.festival-row.type-ekadashi .festival-row-name { color: #4ddb6e; }
.festival-row.type-appearance .festival-row-name { color: #e8c800; }
.festival-row.type-festival .festival-row-name { color: #f08c1a; }
.festival-row-arrow { color: var(--text2); font-size: 0.9rem; }

/* Gaurabda / Masa / Tithi row */
.panchanga-row {
  display: flex;
  gap: 0;
  padding: 14px 18px 10px;
  border-bottom: 1px solid var(--border);
  justify-content: center;
}
.pancha-item { flex: 0 1 110px; min-width: 0; text-align: center; }
.pancha-label {
  font-size: 0.68rem; color: var(--text3);
  text-transform: uppercase; letter-spacing: 0.8px;
  margin-bottom: 4px; display: block;
}
.pancha-value {
  font-size: 1.0rem; color: var(--text);
  font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.pancha-dots {
  color: var(--text3); font-size: 1.1rem;
  display: flex; align-items: flex-start;
  padding-top: 8px;
}

/* Sun Moon section */
.sun-moon-section {
  display: grid;
  grid-template-columns: 1fr 1fr;
  padding: 14px 18px;
  gap: 20px;
  border-bottom: 1px solid var(--border);
}
.sm-col {}
.sm-header {
  display: flex; align-items: center; gap: 8px;
  margin-bottom: 10px;
}
.sm-icon { font-size: 1.4rem; }

.sm-row {
  display: flex; justify-content: space-between;
  align-items: baseline;
  margin-bottom: 6px;
}
.sm-label {
  font-size: 0.8rem; color: var(--text2); font-weight: 400;
}
.sm-value {
  font-size: 0.85rem; color: var(--text);
  font-weight: 500; text-align: right;
}

/* Gayatri section */
.gayatri-section {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border);
  text-align: center;
}
.gayatri-title {
  font-size: 0.68rem; color: var(--text3);
  text-transform: uppercase; letter-spacing: 1.2px;
  margin-bottom: 14px; text-align: center;
}
.gayatri-grid {
  display: grid; grid-template-columns: repeat(3,1fr); gap: 10px;
  justify-items: center;
}
.gayatri-item { text-align:center; }
.g-sandhya-icon { width:32px; height:32px; border-radius:50%; margin:0 auto 6px; box-shadow:0 2px 8px rgba(0,0,0,0.3); overflow:hidden; }
.g-sandhya-icon svg { width:32px; height:32px; display:block; }
.g-sandhya { font-size:0.88rem; display:block; margin-bottom:5px; letter-spacing:0.2px; font-weight:700; text-transform:none; }
.g-time { font-size:1.05rem; font-weight:600; }
/* Pratah â€” dark saffron */
.g-pratah .g-sandhya { color:#e8720c; text-shadow:0 0 8px rgba(232,114,12,0.4); }
.g-pratah .g-time    { color:#f08030; }
/* Madhyahnika â€” golden yellow */
.g-madhya .g-sandhya { color:#d4a017; text-shadow:0 0 8px rgba(212,160,23,0.4); }
.g-madhya .g-time    { color:#e8b820; }
/* Sayam â€” dark rose */
.g-sayam .g-sandhya  { color:#c0306a; text-shadow:0 0 8px rgba(192,48,106,0.4); }
.g-sayam .g-time     { color:#d84080; }
.g-sub { font-size:0.6rem; color:var(--text3); display:block; margin-top:2px; }

/* ===== UNIFIED EVENTS BLOCK ===== */
.events-block {
  border-bottom: 1px solid var(--border);
}
.evt-row {
  display: flex; align-items: center;
  padding: 10px 18px; gap: 10px;
  border-left: 3px solid transparent;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  cursor: pointer; transition: background 0.15s;
}
.evt-row:last-child { border-bottom: none; }
.evt-row:active { background: rgba(255,255,255,0.04); }
.evt-row.type-ekadashi  { border-left-color: #2db84d; background: rgba(34,139,58,0.05); }
.evt-row.type-appearance{ border-left-color: #c8a800; background: rgba(230,200,0,0.04); }
.evt-row.type-festival  { border-left-color: #e07800; background: rgba(210,100,0,0.05); }
.evt-row-name {
  flex: 1; font-size: 0.9rem; font-weight: 500; line-height: 1.3;
}
.type-ekadashi  .evt-row-name { color: #4ddb6e; }
.type-appearance .evt-row-name { color: #e8c800; }
.type-festival  .evt-row-name { color: #f08c1a; }
.evt-row-arrow { color: var(--text3); font-size: 0.85rem; flex-shrink:0; }
/* Show more toggle */
.evt-show-more {
  display: flex; align-items: center; justify-content: center;
  gap: 6px; padding: 9px 18px;
  font-size: 0.75rem; color: var(--accent-blue);
  cursor: pointer; border-top: 1px solid var(--border);
  background: rgba(61,127,212,0.04);
  transition: background 0.15s;
}
.evt-show-more:active { background: rgba(61,127,212,0.1); }
.evt-show-more svg { transition: transform 0.25s; }
.evt-show-more.open svg { transform: rotate(180deg); }
/* Collapsed extra rows */
.evt-extra { display: none; }
.evt-extra.visible { display: flex; }

/* Custom events in detail */
.custom-event-row {
  display:flex; align-items:center; gap:10px;
  padding: 10px 18px;
  border-bottom: 1px solid var(--border);
  background: rgba(39,174,96,0.05);
  border-left: 3px solid var(--accent-green);
}

/* Empty day */
.empty-day {
  text-align:center; padding:30px 20px;
  color: var(--text3); font-size:0.85rem; font-style:italic;
}

/* ===== SEARCH SCREEN ===== */
.search-screen { padding: 16px 16px 100px; overflow-y:auto; }
.screen-title {
  font-size:1.1rem; font-weight:600; color:var(--text);
  margin-bottom:14px; padding-bottom:10px;
  border-bottom:1px solid var(--border);
}
.search-box {
  position:relative; margin-bottom:14px;
}
.search-input {
  width:100%; background:var(--card);
  border:1.5px solid var(--border); border-radius:12px;
  padding:11px 16px 11px 42px;
  color:var(--text); font-size:0.95rem; outline:none;
  font-family: inherit; transition:border-color 0.2s;
}
.search-input:focus { border-color:var(--accent-blue); }
.search-input::placeholder { color:var(--text3); }
.search-box-icon { position:absolute; left:14px; top:50%; transform:translateY(-50%); color:var(--text2); }
.filter-row { display:flex; gap:8px; margin-bottom:16px; flex-wrap:wrap; }
.fc { background:var(--card); border:1px solid var(--border); border-radius:20px;
  padding:6px 14px; font-size:0.75rem; color:var(--text2);
  cursor:pointer; font-family:inherit; transition:all 0.2s; }
.fc.active { background:rgba(61,127,212,0.2); border-color:var(--accent-blue); color:var(--accent-blue); }
.s-result {
  background:var(--card); border:1px solid var(--border); border-radius:12px;
  padding:12px 14px; margin-bottom:8px;
  display:flex; align-items:flex-start; gap:12px;
  cursor:pointer; transition:background 0.2s;
}
.s-result:active { background:var(--bg3); }
.s-icon { width:38px; height:38px; border-radius:10px; background:rgba(255,255,255,0.06);
  display:flex; align-items:center; justify-content:center; font-size:1.1rem; flex-shrink:0; }
.s-name { font-size:0.9rem; color:var(--text); margin-bottom:3px; }
.s-date { font-size:0.75rem; color:var(--accent-gold); font-style:italic; margin-bottom:2px; }
.s-desc { font-size:0.72rem; color:var(--text3); line-height:1.4; }
.s-tag { font-size:0.68rem; color:var(--text3); background:rgba(255,255,255,0.06); border-radius:8px; padding:3px 8px; align-self:flex-start; white-space:nowrap; }

/* Jump to date */
.jump-section { margin-top:20px; padding-top:16px; border-top:1px solid var(--border); }
.jump-title { font-size:0.9rem; font-weight:600; color:var(--text); margin-bottom:12px; }
.jump-row { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:10px; }
.f-select {
  background:var(--card); border:1.5px solid var(--border); border-radius:10px;
  padding:10px 12px; color:var(--text); font-size:0.88rem;
  outline:none; font-family:inherit; width:100%;
}
.f-select option { background:var(--bg2); }
.jump-btn {
  width:100%; background:var(--accent-blue); border:none;
  border-radius:12px; padding:13px; color:white;
  font-size:0.95rem; font-family:inherit; cursor:pointer;
  transition:opacity 0.2s;
}
.jump-btn:active { opacity:0.8; }

/* ===== SONGS ===== */
.songs-screen { overflow-y:auto; padding:0 0 80px; }
.songs-toolbar {
  flex-shrink:0;
  background:var(--bg2); border-bottom:1px solid var(--border);
  padding:10px 16px; display:flex; align-items:center; gap:8px;
}
.songs-sort-btn {
  background:var(--card); border:1px solid var(--border); border-radius:8px;
  padding:5px 10px; color:var(--text2); font-size:0.72rem; cursor:pointer;
  font-family:inherit; transition:all 0.2s; white-space:nowrap;
}
.songs-sort-btn.active { background:rgba(61,127,212,0.15); border-color:var(--accent-blue); color:var(--accent-blue); }
.songs-font-ctrl {
  display:flex; align-items:center; gap:4px; margin-left:auto;
}
.songs-font-btn {
  background:var(--card); border:1px solid var(--border); border-radius:8px;
  width:30px; height:28px; color:var(--text2); font-size:0.9rem; cursor:pointer;
  font-family:inherit; display:flex; align-items:center; justify-content:center;
  transition:all 0.2s;
}
.songs-font-btn:active { opacity:0.7; }
.songs-font-label { font-size:0.66rem; color:var(--text3); min-width:24px; text-align:center; }
.songs-list { padding:12px 16px; }
.cat-title {
  font-size:0.72rem; color:var(--text3); text-transform:uppercase;
  letter-spacing:1px; padding:14px 0 6px;
  border-bottom:1px solid var(--border); margin-bottom:10px;
  display:flex; align-items:center; gap:6px;
}
.cat-title:first-child { padding-top:4px; }
/* Category folder cards */
.cat-folders-grid {
  display:grid; grid-template-columns:1fr 1fr; gap:12px; padding:16px;
}
.cat-folder-card {
  position:relative; background: linear-gradient(145deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  border:1px solid rgba(255,255,255,0.08); border-radius:16px;
  padding:20px 14px 16px; cursor:pointer; text-align:center;
  transition: all 0.25s ease; overflow:hidden;
}
.cat-folder-card::before {
  content:''; position:absolute; top:0; left:0; right:0; height:3px;
  border-radius:16px 16px 0 0; opacity:0.8;
}
.cat-folder-card[data-cat="vbhajan"]::before { background: linear-gradient(90deg, #f472b6, #ec4899); }
.cat-folder-card[data-cat="hkkirtan"]::before { background: linear-gradient(90deg, #818cf8, #6366f1); }
.cat-folder-card[data-cat="astakam"]::before { background: linear-gradient(90deg, #fb923c, #f97316); }
.cat-folder-card[data-cat="stotram"]::before { background: linear-gradient(90deg, #34d399, #10b981); }
.cat-folder-card[data-cat="gita"]::before { background: linear-gradient(90deg, #a3e635, #84cc16); }
.cat-folder-card[data-cat="bhagavatam"]::before { background: linear-gradient(90deg, #38bdf8, #0ea5e9); }
.cat-folder-card[data-cat="samhita"]::before { background: linear-gradient(90deg, #e879f9, #a855f7); }
.cat-folder-card:active { transform:scale(0.97); background:rgba(255,255,255,0.08); }
.cat-folder-icon { font-size:2.2rem; margin-bottom:10px; filter:drop-shadow(0 2px 8px rgba(0,0,0,0.3)); }
.cat-folder-name { font-size:0.82rem; font-weight:600; color:var(--text); line-height:1.3; margin-bottom:4px; }
.cat-folder-count { font-size:0.68rem; color:var(--text3); }
.cat-folder-card:hover { border-color:rgba(255,255,255,0.15); box-shadow:0 4px 20px rgba(0,0,0,0.2); }
/* Category detail header */
.cat-detail-header {
  display:flex; align-items:center; gap:10px; padding:12px 16px;
  background:var(--bg2); border-bottom:1px solid var(--border);
}
.cat-back-btn {
  display:flex; align-items:center; gap:4px;
  background:none; border:none; color:var(--accent-blue);
  font-family:inherit; font-size:0.85rem; cursor:pointer; padding:4px 0;
}
.cat-detail-title { font-size:0.95rem; font-weight:600; color:var(--text); }
.cat-detail-count { font-size:0.72rem; color:var(--text3); margin-left:auto; }
.song-card {
  display:flex; align-items:center; justify-content:space-between;
  padding:11px 14px; border-bottom:1px solid var(--border);
  cursor:pointer; transition:background 0.15s; gap:10px;
}
.song-card:active { background:rgba(61,127,212,0.08); }
.song-card.now-playing { background:rgba(61,127,212,0.06); }
.song-info { flex:1; min-width:0; }
.song-title-text { font-size:0.88rem; color:var(--text); line-height:1.3; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; flex:1; min-width:0; }
.song-by { font-size:0.7rem; color:var(--text3); margin-top:1px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.song-official { display:none; } /* shown in detail page only */
.song-row-arrow { color:var(--text3); font-size:0.85rem; flex-shrink:0; }

/* ===== NOW PLAYING ICON IN SONG LIST ===== */
.now-playing-icon {
  display:flex; align-items:center; gap:3px; flex-shrink:0;
  padding:4px 6px; border-radius:6px;
  background:rgba(61,127,212,0.12);
  cursor:pointer; transition:background 0.2s;
}
.now-playing-icon:active { background:rgba(61,127,212,0.25); }
.now-playing-bars {
  display:flex; align-items:flex-end; gap:1.5px; height:14px;
}
.now-playing-bars span {
  display:block; width:2.5px; border-radius:1.5px;
  background:var(--accent-blue);
  animation:np-bar 1.2s ease-in-out infinite;
}
.now-playing-bars span:nth-child(1) { height:40%; animation-delay:0s; }
.now-playing-bars span:nth-child(2) { height:70%; animation-delay:0.2s; }
.now-playing-bars span:nth-child(3) { height:50%; animation-delay:0.4s; }
.now-playing-bars span:nth-child(4) { height:80%; animation-delay:0.15s; }
@keyframes np-bar {
  0%,100% { transform:scaleY(0.4); opacity:0.6; }
  50% { transform:scaleY(1); opacity:1; }
}

/* ===== MINI NOW-PLAYING BAR ===== */
.now-playing-bar {
  position:fixed; bottom:57px; left:0; right:0; max-width:430px; margin:0 auto;
  z-index:99;
  display:none; /* hidden by default */
}
.now-playing-bar.visible { display:block; }
.now-playing-bar-inner {
  margin:0 8px 4px;
  background:linear-gradient(135deg, #1a3050 0%, #162847 100%);
  border:1px solid rgba(61,127,212,0.2);
  border-radius:14px;
  padding:8px 12px;
  display:flex; align-items:center; gap:10px;
  cursor:pointer;
  box-shadow:0 -2px 16px rgba(0,0,0,0.3), 0 0 0 1px rgba(61,127,212,0.08);
  transition:background 0.2s, transform 0.15s;
}
.now-playing-bar-inner:active { transform:scale(0.985); background:linear-gradient(135deg, #1e3660 0%, #1a3050 100%); }
.np-bar-icon {
  display:flex; align-items:center; justify-content:center;
  width:32px; height:32px; border-radius:10px;
  background:rgba(61,127,212,0.15);
  flex-shrink:0;
}
.np-bar-icon .now-playing-bars { height:16px; }
.np-bar-icon .now-playing-bars span { width:2.5px; background:var(--accent-blue); }
.np-bar-info { flex:1; min-width:0; }
.np-bar-title {
  font-size:0.82rem; font-weight:500; color:var(--text);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  line-height:1.3;
}
.np-bar-subtitle {
  font-size:0.68rem; color:var(--text3);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  line-height:1.3; margin-top:1px;
}
.np-bar-close {
  display:flex; align-items:center; justify-content:center;
  width:28px; height:28px; border-radius:50%;
  background:rgba(255,255,255,0.06);
  border:none; color:var(--text3); font-size:0.85rem;
  cursor:pointer; flex-shrink:0; transition:background 0.15s;
}
.np-bar-close:active { background:rgba(255,255,255,0.12); }

/* Adjust bottom padding on screens when now-playing bar is visible */
.has-now-playing #songsContent { padding-bottom:160px !important; }
.has-now-playing .screen { scroll-padding-bottom:160px; }

/* ===== PERSISTENT AUDIO CONTAINER (hidden) ===== */
#persistentAudioWrap { position:fixed; top:-9999px; left:-9999px; width:0; height:0; overflow:hidden; pointer-events:none; }
/* Song detail page */
.song-detail-wrap { display:flex; flex-direction:column; height:100%; }
.song-detail-header {
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 16px; background:var(--bg2);
  border-bottom:1px solid var(--border); flex-shrink:0;
}
.song-back-btn {
  display:flex; align-items:center; gap:4px;
  background:none; border:none; color:var(--accent-blue);
  font-family:inherit; font-size:0.88rem; cursor:pointer; padding:4px 0;
}
.song-detail-hdr-actions { display:flex; gap:8px; align-items:center; }
.song-lang-sel {
  background:rgba(61,127,212,0.12); border:1px solid rgba(61,127,212,0.3);
  color:var(--accent-blue); font-family:inherit; font-size:0.72rem; font-weight:600;
  padding:4px 6px; border-radius:8px; cursor:pointer;
  -webkit-appearance:none; appearance:none; text-align:center;
  min-width:58px;
}
.song-lang-sel option { background:var(--bg2); color:var(--text); }
.song-detail-body {
  flex:1; overflow-y:auto; padding:20px 18px 100px;
}
.sd-title { font-size:1.3rem; font-weight:700; color:var(--text); line-height:1.3; margin-bottom:4px; }
.sd-official { font-size:0.85rem; color:var(--accent-gold); font-style:italic; margin-bottom:10px; }
.sd-meta { display:flex; flex-wrap:wrap; gap:6px; margin-bottom:18px; }
.sd-badge {
  font-size:0.68rem; padding:3px 10px; border-radius:20px;
  background:rgba(61,127,212,0.12); border:1px solid rgba(61,127,212,0.25);
  color:var(--accent-blue);
}
.sd-section-lbl { font-size:0.62rem; color:var(--text3); text-transform:uppercase; letter-spacing:1px; margin-bottom:8px; font-weight:600; }
.sd-info-card {
  background:var(--card); border:1px solid var(--border);
  border-radius:14px; overflow:hidden; margin-bottom:20px;
}
.sd-info-row {
  display:flex; align-items:baseline; justify-content:space-between;
  padding:10px 14px; gap:12px;
  border-bottom:1px solid var(--border);
}
.sd-info-row:last-child { border-bottom:none; }
.sd-info-label {
  font-size:0.72rem; color:var(--text3); flex-shrink:0;
  min-width:90px; text-transform:uppercase; letter-spacing:0.4px; font-weight:500;
}
.sd-info-value {
  font-size:0.85rem; color:var(--text); text-align:right; line-height:1.4;
}
.sd-cat-change-btn {
  background:rgba(167,139,250,0.12); border:1px solid rgba(167,139,250,0.25);
  border-radius:6px; padding:2px 8px; font-size:0.65rem; font-weight:600;
  color:var(--lavender); cursor:pointer; margin-left:6px; vertical-align:middle;
}
.sd-cat-change-btn:active { background:rgba(167,139,250,0.25); }
.sd-cat-changer { padding:8px 0 12px; }
.sd-cat-options { display:flex; flex-wrap:wrap; gap:8px; }
.sd-cat-opt {
  background:rgba(255,255,255,0.04); border:1px solid var(--border);
  border-radius:10px; padding:8px 14px; font-size:0.78rem; color:var(--text2);
  cursor:pointer; transition:all 0.15s;
}
.sd-cat-opt:active { transform:scale(0.96); }
.sd-cat-opt.current { border-color:var(--accent-gold); color:var(--accent-gold); background:rgba(201,168,76,0.1); }
.sd-lyrics { white-space:pre-line; line-height:1.6; color:var(--text); margin-bottom:20px; }
.sd-trans { white-space:pre-line; line-height:1.5; color:var(--text2); font-style:italic; }
.sd-trans-cards { display:flex; flex-direction:column; gap:16px; }
.sd-trans-card {
  background:rgba(61,127,212,0.04);
  border:1px solid rgba(61,127,212,0.12);
  border-radius:14px; padding:14px 16px;
  box-shadow:0 0 12px rgba(61,127,212,0.06), 0 2px 8px rgba(0,0,0,0.15);
  transition:box-shadow 0.3s;
  position:relative;
}
.sd-trans-card:hover { box-shadow:0 0 18px rgba(61,127,212,0.12), 0 4px 12px rgba(0,0,0,0.2); }
.sd-trans-num {
  position:absolute; top:5px; left:5px;
  min-width:15px; height:15px; border-radius:8px; padding:0 4px;
  background:rgba(61,127,212,0.2); border:1px solid rgba(61,127,212,0.35);
  display:flex; align-items:center; justify-content:center;
  font-size:0.44rem; font-weight:700; color:var(--accent-blue);
  font-style:normal;
}
.sd-trans-text {
  font-size:0.84rem; color:var(--text2); line-height:1.65;
  font-style:italic; width:100%; text-align:center;
}
/* Lyrics verse cards */
.sd-verse-cards { display:flex; flex-direction:column; gap:16px; }
.sd-verse-card {
  background:rgba(201,168,76,0.04);
  border:1px solid rgba(201,168,76,0.12);
  border-radius:14px; padding:14px 16px;
  box-shadow:0 0 12px rgba(201,168,76,0.06), 0 2px 8px rgba(0,0,0,0.15);
  transition:box-shadow 0.3s;
  position:relative;
}
.sd-verse-card:hover { box-shadow:0 0 18px rgba(201,168,76,0.12), 0 4px 12px rgba(0,0,0,0.2); }
.sd-verse-num {
  position:absolute; top:5px; left:5px;
  min-width:15px; height:15px; border-radius:8px; padding:0 4px;
  background:rgba(201,168,76,0.2); border:1px solid rgba(201,168,76,0.35);
  display:flex; align-items:center; justify-content:center;
  font-size:0.44rem; font-weight:700; color:var(--accent-gold);
}
.sd-verse-text {
  font-size:0.88rem; color:var(--text); line-height:1.6;
  white-space:pre-line; width:100%; text-align:center;
}
.sd-divider { height:1px; background:var(--border); margin:16px 0; }
.lyrics-text { color:var(--text); line-height:1.6; white-space:pre-line; }
.lyrics-trans { margin-top:12px; padding-top:12px; border-top:1px dashed var(--border);
  color:var(--text2); font-style:italic; line-height:1.7; white-space:pre-line; }
/* Multi-audio player */
.audio-list { display:flex; flex-direction:column; gap:8px; margin-bottom:12px; }
.audio-item {
  background:rgba(61,127,212,0.06); border:1px solid rgba(61,127,212,0.15);
  border-radius:10px; padding:10px 12px;
}
.audio-singer {
  font-size:0.70rem; color:var(--accent-gold); font-weight:500;
  margin-bottom:5px; display:flex; align-items:center; gap:5px;
}
.audio-singer::before { content:'ðŸŽ¤'; font-size:0.75rem; }
.audio-item audio { width:100%; height:32px; accent-color:var(--accent-blue); display:block; }
.audio-item.no-singer audio { /* no singer label, compact */ }


/* ===== KIRTAN SEARCH & TOPBAR ===== */
.kirtan-topbar {
  background:var(--bg2); border-bottom:1px solid var(--border);
  flex-shrink:0; position:relative; z-index:10;
}
.kirtan-search-wrap {
  display:flex; align-items:center; gap:8px;
  padding:10px 14px 8px; position:relative;
}
.kirtan-search-icon { width:16px; height:16px; color:var(--text3); flex-shrink:0; }
.kirtan-search-inp {
  flex:1; background:var(--card); border:1.5px solid var(--border);
  border-radius:10px; padding:8px 32px 8px 12px; color:var(--text);
  font-family:inherit; font-size:0.88rem; outline:none; transition:border-color 0.2s;
}
.kirtan-search-inp:focus { border-color:var(--accent-blue); }
.kirtan-clear-btn {
  position:absolute; right:20px; background:none; border:none;
  color:var(--text3); font-size:0.8rem; cursor:pointer; padding:4px;
}
.kirtan-actions {
  display:flex; align-items:center; gap:8px;
  padding:0 14px 10px;
}
.kirtan-sort-wrap { display:flex; gap:6px; }
.kirtan-add-btn {
  background:var(--accent-blue); border:none; border-radius:8px;
  width:32px; height:32px; color:white; font-size:1.2rem;
  cursor:pointer; display:flex; align-items:center; justify-content:center;
  flex-shrink:0; margin-left:4px; transition:opacity 0.2s;
}
.kirtan-add-btn:active { opacity:0.8; }
/* Dropdown */
.kirtan-dropdown {
  display:none; position:absolute; left:14px; right:14px; top:100%;
  background:var(--bg2); border:1px solid var(--border); border-radius:12px;
  box-shadow:0 8px 24px rgba(0,0,0,0.4); z-index:100;
  max-height:280px; overflow-y:auto;
}
.kirtan-dropdown.open { display:block; }
.kd-item {
  display:flex; align-items:center; gap:10px;
  padding:10px 14px; cursor:pointer; border-bottom:1px solid var(--border);
  transition:background 0.15s;
}
.kd-item:last-child { border-bottom:none; }
.kd-item:hover { background:rgba(61,127,212,0.1); }
.kd-icon { font-size:1.1rem; flex-shrink:0; }
.kd-info { flex:1; min-width:0; }
.kd-title { font-size:0.85rem; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.kd-title mark { background:rgba(167,139,250,0.3); color:var(--lavender); border-radius:2px; padding:0 1px; }
.kd-meta { font-size:0.68rem; color:var(--text3); margin-top:1px; }
.kd-empty { padding:14px; text-align:center; font-size:0.82rem; color:var(--text3); }
/* Song card edit button */
.song-edit-btn {
  background:transparent; border:1px solid var(--border); border-radius:7px;
  padding:3px 10px; font-size:0.68rem; color:var(--text2); cursor:pointer;
  font-family:inherit; margin-left:8px; transition:all 0.15s; flex-shrink:0;
}
.song-edit-btn:hover { border-color:var(--accent-blue); color:var(--accent-blue); }
.song-del-btn {
  background:transparent; border:1px solid var(--border); border-radius:7px;
  padding:3px 10px; font-size:0.68rem; color:#e74c3c; cursor:pointer;
  font-family:inherit; transition:all 0.15s; flex-shrink:0;
}

/* ===== MY EVENTS ===== */
.events-screen { overflow-y:auto; padding:16px 16px 100px; }
.events-hdr { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
.add-evt-btn {
  background:var(--accent-blue); border:none; border-radius:10px;
  padding:8px 16px; color:white; font-size:0.82rem;
  cursor:pointer; font-family:inherit; display:flex; align-items:center; gap:6px;
  transition:opacity 0.2s;
}
.add-evt-btn:active { opacity:0.8; }
.backup-box {
  background:rgba(39,174,96,0.08); border:1px solid rgba(39,174,96,0.3);
  border-radius:12px; padding:12px 14px; margin-bottom:16px;
}
.bk-text { font-size:0.78rem; color:var(--text2); line-height:1.5; }
.bk-text strong { color:#27ae60; }
.bk-btns { display:flex; gap:8px; margin-top:8px; flex-wrap:wrap; }
.bk-btn {
  background:rgba(39,174,96,0.12); border:1px solid rgba(39,174,96,0.3);
  border-radius:8px; padding:5px 12px; font-size:0.73rem;
  color:#27ae60; cursor:pointer; font-family:inherit; transition:all 0.2s;
}
.evt-card {
  background:var(--card); border:1px solid var(--border);
  border-left:3px solid #27ae60; border-radius:0 12px 12px 0;
  padding:12px 14px; margin-bottom:10px;
  display:flex; align-items:center; gap:12px;
}
.evt-emoji { font-size:1.4rem; }
.evt-info { flex:1; }
.evt-name-text { font-size:0.9rem; color:var(--text); margin-bottom:4px; font-weight:500; }
.evt-type-badge {
  display:inline-block; font-size:0.65rem; color:var(--accent-blue);
  background:rgba(61,127,212,0.12); border:1px solid rgba(61,127,212,0.25);
  border-radius:20px; padding:2px 8px; margin-bottom:4px; font-weight:500;
  letter-spacing:0.3px;
}
.evt-date { font-size:0.75rem; color:var(--text3); margin-top:2px; }
.evt-del {
  background:transparent; border:1px solid var(--border);
  border-radius:8px; width:30px; height:30px;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; font-size:0.85rem; color:var(--text2);
}

/* ===== SETTINGS ===== */
.settings-screen { overflow-y:auto; padding:20px 16px 100px; }
.settings-screen-title {
  font-size:1.15rem; font-weight:700; color:var(--text); margin-bottom:20px;
  display:flex; align-items:center; gap:8px;
}
.sett-section {
  margin-bottom:16px; background:rgba(255,255,255,0.03);
  border:1px solid var(--border); border-radius:16px; padding:18px 16px;
  transition:border-color 0.2s;
}
.sett-section:hover { border-color:rgba(255,255,255,0.1); }
.sett-stitle {
  font-size:0.82rem; color:var(--text); font-weight:600;
  margin-bottom:14px; padding-bottom:10px;
  border-bottom:1px solid rgba(255,255,255,0.06); display:flex; align-items:center; gap:8px;
}
.sett-stitle-icon {
  width:30px; height:30px; border-radius:8px; display:flex; align-items:center; justify-content:center;
  font-size:0.95rem; flex-shrink:0;
}
.sett-stitle-icon.blue { background:rgba(61,127,212,0.15); }
.sett-stitle-icon.purple { background:rgba(167,139,250,0.15); }
.sett-stitle-icon.green { background:rgba(39,174,96,0.15); }
.sett-stitle-icon.orange { background:rgba(251,146,60,0.15); }
.sett-row {
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 0; border-bottom:1px solid rgba(255,255,255,0.04);
}
.sett-row:last-child { border-bottom:none; }
.sett-info { flex:1; }
.sett-name { font-size:0.88rem; color:var(--text); }
.sett-desc { font-size:0.7rem; color:var(--text3); margin-top:2px; }
.toggle { display:inline-flex; align-items:center; cursor:pointer; flex-shrink:0; }
.toggle input[type=checkbox] {
  -webkit-appearance:none; appearance:none;
  width:44px; height:24px; border-radius:24px;
  background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.1);
  transition:0.3s; cursor:pointer; position:relative; flex-shrink:0;
  outline:none;
}
.toggle input[type=checkbox]:checked {
  background:rgba(61,127,212,0.4); border-color:var(--accent-blue);
}
.toggle input[type=checkbox]::before {
  content:''; position:absolute; width:18px; height:18px;
  top:2px; left:2px; border-radius:50%;
  background:rgba(255,255,255,0.4); transition:0.3s;
}
.toggle input[type=checkbox]:checked::before {
  background:var(--accent-blue); transform:translateX(20px);
}
.tog-slider { display:none; }

/* About Modal */
/* INFO SCREEN */
.info-screen { padding:0 16px 100px; overflow-y:auto; height:100%; }
.info-hero {
  text-align:center; padding:28px 0 20px;
}
.info-hero-icon { font-size:3.2rem; margin-bottom:10px; filter:drop-shadow(0 4px 16px rgba(0,0,0,0.4)); }
.info-hero-name { font-size:1.4rem; font-weight:700; color:var(--text); letter-spacing:0.5px; }
.info-hero-version {
  font-size:0.72rem; color:var(--accent-blue); font-weight:600; margin-top:6px;
  display:inline-block; background:rgba(61,127,212,0.12); padding:3px 12px; border-radius:20px;
}
.info-hero-sub {
  font-size:0.78rem; color:var(--text2); margin-top:8px; line-height:1.5;
}
.info-hero-glory {
  font-size:0.88rem; color:var(--accent-gold); font-style:italic; margin-top:14px; font-weight:500;
}
.info-section {
  background:var(--card); border:1px solid var(--border); border-radius:16px;
  padding:18px 16px; margin-bottom:14px;
}
.info-section-title {
  font-size:0.92rem; font-weight:700; color:var(--accent-blue); margin-bottom:12px;
  display:flex; align-items:center; gap:8px;
}
.info-section-title .info-icon {
  font-size:1.1rem;
}
.info-text {
  font-size:0.82rem; color:var(--text2); line-height:1.7; margin-bottom:0;
}
.info-text strong { color:var(--text); }
.info-step {
  display:flex; align-items:flex-start; gap:12px; margin-bottom:12px;
}
.info-step-num {
  min-width:26px; height:26px; border-radius:50%; display:flex; align-items:center; justify-content:center;
  font-size:0.72rem; font-weight:700; color:#fff; flex-shrink:0; margin-top:1px;
}
.info-step-num.blue { background:linear-gradient(135deg,#3d7fd4,#60a5fa); }
.info-step-num.purple { background:linear-gradient(135deg,#a78bfa,#7c3aed); }
.info-step-num.green { background:linear-gradient(135deg,#34d399,#059669); }
.info-step-num.amber { background:linear-gradient(135deg,#fbbf24,#d97706); }
.info-step-text {
  font-size:0.82rem; color:var(--text2); line-height:1.6;
}
.info-step-text strong { color:var(--text); }
.info-toggle-row {
  display:flex; align-items:center; gap:10px; padding:8px 12px; margin-bottom:6px;
  background:rgba(255,255,255,0.03); border-radius:10px; border:1px solid rgba(255,255,255,0.04);
}
.info-toggle-emoji { font-size:1rem; flex-shrink:0; }
.info-toggle-label { font-size:0.8rem; color:var(--text); font-weight:500; }
.info-toggle-desc { font-size:0.7rem; color:var(--text3); }
.info-note-box {
  background:rgba(251,191,36,0.08); border:1px solid rgba(251,191,36,0.2);
  border-radius:12px; padding:14px 14px; margin-top:14px;
}
.info-note-box .info-note-title {
  font-size:0.8rem; font-weight:700; color:var(--accent-gold); margin-bottom:6px;
  display:flex; align-items:center; gap:6px;
}
.info-note-box .info-note-text {
  font-size:0.78rem; color:var(--text2); line-height:1.6;
}
.info-note-box .info-note-text strong { color:var(--text); }
.info-tip-box {
  background:rgba(96,165,250,0.08); border:1px solid rgba(96,165,250,0.2);
  border-radius:12px; padding:14px 14px; margin-top:10px;
}
.info-tip-box .info-tip-title {
  font-size:0.8rem; font-weight:700; color:var(--accent-blue); margin-bottom:6px;
  display:flex; align-items:center; gap:6px;
}
.info-tip-box .info-tip-text {
  font-size:0.78rem; color:var(--text2); line-height:1.6;
}
.info-back-btn {
  display:flex; align-items:center; gap:6px; background:none; border:none; color:var(--accent-blue);
  font-size:0.88rem; font-weight:600; cursor:pointer; padding:8px 0; font-family:inherit;
  margin-bottom:4px;
}
.info-back-btn:active { opacity:0.7; }
.info-divider { height:1px; background:var(--border); margin:4px 0 14px; }

.loc-search { width:100%; background:var(--card); border:1.5px solid var(--border);
  border-radius:10px; padding:9px 14px; color:var(--text); font-family:inherit;
  font-size:0.88rem; outline:none; margin-bottom:10px; }
.loc-search:focus { border-color:var(--accent-blue); }
.loc-region-title { font-size:0.65rem; color:var(--accent-gold); text-transform:uppercase;
  letter-spacing:1px; padding:8px 0 4px; border-bottom:1px solid var(--border); margin-bottom:6px; }
.loc-grid { max-height:360px; overflow-y:auto; margin-top:6px; border-radius:12px; border:1px solid var(--border); background:var(--card); }
.loc-region-hdr {
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 14px; cursor:pointer; user-select:none;
  background:rgba(255,255,255,0.03); border-bottom:1px solid var(--border);
  transition:background 0.2s;
}
.loc-region-hdr:hover { background:rgba(255,255,255,0.06); }
.loc-region-hdr .region-label { font-size:0.78rem; font-weight:600; color:var(--accent-gold); letter-spacing:0.5px; }
.loc-region-hdr .region-arrow { font-size:0.7rem; color:var(--text3); transition:transform 0.2s; }
.loc-region-hdr.open .region-arrow { transform:rotate(90deg); }
.loc-region-body { display:none; }
.loc-region-body.open { display:block; }
.loc-opt { display:flex; align-items:center; justify-content:space-between;
  padding:9px 14px 9px 24px; cursor:pointer; transition:all 0.15s; border-bottom:1px solid rgba(255,255,255,0.03); }
.loc-opt:last-child { border-bottom:none; }
.loc-opt:hover { background:rgba(61,127,212,0.06); }
.loc-opt.sel { background:rgba(61,127,212,0.12); }
.loc-opt.sel .loc-name { color:var(--accent-blue); font-weight:600; }
.loc-name { font-size:0.82rem; color:var(--text); line-height:1.2; }
.loc-country { font-size:0.65rem; color:var(--text3); }
.loc-check { color:var(--accent-blue); font-size:0.75rem; opacity:0; transition:opacity 0.15s; }
.loc-opt.sel .loc-check { opacity:1; }

.admin-box { background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.08);
  border-radius:12px; padding:14px; }
.adm-btn { background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.1);
  border-radius:8px; padding:8px 14px; color:var(--text2); font-size:0.8rem;
  cursor:pointer; font-family:inherit; margin-right:8px; margin-bottom:8px; }


/* ===== NOTES ===== */
.notes-screen { display:flex; flex-direction:column; height:100%; overflow:hidden; }
.notes-top-bar { padding:12px 16px 0; flex-shrink:0; }
.notes-search-wrap {
  display:flex; align-items:center; gap:8px; background:var(--card);
  border:1px solid var(--border); border-radius:12px; padding:0 12px; margin-bottom:10px;
}
.notes-search-wrap svg { flex-shrink:0; color:var(--text3); width:16px; height:16px; }
.notes-search-inp {
  flex:1; background:transparent; border:none; outline:none; color:var(--text);
  font-size:0.82rem; padding:10px 0; font-family:inherit;
}
.notes-search-inp::placeholder { color:var(--text3); }
.notes-sort-row {
  display:flex; align-items:center; gap:6px; margin-bottom:10px; flex-wrap:wrap;
}
.notes-sort-btn {
  background:rgba(255,255,255,0.04); border:1px solid var(--border); border-radius:20px;
  padding:4px 10px; font-size:0.68rem; color:var(--text3); cursor:pointer; font-family:inherit;
  transition: all 0.2s;
}
.notes-sort-btn.active { background:rgba(61,127,212,0.15); color:var(--accent-blue); border-color:rgba(61,127,212,0.3); }
.notes-count { font-size:0.68rem; color:var(--text3); margin-left:auto; }
.notes-list-wrap { flex:1; overflow-y:auto; padding:0 16px 100px; min-height:0; }
.notes-backup-box {
  background:rgba(61,127,212,0.06); border:1px solid rgba(61,127,212,0.2);
  border-radius:12px; padding:10px 14px; margin-bottom:12px;
  font-size:0.75rem; color:var(--text2); line-height:1.5;
}
.notes-backup-box strong { color:var(--accent-blue); }
.notes-backup-btns { display:flex; gap:8px; margin-top:8px; flex-wrap:wrap; }
.note-card {
  background:var(--card); border:1px solid var(--border);
  border-radius:14px; padding:14px 16px; margin-bottom:10px;
  cursor:pointer; transition:all 0.2s; position:relative;
}
.note-card:hover { border-color:rgba(61,127,212,0.4); }
.note-card.pinned { border-left:3px solid var(--accent-gold); }
.note-card.locked { opacity:0.85; }
.note-card-top { display:flex; align-items:center; gap:8px; }
.note-pin-icon { font-size:0.72rem; flex-shrink:0; }
.note-lock-icon { font-size:0.72rem; flex-shrink:0; }
.note-tag {
  font-size:0.6rem; font-weight:600; letter-spacing:0.5px; text-transform:uppercase;
  border-radius:20px; padding:2px 8px; white-space:nowrap; flex-shrink:0;
}
.note-tag-personal { background:rgba(155,89,182,0.15); color:#9b59b6; border:1px solid rgba(155,89,182,0.3); }
.note-tag-spiritual { background:rgba(61,127,212,0.15); color:var(--accent-blue); border:1px solid rgba(61,127,212,0.3); }
.note-tag-prayer { background:rgba(241,196,15,0.15); color:#f1c40f; border:1px solid rgba(241,196,15,0.3); }
.note-tag-reminder { background:rgba(39,174,96,0.15); color:#27ae60; border:1px solid rgba(39,174,96,0.3); }
.note-tag-other { background:rgba(255,255,255,0.06); color:var(--text3); border:1px solid var(--border); }
.note-title { font-size:1.26rem; font-weight:600; color:var(--text); flex:1; line-height:1.3; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.note-preview {
  font-size:1.1rem; color:var(--text2); margin-top:6px;
  line-height:1.5; display:-webkit-box; -webkit-line-clamp:2;
  -webkit-box-orient:vertical; overflow:hidden;
}
.note-footer { display:flex; align-items:center; justify-content:space-between; margin-top:10px; }
.note-date { font-size:0.94rem; color:var(--text3); }
.note-actions { display:flex; gap:4px; align-items:center; }
.note-act-btn {
  background:transparent; border:1px solid var(--border);
  border-radius:8px; width:28px; height:28px;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; font-size:0.75rem; color:var(--text2); transition:all 0.15s;
}
.note-act-btn:active { background:rgba(255,255,255,0.1); }
/* Floating Action Button */
.notes-fab {
  position:fixed; bottom:76px; right:calc(50% - 195px);
  width:52px; height:52px; border-radius:50%;
  background:linear-gradient(135deg, var(--accent-blue), var(--lavender));
  border:none; color:#fff; font-size:1.5rem; font-weight:300;
  cursor:pointer; z-index:50; display:flex; align-items:center; justify-content:center;
  box-shadow:0 4px 20px rgba(61,127,212,0.4); transition:transform 0.2s;
}
.notes-fab:active { transform:scale(0.92); }
@media(max-width:430px){ .notes-fab { right:20px; } }
/* Note Editor Full Screen */
.note-editor-overlay {
  position:fixed; inset:0; background:var(--bg); z-index:200;
  display:none; flex-direction:column; max-width:430px; margin:0 auto;
}
.note-editor-overlay.open { display:flex; }
.note-editor-topbar {
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 14px; border-bottom:1px solid var(--border); flex-shrink:0;
  background:var(--bg2);
}
.ne-back-btn { background:none; border:none; color:var(--text2); font-size:1.2rem; cursor:pointer; padding:4px; }
.ne-save-btn {
  background:rgba(61,127,212,0.15); border:1px solid rgba(61,127,212,0.3);
  color:var(--accent-blue); border-radius:8px; padding:6px 14px;
  font-size:0.78rem; font-weight:500; cursor:pointer; font-family:inherit;
}
.ne-save-btn:active { opacity:0.8; }
.ne-topbar-actions { display:flex; gap:6px; align-items:center; }
.ne-action-btn {
  background:none; border:none; color:var(--text2); font-size:1rem;
  cursor:pointer; padding:6px; border-radius:6px;
}
.ne-action-btn:active { background:rgba(255,255,255,0.08); }
.ne-title-input {
  width:100%; background:transparent; border:none; outline:none;
  color:var(--text); font-size:1.5rem; font-weight:600; padding:14px 16px 6px;
  font-family:inherit;
}
.ne-title-input::placeholder { color:var(--text3); }
.ne-meta-row {
  display:flex; gap:8px; padding:4px 16px 10px; align-items:center; flex-wrap:wrap;
  border-bottom:1px solid var(--border);
}
.ne-meta-sel {
  background:rgba(255,255,255,0.04); border:1px solid var(--border);
  border-radius:8px; color:var(--text2); font-size:1.04rem; padding:4px 8px;
  font-family:inherit; outline:none; cursor:pointer;
}
.ne-meta-date {
  background:rgba(255,255,255,0.04); border:1px solid var(--border);
  border-radius:8px; color:var(--text2); font-size:1.04rem; padding:4px 8px;
  font-family:inherit; outline:none;
}
/* Formatting Toolbar */
.ne-toolbar {
  display:flex; align-items:center; gap:2px; padding:6px 12px;
  border-bottom:1px solid var(--border); flex-shrink:0;
  overflow-x:auto; background:var(--bg2);
}
.ne-toolbar::-webkit-scrollbar { display:none; }
.ne-fmt-btn {
  background:none; border:1px solid transparent; border-radius:6px;
  color:var(--text2); font-size:0.82rem; cursor:pointer; padding:5px 8px;
  min-width:32px; height:32px; display:flex; align-items:center; justify-content:center;
  font-family:inherit; transition:all 0.15s; flex-shrink:0;
}
.ne-fmt-btn:active, .ne-fmt-btn.active { background:rgba(61,127,212,0.15); color:var(--accent-blue); border-color:rgba(61,127,212,0.3); }
.ne-fmt-sep { width:1px; height:20px; background:var(--border); margin:0 4px; flex-shrink:0; }
/* Content editable area */
.ne-content-area {
  flex:1; overflow-y:auto; padding:14px 16px; min-height:0;
}
.ne-content-editable {
  width:100%; min-height:200px; outline:none; color:var(--text);
  font-size:1.26rem; line-height:1.7; font-family:inherit;
}
.ne-content-editable:empty::before {
  content:attr(data-placeholder); color:var(--text3); pointer-events:none;
}
.ne-content-editable h1 { font-size:1.7rem; margin:8px 0; }
.ne-content-editable h2 { font-size:1.5rem; margin:6px 0; }
.ne-content-editable ul, .ne-content-editable ol { padding-left:20px; margin:6px 0; }
.ne-content-editable mark { background:rgba(241,196,15,0.3); color:inherit; border-radius:2px; padding:0 2px; }
.ne-autosave-indicator {
  font-size:0.82rem; color:var(--text3); padding:4px 16px;
  text-align:right; flex-shrink:0; border-top:1px solid var(--border);
  background:var(--bg2);
}
/* PIN Modal */
.pin-overlay {
  position:fixed; inset:0; background:rgba(0,0,0,0.92); z-index:250;
  display:none; align-items:center; justify-content:center;
  max-width:430px; margin:0 auto;
}
.pin-overlay.open { display:flex; }
.pin-box {
  background:var(--bg2); border-radius:20px; padding:30px 24px;
  width:calc(100% - 48px); max-width:320px; text-align:center;
}
.pin-box-title { font-size:1rem; font-weight:600; color:var(--text); margin-bottom:6px; }
.pin-box-sub { font-size:0.78rem; color:var(--text2); margin-bottom:20px; line-height:1.4; }
.pin-dots { display:flex; gap:12px; justify-content:center; margin-bottom:20px; }
.pin-dot {
  width:14px; height:14px; border-radius:50%; border:2px solid var(--text3);
  transition:all 0.15s;
}
.pin-dot.filled { background:var(--accent-blue); border-color:var(--accent-blue); }
.pin-dot.error { border-color:#e74c3c; background:#e74c3c; }
.pin-numpad { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; max-width:240px; margin:0 auto; }
.pin-key {
  background:rgba(255,255,255,0.06); border:1px solid var(--border); border-radius:12px;
  color:var(--text); font-size:1.2rem; height:52px; cursor:pointer;
  display:flex; align-items:center; justify-content:center; font-family:inherit;
  transition:all 0.1s;
}
.pin-key:active { background:rgba(61,127,212,0.2); }
.pin-key.pin-del { font-size:0.8rem; color:var(--text2); }
.pin-forgot-link {
  display:inline-block; margin-top:16px; font-size:0.72rem;
  color:var(--accent-blue); cursor:pointer; text-decoration:underline;
}
.pin-error-msg { font-size:0.75rem; color:#e74c3c; margin-top:8px; min-height:18px; }
/* Note editor modal (legacy compat) */
.note-editor-body { display:flex; flex-direction:column; gap:12px; }
.note-char-count { font-size:0.65rem; color:var(--text3); text-align:right; margin-top:-8px; }



/* ===== DATE PICKER MODAL ===== */
.dp-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.85); z-index:300;
  display:none; align-items:center; justify-content:center;
  max-width:430px; margin:0 auto; padding:12px; }
.dp-overlay.open { display:flex; }
.dp-box {
  background:var(--bg2); border-radius:20px; width:100%;
  border:1px solid var(--border); overflow:hidden;
  display:flex; flex-direction:column;
  max-height:calc(100vh - 24px);
  animation:fadeIn 0.2s ease;
}
@keyframes fadeIn { from{opacity:0;transform:scale(0.95)} to{opacity:1;transform:scale(1)} }
/* Compact header */
.dp-header {
  background:var(--accent-blue); padding:12px 16px 10px;
  display:flex; flex-direction:column; gap:2px; flex-shrink:0;
}
.dp-header-label { font-size:0.62rem; color:rgba(255,255,255,0.7); text-transform:uppercase; letter-spacing:1px; }
.dp-header-date { font-size:1.15rem; font-weight:700; color:white; line-height:1.3; }
.dp-header-vaishnava { font-size:0.68rem; color:rgba(255,255,255,0.8); }
/* Scrollable body */
.dp-body { padding:12px 12px 4px; overflow-y:auto; flex:1; min-height:0; }
.dp-section-label {
  font-size:0.6rem; color:var(--text3); text-transform:uppercase;
  letter-spacing:1px; margin-bottom:7px; font-weight:600;
}
/* Year picker - compact scrollable grid */
.dp-year-grid {
  display:grid; grid-template-columns:repeat(4,1fr); gap:5px;
  max-height:110px; overflow-y:auto; margin-bottom:12px;
}
.dp-year-btn {
  background:var(--card); border:1px solid var(--border); border-radius:7px;
  padding:5px 2px; font-size:0.78rem; color:var(--text2); cursor:pointer;
  font-family:inherit; text-align:center; transition:all 0.15s;
}
.dp-year-btn:hover { border-color:var(--accent-blue); color:var(--accent-blue); }
.dp-year-btn.sel { background:var(--accent-blue); border-color:var(--accent-blue); color:white; font-weight:600; }
/* Month picker - compact */
.dp-month-grid {
  display:grid; grid-template-columns:repeat(4,1fr); gap:5px; margin-bottom:12px;
}
.dp-month-btn {
  background:var(--card); border:1px solid var(--border); border-radius:7px;
  padding:6px 2px; font-size:0.75rem; color:var(--text2); cursor:pointer;
  font-family:inherit; text-align:center; transition:all 0.15s;
}
.dp-month-btn:hover { border-color:var(--accent-blue); color:var(--accent-blue); }
.dp-month-btn.sel { background:var(--accent-blue); border-color:var(--accent-blue); color:white; font-weight:600; }
/* Day picker */
.dp-day-grid {
  display:grid; grid-template-columns:repeat(7,1fr); gap:2px; margin-bottom:8px;
}
.dp-day-hdr { text-align:center; font-size:0.58rem; color:var(--text3); padding:2px 0; text-transform:uppercase; }
.dp-day-btn {
  aspect-ratio:1; display:flex; align-items:center; justify-content:center;
  background:transparent; border:none; border-radius:50%;
  font-size:0.78rem; color:var(--text2); cursor:pointer;
  font-family:inherit; transition:all 0.15s;
}
.dp-day-btn:hover { background:rgba(61,127,212,0.2); color:var(--text); }
.dp-day-btn.sel { background:var(--accent-blue); color:white; font-weight:600; }
.dp-day-btn.today-dot { box-shadow:0 0 0 1.5px var(--accent-blue); }
.dp-day-btn.empty { cursor:default; pointer-events:none; }
/* Footer - always visible at bottom */
.dp-footer { display:flex; gap:8px; padding:8px 12px 12px; flex-shrink:0;
  border-top:1px solid var(--border); background:var(--bg2); }
.dp-cancel { flex:1; padding:10px; background:transparent; border:1px solid var(--border);
  border-radius:10px; color:var(--text2); font-family:inherit; font-size:0.85rem; cursor:pointer; }
.dp-go { flex:2; padding:10px; background:var(--accent-blue); border:none;
  border-radius:10px; color:white; font-family:inherit; font-size:0.85rem;
  font-weight:600; cursor:pointer; transition:opacity 0.2s; }
.dp-go:active { opacity:0.85; }

/* ===== RAHU KALAM ===== */
.rahu-section {
  margin: 0; padding: 14px 18px;
  border-bottom: 1px solid var(--border);
  background: rgba(231,76,60,0.04);
}
.rahu-header {
  display: flex; align-items: center; gap: 8px; margin-bottom: 4px;
}
.rahu-icon { font-size: 1rem; }
.rahu-title {
  font-size: 0.78rem; font-weight: 700; color: #e74c3c;
  text-transform: none; letter-spacing: 0.3px;
}
.rahu-time {
  margin-left: auto; font-size: 0.95rem; font-weight: 600;
  color: #e74c3c; font-variant-numeric: tabular-nums;
}
.rahu-desc { font-size: 0.72rem; color: var(--text3); line-height: 1.4; }




/* ===== GOOGLE SIGN-IN ===== */
.g-signed-out-box { }
.g-desc { font-size:0.78rem; color:var(--text2); line-height:1.6; margin-bottom:14px; }
.g-desc strong { color:var(--text); }
.g-signin-btn-wrap { margin-bottom:8px; }
.g-error { font-size:0.72rem; color:#e74c3c; margin-top:6px; }
.g-signed-in-box { }
.g-user-row { display:flex; align-items:center; gap:12px; margin-bottom:14px; }
.g-avatar { width:44px; height:44px; border-radius:50%; border:2px solid var(--accent-blue); }
.g-user-info { flex:1; }
.g-user-name { font-size:0.92rem; color:var(--text); font-weight:600; }
.g-user-email { font-size:0.72rem; color:var(--text3); margin-top:2px; }
.g-sync-row { display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px; }
.g-sync-status { font-size:0.75rem; color:var(--text2); }
.g-sync-btn {
  background:rgba(61,127,212,0.12); border:1px solid rgba(61,127,212,0.3);
  border-radius:8px; padding:6px 12px; color:var(--accent-blue);
  font-size:0.78rem; font-family:inherit; cursor:pointer; white-space:nowrap;
}
.g-sync-btn:active { opacity:0.7; }
.g-sync-details { font-size:0.7rem; color:var(--text3); margin-bottom:12px; line-height:1.6; }
.g-signout-btn {
  background:transparent; border:1px solid var(--border); border-radius:8px;
  padding:7px 14px; color:var(--text3); font-size:0.78rem;
  font-family:inherit; cursor:pointer; width:100%;
}
.g-signout-btn:active { opacity:0.7; }

/* ===== CUSTOM LOCATION SEARCH ===== */
.custom-loc-box { margin-top:12px; padding:12px; background:rgba(61,127,212,0.05); border:1px solid rgba(61,127,212,0.15); border-radius:12px; }
.custom-loc-label { font-size:0.72rem; color:var(--text2); margin-bottom:8px; }
.custom-loc-row { display:flex; gap:8px; align-items:center; }
.custom-loc-btn {
  background:var(--accent-blue); border:none; border-radius:8px;
  padding:10px 14px; color:white; font-size:0.8rem; font-family:inherit;
  cursor:pointer; white-space:nowrap; flex-shrink:0; transition:opacity 0.2s;
}
.custom-loc-btn:disabled { opacity:0.5; cursor:not-allowed; }
.geo-status { font-size:0.72rem; color:var(--text3); margin-top:6px; min-height:18px; }
.geo-status.error { color:#e74c3c; }
.geo-status.loading { color:var(--accent-blue); }
.geo-results { margin-top:6px; display:flex; flex-direction:column; gap:6px; }
.geo-result-item {
  background:var(--card); border:1px solid var(--border); border-radius:8px;
  padding:9px 12px; cursor:pointer; transition:border-color 0.15s;
}
.geo-result-item:hover { border-color:var(--accent-blue); }
.geo-result-name { font-size:0.85rem; color:var(--text); font-weight:500; }
.geo-result-detail { font-size:0.7rem; color:var(--text3); margin-top:2px; }
.geo-result-coords { font-size:0.65rem; color:var(--text3); margin-top:2px; font-variant-numeric:tabular-nums; }

/* ===== NOTIFICATION SETTINGS ===== */
.notif-info-box {
  background:rgba(61,127,212,0.07); border:1px solid rgba(61,127,212,0.2);
  border-radius:10px; padding:10px 12px; margin-bottom:14px;
}
.notif-info-title { font-size:0.72rem; color:var(--accent-blue); font-weight:600; margin-bottom:4px; }
.notif-info-text { font-size:0.72rem; color:var(--text2); line-height:1.5; }
.notif-info-text strong { color:var(--text); }
.notif-time-input {
  background:var(--card); border:1.5px solid var(--border); border-radius:8px;
  padding:6px 10px; color:var(--text); font-family:inherit; font-size:0.85rem;
  outline:none; width:110px; text-align:center;
  color-scheme: dark; display:none;
}
.notif-time-input:focus { border-color:var(--accent-blue); }
.notif-time-display {
  display:flex; align-items:center; gap:6px;
}
.notif-time-display select {
  background:var(--card); border:1.5px solid var(--border); border-radius:8px;
  padding:8px 6px; color:var(--text); font-family:inherit; font-size:0.82rem;
  outline:none; text-align:center; color-scheme:dark; -webkit-appearance:none;
  appearance:none; cursor:pointer; min-width:0;
}
.notif-time-display select:focus { border-color:var(--accent-blue); }
.notif-time-display .time-colon { color:var(--text2); font-weight:600; font-size:0.9rem; }
.notif-advance-sel {
  background:var(--card); border:1.5px solid var(--border); border-radius:8px;
  padding:8px 12px; color:var(--text); font-family:inherit; font-size:0.82rem;
  outline:none; text-align:center; color-scheme:dark; min-width:100px;
  cursor:pointer;
}
.notif-advance-sel:focus { border-color:var(--accent-blue); }
.notif-divider { height:1px; background:var(--border); margin:10px 0 14px; }

/* ===== HOLY DHAMAS ===== */
.dhamas-screen { overflow-y:auto; padding:0 0 80px; }
.dhamas-hdr {
  display:flex; align-items:center; justify-content:space-between;
  padding:14px 16px 10px; position:sticky; top:0; z-index:5;
  background:var(--bg);
}
.dhamas-search {
  width:100%; padding:10px 14px; margin:0 16px 10px;
  background:rgba(255,255,255,0.05); border:1px solid var(--border);
  border-radius:10px; color:var(--text); font-size:0.85rem;
  font-family:inherit; outline:none;
}
.dhamas-search:focus { border-color:var(--accent-blue); }
.dhamas-grid {
  display:grid; grid-template-columns:1fr 1fr;
  gap:10px; padding:0 16px 16px;
}
.dham-card {
  background:rgba(255,255,255,0.04); border:1px solid var(--border);
  border-radius:14px; overflow:hidden; cursor:pointer;
  transition:border-color 0.2s, transform 0.1s;
  position:relative;
}
.dham-card:active { transform:scale(0.97); border-color:rgba(167,139,250,0.4); }
.dham-card-del {
  position:absolute; top:6px; right:6px; z-index:3;
  width:22px; height:22px; border-radius:6px;
  background:rgba(231,76,100,0.8); border:none; color:white;
  font-size:0.65rem; font-weight:700; cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 2px 6px rgba(0,0,0,0.3);
}
.dham-card-img {
  width:100%; height:90px; object-fit:cover;
  background:linear-gradient(160deg, rgba(167,139,250,0.12), rgba(61,127,212,0.06), rgba(232,200,0,0.05));
  display:flex; align-items:center; justify-content:center;
  font-size:2.2rem;
  position:relative;
}
.dham-card-img::after {
  content:''; position:absolute; bottom:0; left:0; right:0;
  height:20px; background:linear-gradient(transparent, rgba(15,15,35,0.8));
}
.dham-card-body { padding:10px 12px; }
.dham-card-name {
  font-size:0.82rem; font-weight:700; color:var(--text);
  margin-bottom:3px; line-height:1.3;
}
.dham-card-loc {
  font-size:0.68rem; color:var(--text3); line-height:1.3;
}
.dham-card-tag {
  display:inline-block; margin-top:6px;
  font-size:0.6rem; font-weight:600; text-transform:uppercase;
  letter-spacing:0.5px; padding:2px 7px; border-radius:4px;
}
.dham-card-tag.char-dham { background:rgba(232,200,0,0.12); color:#e8c800; }
.dham-card-tag.divya-desam { background:rgba(77,219,110,0.12); color:#4ddb6e; }
.dham-card-tag.iskcon { background:rgba(167,139,250,0.12); color:var(--lavender); }
.dham-card-tag.shakti-peetha { background:rgba(240,140,26,0.12); color:#f08c1a; }

/* Dham detail screen */
.dham-detail-screen { display:flex; flex-direction:column; height:100%; }
.dham-detail-header {
  display:flex; align-items:center; gap:10px;
  padding:10px 16px; background:var(--bg);
  position:sticky; top:0; z-index:5;
  border-bottom:1px solid var(--border);
}
.dham-back-btn {
  background:rgba(255,255,255,0.08); border:none; border-radius:8px;
  width:32px; height:32px; display:flex; align-items:center; justify-content:center;
  cursor:pointer; color:var(--text2); font-size:1.1rem;
}
.dham-back-btn:active { background:rgba(255,255,255,0.15); }
.dham-detail-title { font-size:1rem; font-weight:700; color:var(--text); flex:1; }
.dham-detail-body {
  overflow-y:auto; flex:1; padding:0 0 100px;
}
/* Hero banner */
.dham-hero {
  width:100%; height:180px; display:flex; flex-direction:column;
  align-items:center; justify-content:center; gap:10px;
  background:linear-gradient(160deg, rgba(167,139,250,0.18) 0%, rgba(61,127,212,0.10) 50%, rgba(232,200,0,0.08) 100%);
  border-bottom:1px solid rgba(167,139,250,0.15);
  position:relative; overflow:hidden;
}
.dham-hero::before {
  content:''; position:absolute; inset:0;
  background:radial-gradient(ellipse at 50% 80%, rgba(167,139,250,0.12) 0%, transparent 70%);
}
.dham-hero-icon { font-size:3.8rem; position:relative; z-index:1;
  filter:drop-shadow(0 0 20px rgba(167,139,250,0.3)); }
.dham-hero-name { font-size:1.15rem; font-weight:700; color:var(--text);
  letter-spacing:0.3px; position:relative; z-index:1; text-align:center; padding:0 20px; }
.dham-hero-loc { font-size:0.75rem; color:var(--text3); position:relative; z-index:1;
  display:flex; align-items:center; gap:4px; }

/* Section cards */
.dham-sections-wrap { padding:12px 14px; display:flex; flex-direction:column; gap:12px; }

.dham-section {
  background:rgba(255,255,255,0.025);
  border:1px solid rgba(255,255,255,0.06);
  border-radius:16px; padding:0; overflow:hidden;
  transition:border-color 0.3s;
}
.dham-section:last-child { border-bottom:1px solid rgba(255,255,255,0.06); }

/* Section-specific accent glow on the left border */
.dham-section[data-accent="purple"]  { border-left:3px solid rgba(167,139,250,0.5); box-shadow:inset 3px 0 12px -4px rgba(167,139,250,0.08); }
.dham-section[data-accent="gold"]    { border-left:3px solid rgba(232,200,0,0.5);   box-shadow:inset 3px 0 12px -4px rgba(232,200,0,0.08); }
.dham-section[data-accent="blue"]    { border-left:3px solid rgba(61,127,212,0.5);   box-shadow:inset 3px 0 12px -4px rgba(61,127,212,0.08); }
.dham-section[data-accent="green"]   { border-left:3px solid rgba(77,219,110,0.5);   box-shadow:inset 3px 0 12px -4px rgba(77,219,110,0.08); }
.dham-section[data-accent="orange"]  { border-left:3px solid rgba(240,140,26,0.5);   box-shadow:inset 3px 0 12px -4px rgba(240,140,26,0.08); }
.dham-section[data-accent="rose"]    { border-left:3px solid rgba(231,76,100,0.5);   box-shadow:inset 3px 0 12px -4px rgba(231,76,100,0.08); }
.dham-section[data-accent="teal"]    { border-left:3px solid rgba(45,212,191,0.5);   box-shadow:inset 3px 0 12px -4px rgba(45,212,191,0.08); }

/* Section header (collapsible) */
.dham-section-hdr {
  display:flex; align-items:center; gap:8px;
  padding:14px 16px; cursor:pointer;
  transition:background 0.2s;
}
.dham-section-hdr:active { background:rgba(255,255,255,0.03); }
.dham-section-icon {
  width:32px; height:32px; border-radius:10px;
  display:flex; align-items:center; justify-content:center;
  font-size:1.05rem; flex-shrink:0;
}
.dham-section[data-accent="purple"] .dham-section-icon  { background:rgba(167,139,250,0.12); }
.dham-section[data-accent="gold"] .dham-section-icon    { background:rgba(232,200,0,0.12); }
.dham-section[data-accent="blue"] .dham-section-icon    { background:rgba(61,127,212,0.12); }
.dham-section[data-accent="green"] .dham-section-icon   { background:rgba(77,219,110,0.12); }
.dham-section[data-accent="orange"] .dham-section-icon  { background:rgba(240,140,26,0.12); }
.dham-section[data-accent="rose"] .dham-section-icon    { background:rgba(231,76,100,0.12); }
.dham-section[data-accent="teal"] .dham-section-icon    { background:rgba(45,212,191,0.12); }

.dham-section-title {
  font-size:0.8rem; font-weight:700; color:var(--text);
  flex:1; letter-spacing:0.2px; line-height:1.3;
}
.dham-section-chevron {
  color:var(--text3); font-size:0.75rem; transition:transform 0.3s;
  flex-shrink:0;
}
.dham-section.open .dham-section-chevron { transform:rotate(180deg); }

/* Section body */
.dham-section-body {
  max-height:0; overflow:hidden;
  transition:max-height 0.35s cubic-bezier(0.4,0,0.2,1), padding 0.25s;
  padding:0 16px;
}
.dham-section.open .dham-section-body {
  max-height:2000px; padding:0 16px 16px;
}

.dham-section-text {
  font-size:0.84rem; color:var(--text2); line-height:1.75;
  white-space:pre-wrap; word-wrap:break-word;
}
.dham-section-text strong { color:var(--text); font-weight:600; }
/* Styled bullet points */
.dham-bullet {
  display:flex; gap:8px; padding:4px 0; line-height:1.65;
}
.dham-bullet::before {
  content:''; flex-shrink:0; width:6px; height:6px;
  border-radius:50%; margin-top:7px;
  background:var(--lavender); opacity:0.7;
}
.dham-section[data-accent="gold"] .dham-bullet::before { background:#e8c800; }
.dham-section[data-accent="blue"] .dham-bullet::before { background:#3d7fd4; }
.dham-section[data-accent="green"] .dham-bullet::before { background:#4ddb6e; }
.dham-section[data-accent="orange"] .dham-bullet::before { background:#f08c1a; }
.dham-section[data-accent="rose"] .dham-bullet::before { background:#e74c64; }
.dham-section[data-accent="teal"] .dham-bullet::before { background:#2dd4bf; }
/* Timing lines */
.dham-time-line {
  display:flex; gap:8px; padding:3px 0; font-size:0.83rem; line-height:1.6;
}
.dham-time-badge {
  flex-shrink:0; background:rgba(61,127,212,0.12);
  color:var(--accent-blue); font-size:0.72rem; font-weight:700;
  padding:2px 8px; border-radius:6px; white-space:nowrap;
  min-width:64px; text-align:center; margin-top:1px;
}
.dham-time-desc { color:var(--text2); }
/* Info label (like "City:", "Airport:") */
.dham-info-label { color:var(--text); font-weight:600; }
/* Paragraph gaps */
.dham-para { margin-bottom:10px; font-size:0.84rem; color:var(--text2); line-height:1.75; }
.dham-para:last-child { margin-bottom:0; }
.dham-tip-box {
  background:rgba(232,200,0,0.06); border:1px solid rgba(232,200,0,0.12);
  border-radius:8px; padding:8px 12px; margin-top:8px;
  font-size:0.8rem; color:#e8c800; line-height:1.6;
}

/* Key places list */
.dham-place-item {
  display:flex; gap:10px; padding:10px 0;
  border-bottom:1px solid rgba(255,255,255,0.04);
}
.dham-place-item:last-child { border-bottom:none; }
.dham-place-num {
  flex-shrink:0; width:24px; height:24px; border-radius:8px;
  background:rgba(167,139,250,0.15); color:var(--lavender);
  display:flex; align-items:center; justify-content:center;
  font-size:0.7rem; font-weight:700; margin-top:2px;
}
.dham-place-text { font-size:0.83rem; color:var(--text2); line-height:1.6; }
.dham-place-text strong { color:var(--text); font-weight:600; display:block; margin-bottom:2px; }

/* Itinerary days */
.dham-itinerary-day {
  background:rgba(61,127,212,0.06); border:1px solid rgba(61,127,212,0.12);
  border-radius:12px; padding:14px 16px; margin-top:10px;
}
.dham-itinerary-day:first-child { margin-top:0; }
.dham-itinerary-label {
  font-size:0.72rem; font-weight:700; color:var(--accent-blue);
  text-transform:uppercase; letter-spacing:0.6px; margin-bottom:8px;
  padding-bottom:6px; border-bottom:1px dashed rgba(61,127,212,0.2);
}

/* Admin add dham button */
.dham-add-btn {
  background:rgba(167,139,250,0.12); border:1px solid rgba(167,139,250,0.25);
  border-radius:10px; padding:7px 14px; font-size:0.78rem; font-weight:600;
  color:var(--lavender); cursor:pointer; transition:background 0.15s;
}
.dham-add-btn:active { background:rgba(167,139,250,0.25); }

/* Add Dham Modal */
.dham-form-section { margin-bottom:16px; }
.dham-form-label {
  font-size:0.7rem; font-weight:600; color:var(--text3);
  text-transform:uppercase; letter-spacing:0.5px; margin-bottom:6px; display:block;
}
.dham-form-input {
  width:100%; background:rgba(255,255,255,0.05); border:1px solid var(--border);
  border-radius:10px; padding:10px 14px; font-size:0.85rem;
  color:var(--text); font-family:inherit; outline:none;
}
.dham-form-input:focus { border-color:var(--lavender); }
.dham-form-textarea {
  width:100%; min-height:100px; background:rgba(255,255,255,0.05);
  border:1px solid var(--border); border-radius:10px; padding:10px 14px;
  font-size:0.84rem; color:var(--text); font-family:inherit; outline:none;
  resize:vertical; line-height:1.6;
}
.dham-form-textarea:focus { border-color:var(--lavender); }
.dham-form-help { font-size:0.68rem; color:var(--text3); margin-top:4px; }
.dham-form-save {
  background:var(--lavender); border:none; border-radius:10px;
  padding:12px 24px; font-size:0.9rem; font-weight:700;
  color:#1a1a2e; cursor:pointer; width:100%; margin-top:10px;
}
.dham-form-save:active { opacity:0.8; }

/* ===== BOTTOM NAV ===== */
.bottom-nav {
  position:fixed; bottom:0; left:0; right:0; max-width:430px; margin:0 auto;
  background:var(--bg2); border-top:1px solid var(--border);
  z-index:100; display:flex; align-items:stretch;
  padding-bottom:env(safe-area-inset-bottom,0);
}
.nav-scroll-area {
  flex:1; overflow-x:auto; overflow-y:hidden;
  display:flex; scroll-behavior:smooth;
  -webkit-overflow-scrolling:touch;
  scrollbar-width:none; -ms-overflow-style:none;
  min-width:0;
}
.nav-scroll-area::-webkit-scrollbar { display:none; }
.nav-btn {
  flex:0 0 auto; width:80px;
  display:flex; flex-direction:column; align-items:center;
  padding:8px 2px 7px; cursor:pointer; border:none; background:transparent;
  color:var(--text3); gap:3px; transition:color 0.2s, transform 0.15s;
}
.nav-btn:active { transform:scale(0.9); }
.nav-btn svg { width:21px; height:21px; }
.nav-icon-text { font-size:1.3rem; line-height:1; color:inherit; }
.nav-lbl { font-size:0.5rem; letter-spacing:0.3px; text-transform:uppercase; white-space:nowrap; font-weight:500; }

/* â”€â”€ Per-tab unique colors (inactive = muted, active = bright) â”€â”€ */
/* Home â€” lavender */
.nav-scroll-area .nav-btn:nth-child(1) { color:rgba(167,139,250,0.4); }
.nav-scroll-area .nav-btn:nth-child(1).active { color:#c4b0ff; }
/* Calendar â€” blue */
.nav-scroll-area .nav-btn:nth-child(2) { color:rgba(106,176,255,0.4); }
.nav-scroll-area .nav-btn:nth-child(2).active { color:#6ab0ff; }
/* Audio â€” amber/orange */
.nav-scroll-area .nav-btn:nth-child(3) { color:rgba(240,168,72,0.4); }
.nav-scroll-area .nav-btn:nth-child(3).active { color:#f0a848; }
/* Events â€” green */
.nav-scroll-area .nav-btn:nth-child(4) { color:rgba(94,232,160,0.4); }
.nav-scroll-area .nav-btn:nth-child(4).active { color:#5ee8a0; }
/* Notes â€” purple */
.nav-scroll-area .nav-btn:nth-child(5) { color:rgba(206,192,255,0.4); }
.nav-scroll-area .nav-btn:nth-child(5).active { color:#cec0ff; }
/* Dhamas â€” red/coral */
.nav-scroll-area .nav-btn:nth-child(6) { color:rgba(240,128,112,0.4); }
.nav-scroll-area .nav-btn:nth-child(6).active { color:#f08070; }
/* SevaKart â€” teal/cyan */
.nav-scroll-area .nav-btn:nth-child(7) { color:rgba(92,224,240,0.4); }
.nav-scroll-area .nav-btn:nth-child(7).active { color:#5ce0f0; }
/* Prayer Circle â€” warm gold */
.nav-scroll-area .nav-btn:nth-child(8) { color:rgba(232,168,56,0.4); }
.nav-scroll-area .nav-btn:nth-child(8).active { color:#f0c850; }

/* Scroll arrow hint */
.nav-arrow-hint {
  flex:0 0 30px; display:flex; align-items:center; justify-content:center;
  position:relative; cursor:pointer; border:none; background:transparent;
  z-index:2;
}
.nav-arrow-hint::before {
  content:''; position:absolute; left:-22px; top:0; bottom:0; width:30px;
  background:linear-gradient(90deg, transparent, var(--bg2) 90%);
  pointer-events:none;
}
.nav-arrow-icon {
  width:22px; height:22px; border-radius:50%;
  background:rgba(167,139,250,0.15); border:1px solid rgba(167,139,250,0.35);
  display:flex; align-items:center; justify-content:center;
  animation:navArrowPulse 1.8s ease-in-out infinite;
  box-shadow:0 0 10px rgba(167,139,250,0.25);
}
.nav-arrow-icon svg { width:12px; height:12px; stroke:var(--lavender); }
.nav-arrow-hint.at-end .nav-arrow-icon svg { transform:rotate(180deg); }
@keyframes navArrowPulse {
  0%, 100% { transform:translateX(0); opacity:0.9; }
  50% { transform:translateX(2px); opacity:1; box-shadow:0 0 14px rgba(167,139,250,0.4); }
}
.nav-arrow-hint.hidden { opacity:0; pointer-events:none; }

/* ===== MODAL ===== */
.modal-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.75); z-index:200;
  display:none; align-items:flex-end; max-width:430px; margin:0 auto; }
.modal-overlay.open { display:flex; }
.modal-sheet {
  background:var(--bg2); border-top:1px solid var(--border);
  border-radius:20px 20px 0 0; width:100%;
  max-height:88vh; overflow-y:auto; padding:20px 18px;
  animation:slideUp 0.3s ease;
}
@keyframes slideUp { from{transform:translateY(100%)} to{transform:translateY(0)} }
.modal-handle { width:40px; height:4px; background:rgba(255,255,255,0.15);
  border-radius:2px; margin:0 auto 16px; }
.modal-title { font-size:1.1rem; font-weight:600; color:var(--text); margin-bottom:20px; }
.f-grp { margin-bottom:14px; }
.f-lbl { display:block; font-size:0.68rem; color:var(--text3); text-transform:uppercase;
  letter-spacing:0.8px; margin-bottom:6px; }
.f-inp, .f-sel, .f-area {
  width:100%; background:var(--card); border:1.5px solid var(--border);
  border-radius:10px; padding:10px 14px; color:var(--text);
  font-family:inherit; font-size:0.92rem; outline:none; transition:border-color 0.2s;
}
.f-inp:focus,.f-sel:focus,.f-area:focus { border-color:var(--accent-blue); }
.f-inp::placeholder { color:var(--text3); }
.f-sel option { background:var(--bg2); }
.f-area { min-height:80px; resize:vertical; }
/* Rich text editor */
.rte-toolbar {
  display:flex; align-items:center; gap:4px; padding:4px 6px;
  background:rgba(255,255,255,0.04); border:1px solid var(--border);
  border-bottom:none; border-radius:10px 10px 0 0;
}
.rte-btn {
  background:rgba(255,255,255,0.06); border:1px solid var(--border);
  border-radius:5px; padding:3px 8px; font-size:0.78rem; color:var(--text2);
  cursor:pointer; min-width:28px; text-align:center; line-height:1.2;
}
.rte-btn:active { background:rgba(167,139,250,0.2); color:var(--lavender); }
.rte-sep { width:1px; height:18px; background:var(--border); margin:0 2px; }
.rte-color {
  width:26px; height:26px; border:1px solid var(--border); border-radius:5px;
  padding:1px; cursor:pointer; background:transparent;
}
.rte-editable {
  border-radius:0 0 10px 10px !important; outline:none;
  white-space:pre-wrap; word-wrap:break-word; overflow-y:auto;
  max-height:300px; line-height:1.6;
}
.rte-editable:empty::before {
  content:attr(data-placeholder); color:var(--text3); font-style:italic;
  pointer-events:none;
}
.f-row { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
.f-submit {
  width:100%; background:var(--accent-blue); border:none;
  border-radius:12px; padding:14px; color:white;
  font-size:0.95rem; font-family:inherit; cursor:pointer; margin-top:8px;
  transition:opacity 0.2s;
}
.f-submit:active { opacity:0.85; }
.f-cancel { width:100%; background:transparent; border:none;
  color:var(--text3); padding:12px; cursor:pointer; font-family:inherit; font-size:0.9rem; }

/* Toast */
/* ===== EVENT DETAIL MODAL ===== */
.evt-modal-overlay {
  position: fixed; inset: 0; z-index: 5000;
  background: rgba(0,0,0,0.55);
  display: flex; align-items: flex-end;
  opacity: 0; pointer-events: none;
  transition: opacity 0.25s;
}
.evt-modal-overlay.open {
  opacity: 1; pointer-events: auto;
}
.evt-modal-sheet {
  width: 100%; max-width: 600px; margin: 0 auto;
  background: var(--card);
  border-radius: 20px 20px 0 0;
  padding: 0 0 32px;
  transform: translateY(100%);
  transition: transform 0.3s cubic-bezier(0.32,0.72,0,1);
  max-height: 75vh;
  overflow-y: auto;
}
.evt-modal-overlay.open .evt-modal-sheet {
  transform: translateY(0);
}
.evt-modal-handle {
  width: 36px; height: 4px; border-radius: 2px;
  background: rgba(255,255,255,0.18);
  margin: 12px auto 0;
}
.evt-modal-header {
  display: flex; align-items: flex-start; justify-content: space-between;
  padding: 16px 20px 12px;
  border-bottom: 1px solid var(--border);
  gap: 12px;
}
.evt-modal-title-wrap { flex: 1; min-width: 0; }
.evt-modal-type {
  font-size: 0.65rem; font-weight: 700; text-transform: uppercase;
  letter-spacing: 1px; margin-bottom: 5px;
}
.evt-modal-title {
  font-size: 1.05rem; font-weight: 600; color: var(--text);
  line-height: 1.35; word-wrap: break-word;
}
.evt-modal-close {
  background: rgba(255,255,255,0.08); border: none;
  border-radius: 50%; width: 32px; height: 32px; flex-shrink: 0;
  cursor: pointer; color: var(--text2); font-size: 1rem;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.15s;
}
.evt-modal-close:active { background: rgba(255,255,255,0.18); }
.evt-modal-date {
  padding: 14px 20px 0;
  font-size: 0.82rem; color: var(--text3);
  display: flex; align-items: center; gap: 6px;
}
.evt-modal-desc {
  padding: 12px 20px 0;
  font-size: 0.9rem; color: var(--text2);
  line-height: 1.6; word-wrap: break-word;
}
/* User notes section */
.evt-modal-notes {
  padding: 14px 20px 0;
}
.evt-notes-divider {
  border: none; border-top: 1px solid var(--border); margin: 0 0 12px;
}
.evt-notes-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 8px;
}
.evt-notes-label {
  font-size: 0.72rem; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.8px; color: var(--text3);
}
.evt-notes-edit-btn {
  background: rgba(167,139,250,0.12); border: 1px solid rgba(167,139,250,0.25);
  border-radius: 8px; padding: 5px 12px; font-size: 0.75rem; font-weight: 600;
  color: var(--lavender); cursor: pointer; transition: background 0.15s;
}
.evt-notes-edit-btn:active { background: rgba(167,139,250,0.25); }
.evt-notes-font-btn {
  background: rgba(255,255,255,0.06); border: 1px solid var(--border);
  border-radius: 6px; padding: 3px 8px; font-size: 0.68rem; font-weight: 700;
  color: var(--text3); cursor: pointer; transition: background 0.15s;
  min-width: 28px; text-align: center;
}
.evt-notes-font-btn:active { background: rgba(255,255,255,0.12); }
.evt-notes-display {
  font-size: 0.88rem; color: var(--text2); line-height: 1.65;
  white-space: pre-wrap; word-wrap: break-word;
}
.evt-notes-display:empty::after {
  content: 'No additional information yet.';
  color: var(--text3); font-style: italic; font-size: 0.82rem;
}
.evt-notes-editor {
  display: none; flex-direction: column; gap: 10px;
}
.evt-notes-editor.active { display: flex; }
.evt-notes-textarea {
  width: 100%; min-height: 120px; max-height: 250px;
  background: rgba(255,255,255,0.05); border: 1px solid var(--border);
  border-radius: 10px; padding: 12px; font-size: 0.88rem;
  color: var(--text); line-height: 1.6; resize: vertical;
  font-family: inherit; outline: none;
  transition: border-color 0.2s;
}
.evt-notes-textarea:focus { border-color: var(--lavender); }
.evt-notes-actions {
  display: flex; gap: 8px; justify-content: flex-end;
}
.evt-notes-save {
  background: var(--lavender); border: none; border-radius: 8px;
  padding: 7px 18px; font-size: 0.8rem; font-weight: 600;
  color: #1a1a2e; cursor: pointer; transition: opacity 0.15s;
}
.evt-notes-save:active { opacity: 0.8; }
.evt-notes-cancel {
  background: rgba(255,255,255,0.08); border: 1px solid var(--border);
  border-radius: 8px; padding: 7px 14px; font-size: 0.8rem; font-weight: 600;
  color: var(--text2); cursor: pointer; transition: background 0.15s;
}
.evt-notes-cancel:active { background: rgba(255,255,255,0.15); }
.evt-notes-delete {
  background: rgba(231,76,60,0.12); border: 1px solid rgba(231,76,60,0.25);
  border-radius: 8px; padding: 7px 14px; font-size: 0.8rem; font-weight: 600;
  color: #e74c3c; cursor: pointer; margin-right: auto;
  transition: background 0.15s;
}
.evt-notes-delete:active { background: rgba(231,76,60,0.25); }

/* Sign-in prompt modal */
.signin-prompt-overlay {
  position: fixed; inset: 0; z-index: 6000;
  background: rgba(0,0,0,0.6);
  display: flex; align-items: center; justify-content: center;
  opacity: 0; pointer-events: none; transition: opacity 0.25s;
}
.signin-prompt-overlay.open { opacity: 1; pointer-events: auto; }
.signin-prompt-sheet {
  background: var(--card); border-radius: 18px;
  padding: 28px 24px; max-width: 340px; width: 90%;
  text-align: center; transform: scale(0.92);
  transition: transform 0.3s cubic-bezier(0.32,0.72,0,1);
}
.signin-prompt-overlay.open .signin-prompt-sheet { transform: scale(1); }
.signin-prompt-icon { font-size: 2.5rem; margin-bottom: 12px; }
.signin-prompt-title { font-size: 1.05rem; font-weight: 700; color: var(--text); margin-bottom: 8px; }
.signin-prompt-text { font-size: 0.82rem; color: var(--text3); line-height: 1.6; margin-bottom: 20px; }
.signin-prompt-text strong { color: var(--text2); }
.signin-prompt-btn {
  display: inline-flex; align-items: center; gap: 8px;
  background: rgba(61,127,212,0.15); border: 1px solid rgba(61,127,212,0.3);
  border-radius: 10px; padding: 10px 22px; font-size: 0.88rem; font-weight: 600;
  color: var(--accent-blue); cursor: pointer; transition: background 0.15s;
  margin-bottom: 10px;
}
.signin-prompt-btn:active { background: rgba(61,127,212,0.25); }
.signin-prompt-dismiss {
  display: block; margin: 0 auto; background: none; border: none;
  font-size: 0.78rem; color: var(--text3); cursor: pointer;
  padding: 6px 12px; text-decoration: underline;
}

/* Admin panel in settings */
.admin-section { margin-top: 6px; }
.admin-badge {
  display: inline-block; background: rgba(167,139,250,0.15);
  border: 1px solid rgba(167,139,250,0.3); border-radius: 6px;
  padding: 2px 8px; font-size: 0.68rem; font-weight: 700;
  color: var(--lavender); letter-spacing: 0.5px; text-transform: uppercase;
}
.admin-email-list { margin: 10px 0; }
.admin-email-row {
  display: flex; align-items: center; gap: 8px; padding: 8px 10px;
  background: rgba(255,255,255,0.03); border-radius: 8px;
  margin-bottom: 4px; font-size: 0.82rem; color: var(--text2);
}
.admin-email-row .admin-super { font-size: 0.65rem; color: var(--lavender); font-weight: 600; margin-left: 4px; }
.admin-remove-btn {
  margin-left: auto; background: rgba(231,76,60,0.12);
  border: 1px solid rgba(231,76,60,0.2); border-radius: 6px;
  padding: 3px 10px; font-size: 0.7rem; color: #e74c3c;
  cursor: pointer;
}
.admin-remove-btn:active { background: rgba(231,76,60,0.25); }
.admin-add-row {
  display: flex; gap: 8px; margin-top: 8px;
}
.admin-add-input {
  flex: 1; background: rgba(255,255,255,0.05); border: 1px solid var(--border);
  border-radius: 8px; padding: 8px 12px; font-size: 0.82rem;
  color: var(--text); outline: none; font-family: inherit;
}
.admin-add-input:focus { border-color: var(--lavender); }
.admin-add-btn {
  background: rgba(167,139,250,0.15); border: 1px solid rgba(167,139,250,0.3);
  border-radius: 8px; padding: 8px 14px; font-size: 0.8rem; font-weight: 600;
  color: var(--lavender); cursor: pointer; white-space: nowrap;
}
.admin-add-btn:active { background: rgba(167,139,250,0.3); }
.admin-export-row { margin-top: 12px; display: flex; gap: 8px; }
.admin-export-btn {
  background: rgba(255,255,255,0.06); border: 1px solid var(--border);
  border-radius: 8px; padding: 7px 14px; font-size: 0.78rem; font-weight: 600;
  color: var(--text2); cursor: pointer;
}
.admin-export-btn:active { background: rgba(255,255,255,0.12); }
/* Admin permissions */
.admin-perms-wrap { margin-top: 8px; }
.admin-perms-label { font-size: 0.72rem; color: var(--text3); margin-bottom: 6px; }
.admin-perm-row {
  display: flex; align-items: center; gap: 8px; padding: 6px 10px;
  background: rgba(255,255,255,0.03); border-radius: 8px; margin-bottom: 4px;
}
.admin-perm-row label { font-size: 0.8rem; color: var(--text2); cursor: pointer; display:flex; align-items:center; gap:8px; flex:1; }
.admin-perm-row input[type="checkbox"] { accent-color: var(--lavender); width:16px; height:16px; cursor:pointer; }
.admin-perm-tags { display: flex; gap: 4px; flex-wrap: wrap; margin-top: 2px; }
.admin-perm-tag {
  font-size: 0.6rem; padding: 2px 7px; border-radius: 4px;
  background: rgba(61,127,212,0.12); color: var(--accent-blue); font-weight: 500;
}
.admin-perm-tag.perm-songs { background: rgba(167,139,250,0.12); color: var(--lavender); }
.admin-perm-tag.perm-dhamas { background: rgba(212,175,55,0.12); color: var(--accent-gold); }
.admin-perm-tag.perm-sevakart { background: rgba(180,120,40,0.12); color: #d4a017; }
.admin-perm-tag.perm-prayer { background: rgba(232,168,56,0.12); color: #f0c850; }
.admin-perm-tag.perm-users { background: rgba(52,152,219,0.12); color: #3498db; }
.evt-modal-icon {
  padding: 18px 20px 0;
  font-size: 2.4rem; text-align: center;
}

.toast { position:fixed; bottom:90px; left:50%; transform:translateX(-50%) translateY(60px);
  background:var(--card); border:1px solid var(--border); border-radius:10px;
  padding:10px 20px; color:var(--text); font-size:0.85rem; z-index:300;
  transition:transform 0.3s, opacity 0.3s; white-space:nowrap; max-width:calc(100% - 40px);
  text-align:center; opacity:0; pointer-events:none; }
.toast.show { transform:translateX(-50%) translateY(0); opacity:1; pointer-events:auto; }

/* Update notification banner */
.update-banner {
  position:fixed; top:0; left:0; right:0; max-width:430px; margin:0 auto;
  z-index:500; transform:translateY(-100%); transition:transform 0.4s cubic-bezier(0.4,0,0.2,1);
  pointer-events:none;
}
.update-banner.show { transform:translateY(0); pointer-events:auto; }
.update-banner-inner {
  margin:12px; padding:16px 18px;
  background:linear-gradient(135deg, rgba(61,127,212,0.95), rgba(99,102,241,0.95));
  backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px);
  border-radius:16px; border:1px solid rgba(255,255,255,0.15);
  box-shadow:0 8px 32px rgba(0,0,0,0.4);
  display:flex; align-items:center; gap:14px;
  animation:bannerGlow 2s ease-in-out infinite alternate;
}
@keyframes bannerGlow {
  from { box-shadow:0 8px 32px rgba(0,0,0,0.4); }
  to { box-shadow:0 8px 32px rgba(61,127,212,0.3); }
}
.update-banner-icon {
  font-size:1.6rem; flex-shrink:0;
  animation:bannerPulse 1.5s ease-in-out infinite;
}
@keyframes bannerPulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.15)} }
.update-banner-text { flex:1; min-width:0; }
.update-banner-title {
  font-size:0.88rem; font-weight:700; color:#fff; margin-bottom:3px;
}
.update-banner-desc {
  font-size:0.72rem; color:rgba(255,255,255,0.8); line-height:1.4;
}
.update-banner-dismiss {
  background:rgba(255,255,255,0.2); border:1px solid rgba(255,255,255,0.25);
  border-radius:8px; padding:6px 14px; color:#fff; font-size:0.75rem;
  font-weight:600; cursor:pointer; white-space:nowrap; flex-shrink:0;
  font-family:inherit; transition:background 0.2s;
}
.update-banner-dismiss:active { background:rgba(255,255,255,0.35); }

/* Scrollbar */
::-webkit-scrollbar { width:3px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:rgba(255,255,255,0.1); border-radius:2px; }

.empty-state { text-align:center; padding:40px 20px; color:var(--text3); font-size:0.85rem; }
.empty-state-icon { font-size:2.5rem; margin-bottom:10px; }

/* ===== SEVAKART ===== */
.sk-screen { flex:1; overflow-y:auto; padding-bottom:70px; }
.sk-header {
  text-align:center; padding:18px 18px 12px;
  background:linear-gradient(180deg, rgba(180,120,40,0.08) 0%, transparent 100%);
}
.sk-title { font-family:'Philosopher',serif; font-size:1.3rem; font-weight:700;
  background:linear-gradient(135deg, #d4a017, #f0d060, #d4a017);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
.sk-subtitle { font-size:0.72rem; color:var(--text3); letter-spacing:1.5px; margin-top:2px; }
.sk-search-bar {
  display:flex; gap:8px; padding:8px 18px 12px; align-items:center;
}
.sk-search-inp {
  flex:1; background:var(--card); border:1.5px solid var(--border); border-radius:10px;
  padding:9px 14px; color:var(--text); font-size:0.85rem; outline:none; font-family:inherit;
}
.sk-search-inp:focus { border-color:var(--accent-gold); }
.sk-search-inp::placeholder { color:var(--text3); }
.sk-filter-btn {
  background:var(--card); border:1.5px solid var(--border); border-radius:10px;
  padding:8px 12px; color:var(--text2); font-size:0.85rem; cursor:pointer;
}
.sk-filter-btn:active { border-color:var(--accent-gold); }
.sk-actions { display:flex; gap:8px; padding:0 18px 14px; }
.sk-action-btn {
  flex:1; background:rgba(212,160,23,0.1); border:1px solid rgba(212,160,23,0.25);
  border-radius:10px; padding:10px 8px; text-align:center;
  font-size:0.78rem; font-weight:600; color:var(--accent-gold); cursor:pointer;
}
.sk-action-btn:active { background:rgba(212,160,23,0.2); }
.sk-action-btn.secondary { background:rgba(167,139,250,0.08); border-color:rgba(167,139,250,0.25); color:var(--lavender); }
.sk-action-btn.secondary:active { background:rgba(167,139,250,0.18); }
.sk-section-title {
  font-size:0.7rem; color:var(--text3); text-transform:uppercase; letter-spacing:1px;
  padding:0 18px 8px; font-weight:600;
}
.sk-categories {
  display:grid; grid-template-columns:repeat(4,1fr); gap:8px;
  padding:0 18px 16px;
}
.sk-cat-card {
  display:flex; flex-direction:column; align-items:center; gap:4px;
  background:var(--card); border:1px solid var(--border); border-radius:12px;
  padding:12px 4px 10px; cursor:pointer; transition:border-color 0.2s;
}
.sk-cat-card:active { border-color:var(--accent-gold); }
.sk-cat-icon { font-size:1.4rem; }
.sk-cat-name { font-size:0.6rem; color:var(--text2); text-align:center; line-height:1.2; }
.sk-listings { padding:0 18px 16px; display:flex; flex-direction:column; gap:10px; }
.sk-listing-card {
  background:var(--card); border:1px solid var(--border); border-radius:14px;
  overflow:hidden; cursor:pointer; transition:border-color 0.2s;
}
.sk-listing-card:active { border-color:var(--accent-gold); }
.sk-listing-img {
  width:100%; height:140px; object-fit:cover; background:var(--bg3);
  display:flex; align-items:center; justify-content:center;
  font-size:2.5rem; color:var(--text3);
}
.sk-listing-img img { width:100%; height:140px; object-fit:cover; }
.sk-listing-body { padding:12px 14px; }
.sk-listing-top { display:flex; justify-content:space-between; align-items:flex-start; gap:8px; }
.sk-listing-name { font-size:0.92rem; font-weight:600; color:var(--text); }
.sk-listing-verified { font-size:0.6rem; background:rgba(39,174,96,0.15); color:var(--accent-green);
  border-radius:4px; padding:2px 6px; white-space:nowrap; font-weight:600; }
.sk-listing-desc { font-size:0.78rem; color:var(--text2); margin-top:4px; line-height:1.3;
  display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
.sk-listing-meta { display:flex; align-items:center; gap:10px; margin-top:8px; flex-wrap:wrap; }
.sk-listing-city { font-size:0.7rem; color:var(--text3); }
.sk-listing-rating { font-size:0.7rem; color:var(--accent-gold); }
.sk-listing-cat-tag { font-size:0.6rem; background:rgba(167,139,250,0.1); color:var(--lavender);
  border-radius:4px; padding:2px 6px; }
.sk-listing-status { font-size:0.6rem; border-radius:4px; padding:2px 6px; font-weight:600; }
.sk-listing-status.pending { background:rgba(241,196,15,0.15); color:#f1c40f; }
.sk-listing-status.approved { background:rgba(39,174,96,0.15); color:var(--accent-green); }
.sk-listing-status.rejected { background:rgba(192,57,43,0.15); color:var(--accent-red); }
.sk-listing-status.suspended { background:rgba(155,89,182,0.15); color:#9b59b6; }
.sk-empty { text-align:center; padding:40px 20px; color:var(--text3); }
.sk-empty-icon { font-size:2.5rem; margin-bottom:10px; }

/* SevaKart Detail Screen */
.sk-detail { flex:1; overflow-y:auto; padding-bottom:70px; }
.sk-detail-header {
  display:flex; align-items:center; gap:12px; padding:12px 18px;
  border-bottom:1px solid var(--border); flex-shrink:0;
}
.sk-detail-back { background:none; border:none; color:var(--text); font-size:1.2rem; cursor:pointer; padding:4px; }
.sk-detail-htitle { font-size:1rem; font-weight:600; color:var(--text); flex:1;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.sk-detail-gallery { position:relative; height:200px; background:var(--bg3);
  display:flex; align-items:center; justify-content:center; overflow:hidden; }
.sk-detail-gallery img { width:100%; height:200px; object-fit:cover; }
.sk-detail-gallery-placeholder { font-size:3rem; color:var(--text3); }
.sk-detail-gallery-dots { position:absolute; bottom:8px; display:flex; gap:6px; }
.sk-detail-gallery-dot { width:8px; height:8px; border-radius:50%; background:rgba(255,255,255,0.4); }
.sk-detail-gallery-dot.active { background:var(--accent-gold); }
.sk-detail-body { padding:16px 18px; }
.sk-detail-name { font-size:1.15rem; font-weight:700; color:var(--text); }
.sk-detail-badges { display:flex; gap:6px; margin-top:6px; flex-wrap:wrap; }
.sk-detail-cat { font-size:0.7rem; background:rgba(167,139,250,0.1); color:var(--lavender);
  border-radius:5px; padding:3px 8px; }
.sk-detail-city-tag { font-size:0.7rem; background:rgba(61,127,212,0.1); color:var(--accent-blue);
  border-radius:5px; padding:3px 8px; }
.sk-detail-verified { font-size:0.7rem; background:rgba(39,174,96,0.15); color:var(--accent-green);
  border-radius:5px; padding:3px 8px; font-weight:600; }
.sk-detail-rating-row { display:flex; align-items:center; gap:8px; margin-top:10px; }
.sk-detail-stars { color:var(--accent-gold); font-size:0.9rem; }
.sk-detail-rating-num { font-size:0.8rem; color:var(--text2); }
.sk-detail-desc { font-size:0.88rem; color:var(--text2); line-height:1.5; margin-top:14px;
  white-space:pre-wrap; }
.sk-detail-years { font-size:0.78rem; color:var(--text3); margin-top:8px; }
.sk-detail-section {
  margin-top:18px; padding-top:14px; border-top:1px solid var(--border);
}
.sk-detail-section-title { font-size:0.72rem; color:var(--text3); text-transform:uppercase;
  letter-spacing:0.8px; margin-bottom:10px; font-weight:600; }
.sk-contact-btns { display:flex; gap:8px; flex-wrap:wrap; }
.sk-contact-btn {
  flex:1; min-width:80px; display:flex; align-items:center; justify-content:center; gap:6px;
  padding:10px 12px; border-radius:10px; border:1px solid var(--border);
  font-size:0.8rem; font-weight:600; cursor:pointer; text-decoration:none;
}
.sk-contact-btn.whatsapp { background:rgba(37,211,102,0.1); border-color:rgba(37,211,102,0.3); color:#25d366; }
.sk-contact-btn.call { background:rgba(61,127,212,0.1); border-color:rgba(61,127,212,0.3); color:var(--accent-blue); }
.sk-contact-btn.email { background:rgba(155,89,182,0.1); border-color:rgba(155,89,182,0.3); color:#9b59b6; }
.sk-contact-btn.website { background:rgba(212,160,23,0.1); border-color:rgba(212,160,23,0.3); color:var(--accent-gold); }
.sk-contact-btn:active { opacity:0.7; }
.sk-disclaimer {
  font-size:0.68rem; color:var(--text3); text-align:center; margin-top:14px;
  padding:10px; background:rgba(255,255,255,0.02); border-radius:8px; line-height:1.4;
}
.sk-report-btn {
  display:block; width:100%; text-align:center; margin-top:12px;
  font-size:0.75rem; color:var(--accent-red); cursor:pointer;
  background:none; border:none; padding:8px;
}
.sk-report-btn:active { opacity:0.6; }

/* Reviews */
.sk-review-card {
  background:rgba(255,255,255,0.03); border:1px solid var(--border);
  border-radius:10px; padding:10px 12px; margin-bottom:8px;
}
.sk-review-top { display:flex; justify-content:space-between; align-items:center; }
.sk-review-user { font-size:0.8rem; font-weight:600; color:var(--text); }
.sk-review-stars { font-size:0.75rem; color:var(--accent-gold); }
.sk-review-text { font-size:0.78rem; color:var(--text2); margin-top:4px; line-height:1.3; }
.sk-review-date { font-size:0.62rem; color:var(--text3); margin-top:4px; }
.sk-add-review-btn {
  background:rgba(212,160,23,0.1); border:1px solid rgba(212,160,23,0.25);
  border-radius:10px; padding:10px; text-align:center; font-size:0.8rem;
  font-weight:600; color:var(--accent-gold); cursor:pointer; margin-top:8px; width:100%;
}
.sk-add-review-btn:active { background:rgba(212,160,23,0.2); }

/* Admin badge on detail */
.sk-admin-actions { display:flex; gap:8px; margin-top:12px; flex-wrap:wrap; }
.sk-admin-btn {
  flex:1; min-width:80px; padding:8px; border-radius:8px; border:1px solid var(--border);
  font-size:0.72rem; font-weight:600; cursor:pointer; text-align:center;
}
.sk-admin-btn.approve { background:rgba(39,174,96,0.1); border-color:rgba(39,174,96,0.3); color:var(--accent-green); }
.sk-admin-btn.reject { background:rgba(192,57,43,0.1); border-color:rgba(192,57,43,0.3); color:var(--accent-red); }
.sk-admin-btn.verify { background:rgba(167,139,250,0.1); border-color:rgba(167,139,250,0.3); color:var(--lavender); }
.sk-admin-btn.suspend { background:rgba(241,196,15,0.1); border-color:rgba(241,196,15,0.3); color:#f1c40f; }
.sk-admin-btn.delete { background:rgba(192,57,43,0.08); border-color:rgba(192,57,43,0.2); color:var(--accent-red); }
.sk-admin-btn:active { opacity:0.7; }

/* Admin dashboard */
.sk-admin-dashboard { padding:0 18px 16px; }
.sk-admin-stats { display:grid; grid-template-columns:repeat(2,1fr); gap:8px; margin-bottom:12px; }
.sk-admin-stat {
  background:var(--card); border:1px solid var(--border); border-radius:10px;
  padding:12px; text-align:center;
}
.sk-admin-stat-num { font-size:1.3rem; font-weight:700; color:var(--text); }
.sk-admin-stat-lbl { font-size:0.62rem; color:var(--text3); text-transform:uppercase; letter-spacing:0.5px; margin-top:2px; }
.sk-admin-pending-list { display:flex; flex-direction:column; gap:8px; }

/* Listing form steps */
.sk-form-step { display:none; }
.sk-form-step.active { display:block; }
.sk-step-indicator { display:flex; gap:4px; justify-content:center; margin-bottom:16px; }
.sk-step-dot { width:8px; height:8px; border-radius:50%; background:var(--border); }
.sk-step-dot.active { background:var(--accent-gold); }
.sk-step-dot.done { background:var(--accent-green); }
.sk-eligibility-check { display:flex; align-items:flex-start; gap:10px; margin-bottom:12px;
  padding:10px; background:rgba(255,255,255,0.02); border-radius:8px; }
.sk-eligibility-check input { accent-color:var(--accent-gold); width:18px; height:18px; margin-top:2px; flex-shrink:0; cursor:pointer; }
.sk-eligibility-check label { font-size:0.82rem; color:var(--text2); line-height:1.4; cursor:pointer; }
.sk-photo-upload {
  display:flex; gap:8px; flex-wrap:wrap;
}
.sk-photo-slot {
  width:80px; height:80px; border:2px dashed var(--border); border-radius:10px;
  display:flex; align-items:center; justify-content:center; cursor:pointer;
  font-size:1.2rem; color:var(--text3); position:relative; overflow:hidden;
  background:var(--bg3);
}
.sk-photo-slot img { width:100%; height:100%; object-fit:cover; }
.sk-photo-slot .sk-photo-remove {
  position:absolute; top:2px; right:2px; background:rgba(0,0,0,0.7);
  color:#fff; border:none; border-radius:50%; width:18px; height:18px;
  font-size:0.65rem; cursor:pointer; display:flex; align-items:center; justify-content:center;
}
.sk-preview-card {
  background:var(--card); border:1px solid var(--border); border-radius:14px;
  padding:14px; margin-bottom:12px;
}
.sk-preview-label { font-size:0.65rem; color:var(--text3); text-transform:uppercase;
  letter-spacing:0.5px; margin-bottom:2px; }
.sk-preview-value { font-size:0.88rem; color:var(--text); }

/* Star rating input */
.sk-star-input { display:flex; gap:4px; }
.sk-star-input span { font-size:1.5rem; cursor:pointer; color:var(--text3); transition:color 0.15s; }
.sk-star-input span.filled { color:var(--accent-gold); }

/* My Listings */
.sk-my-listings { padding:0 18px 16px; display:flex; flex-direction:column; gap:10px; }

/* Filter modal */
.sk-filter-section { margin-bottom:14px; }
.sk-filter-lbl { font-size:0.7rem; color:var(--text3); text-transform:uppercase;
  letter-spacing:0.5px; margin-bottom:6px; }
.sk-filter-chips { display:flex; flex-wrap:wrap; gap:6px; }
.sk-filter-chip {
  background:var(--card); border:1px solid var(--border); border-radius:20px;
  padding:6px 12px; font-size:0.75rem; color:var(--text2); cursor:pointer;
}
.sk-filter-chip.active { background:rgba(212,160,23,0.15); border-color:rgba(212,160,23,0.4); color:var(--accent-gold); }

/* ===== HOME SCREEN ===== */
.home-wrap {
  padding:0 0 30px; overflow-y:auto; height:100%;
  scrollbar-width:none; -ms-overflow-style:none;
  background:linear-gradient(180deg, var(--bg) 0%, rgba(13,27,42,0.97) 100%);
}
.home-wrap::-webkit-scrollbar { display:none; }

/* â”€â”€ Google Account Bar â”€â”€ */
.home-gbar {
  padding:14px 18px 12px;
  display:flex; align-items:center; gap:12px;
  position:relative;
}
.home-gbar::after {
  content:''; position:absolute; bottom:0; left:20px; right:20px;
  height:1px; background:linear-gradient(90deg, transparent, rgba(167,139,250,0.15), transparent);
}

/* Signed-in avatar */
.home-g-avatar {
  width:40px; height:40px; border-radius:50%; flex-shrink:0;
  border:2.5px solid rgba(167,139,250,0.4);
  object-fit:cover; background:var(--card);
  box-shadow:0 0 16px rgba(167,139,250,0.2), 0 2px 8px rgba(0,0,0,0.3);
  transition:border-color 0.3s;
}

/* Signed-out Google button */
.home-g-btn-wrap {
  width:40px; height:40px; border-radius:50%; flex-shrink:0;
  background:var(--card); border:2px solid rgba(255,255,255,0.1);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition:all 0.2s;
  box-shadow:0 2px 8px rgba(0,0,0,0.2);
  position:relative; overflow:hidden;
}
.home-g-btn-wrap:active { transform:scale(0.93); border-color:rgba(66,133,244,0.4); }
.home-g-btn-wrap::after {
  content:''; position:absolute; inset:0; border-radius:50%;
  background:radial-gradient(circle at center, rgba(66,133,244,0.06), transparent 70%);
}
/* Google "G" multi-color SVG */
.home-g-logo { width:20px; height:20px; position:relative; z-index:1; }

.home-g-info { flex:1; min-width:0; }
.home-g-name {
  font-family:'Philosopher', serif; font-size:0.9rem; font-weight:600;
  color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  line-height:1.3;
}
.home-g-email {
  font-size:0.65rem; color:var(--text3);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-top:1px;
}
.home-g-signin-cta {
  font-size:0.72rem; color:rgba(66,133,244,0.9); cursor:pointer;
  font-weight:500; letter-spacing:0.2px; margin-top:2px;
  transition:color 0.2s;
}
.home-g-signin-cta:active { color:rgba(66,133,244,0.6); }
.home-g-actions { flex-shrink:0; display:flex; gap:8px; align-items:center; }
.home-g-action-btn {
  width:32px; height:32px; border-radius:50%;
  background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.06);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition:all 0.2s; color:var(--text3);
}
.home-g-action-btn:active { background:rgba(255,255,255,0.08); color:var(--text); transform:scale(0.9); }
.home-g-action-btn svg { width:15px; height:15px; }

/* â”€â”€ Greeting Section â”€â”€ */
.home-greeting {
  padding:18px 22px 4px;
  position:relative;
  text-align:center;
}
.home-greet-text {
  font-family:'Playfair Display', 'Philosopher', serif;
  font-size:1.55rem; font-weight:600;
  color:var(--text); line-height:1.3;
  letter-spacing:0.3px;
}
.home-greet-sub {
  font-size:0.76rem; color:var(--text3); margin-top:7px;
  line-height:1.55; letter-spacing:0.1px;
}
.home-greet-sub .hg-date { color:var(--text2); font-weight:500; }
.home-greet-sub .hg-vaishnava {
  font-family:'Playfair Display', serif; font-style:italic;
  color:var(--lavender); opacity:0.75; font-size:0.72rem;
}

/* â”€â”€ Today's Highlight â”€â”€ */
.home-today {
  margin:12px 18px 2px; padding:14px 16px;
  background:linear-gradient(135deg, rgba(61,127,212,0.07) 0%, rgba(167,139,250,0.05) 50%, rgba(212,160,23,0.04) 100%);
  border:1px solid rgba(61,127,212,0.12); border-radius:14px;
  cursor:pointer; transition:transform 0.15s;
  position:relative; overflow:hidden;
  opacity:0; animation:homeIn 0.5s ease 0.1s forwards;
}
.home-today::before {
  content:''; position:absolute; left:0; top:0; bottom:0; width:3px;
  background:linear-gradient(180deg, var(--accent-blue), var(--lavender));
  border-radius:3px 0 0 3px;
}
.home-today:active { transform:scale(0.98); }
.home-today-label {
  font-size:0.58rem; text-transform:uppercase; letter-spacing:1.5px;
  color:var(--accent-blue); font-weight:600; margin-bottom:6px;
}
.home-today-text { font-size:0.8rem; color:var(--text); line-height:1.5; }
.home-today-text .ht-event { color:var(--accent-gold); font-weight:500; }

@keyframes homeIn {
  from { opacity:0; transform:translateY(12px); }
  to   { opacity:1; transform:translateY(0); }
}

/* â”€â”€ Feature Grid â”€â”€ */
.home-grid {
  display:grid; grid-template-columns:1fr 1fr; gap:14px;
  padding:16px 18px 10px;
}
.home-card {
  border-radius:18px; padding:18px 16px 16px;
  cursor:pointer; position:relative; overflow:hidden;
  transition:transform 0.15s ease, box-shadow 0.15s ease;
  display:flex; flex-direction:column; gap:8px;
  min-height:118px;
  opacity:0; animation:homeIn 0.45s ease forwards;
}
.home-card:nth-child(1) { animation-delay:0.08s; }
.home-card:nth-child(2) { animation-delay:0.14s; }
.home-card:nth-child(3) { animation-delay:0.20s; }
.home-card:nth-child(4) { animation-delay:0.26s; }
.home-card:nth-child(5) { animation-delay:0.32s; }
.home-card:nth-child(6) { animation-delay:0.38s; }
.home-card:nth-child(7) { animation-delay:0.44s; }
.home-card:nth-child(8) { animation-delay:0.50s; }
.home-card:active { transform:scale(0.95); }

/* Corner glow orb */
.home-card::after {
  content:''; position:absolute; top:-40px; right:-40px;
  width:110px; height:110px; border-radius:50%;
  pointer-events:none; filter:blur(8px);
}

/* â”€â”€ Calendar â”€â”€ */
.home-card--calendar {
  background:linear-gradient(145deg, rgba(61,127,212,0.18) 0%, rgba(26,48,80,0.95) 60%, var(--card) 100%);
  border:1px solid rgba(61,127,212,0.3);
  box-shadow:0 4px 20px rgba(61,127,212,0.12), inset 0 1px 0 rgba(61,127,212,0.15);
}
.home-card--calendar::after { background:rgba(61,127,212,0.25); }

/* â”€â”€ Kirtans / Audio â”€â”€ */
.home-card--audio {
  background:linear-gradient(145deg, rgba(230,140,50,0.18) 0%, rgba(55,32,12,0.95) 60%, var(--card) 100%);
  border:1px solid rgba(230,140,50,0.3);
  box-shadow:0 4px 20px rgba(230,140,50,0.1), inset 0 1px 0 rgba(230,140,50,0.15);
}
.home-card--audio::after { background:rgba(230,140,50,0.25); }

/* â”€â”€ Notes â”€â”€ */
.home-card--notes {
  background:linear-gradient(145deg, rgba(167,139,250,0.18) 0%, rgba(40,30,60,0.95) 60%, var(--card) 100%);
  border:1px solid rgba(167,139,250,0.3);
  box-shadow:0 4px 20px rgba(167,139,250,0.1), inset 0 1px 0 rgba(167,139,250,0.15);
}
.home-card--notes::after { background:rgba(167,139,250,0.25); }

/* â”€â”€ SevaKart â”€â”€ */
.home-card--sevakart {
  background:linear-gradient(145deg, rgba(6,182,212,0.18) 0%, rgba(12,45,55,0.95) 60%, var(--card) 100%);
  border:1px solid rgba(6,182,212,0.3);
  box-shadow:0 4px 20px rgba(6,182,212,0.1), inset 0 1px 0 rgba(6,182,212,0.15);
}
.home-card--sevakart::after { background:rgba(6,182,212,0.25); }

/* â”€â”€ Dhamas â”€â”€ */
.home-card--dhamas {
  background:linear-gradient(145deg, rgba(192,57,43,0.18) 0%, rgba(50,20,20,0.95) 60%, var(--card) 100%);
  border:1px solid rgba(192,57,43,0.3);
  box-shadow:0 4px 20px rgba(192,57,43,0.1), inset 0 1px 0 rgba(192,57,43,0.15);
}
.home-card--dhamas::after { background:rgba(192,57,43,0.25); }

/* â”€â”€ My Events â”€â”€ */
.home-card--events {
  background:linear-gradient(145deg, rgba(39,174,96,0.18) 0%, rgba(15,45,28,0.95) 60%, var(--card) 100%);
  border:1px solid rgba(39,174,96,0.3);
  box-shadow:0 4px 20px rgba(39,174,96,0.1), inset 0 1px 0 rgba(39,174,96,0.15);
}
.home-card--events::after { background:rgba(39,174,96,0.25); }

/* Icon badge */
.home-card-icon {
  width:40px; height:40px; border-radius:12px;
  display:flex; align-items:center; justify-content:center;
  flex-shrink:0;
}
.home-card--calendar .home-card-icon { background:rgba(61,127,212,0.2); color:#6ab0ff; box-shadow:0 0 12px rgba(61,127,212,0.2); }
.home-card--audio    .home-card-icon { background:rgba(230,140,50,0.2); color:#f0a848; box-shadow:0 0 12px rgba(230,140,50,0.2); }
.home-card--notes    .home-card-icon { background:rgba(167,139,250,0.2); color:#c4b0ff; box-shadow:0 0 12px rgba(167,139,250,0.2); }
.home-card--sevakart .home-card-icon { background:rgba(6,182,212,0.2); color:#5ce0f0; box-shadow:0 0 12px rgba(6,182,212,0.2); }
.home-card--dhamas   .home-card-icon { background:rgba(192,57,43,0.2); color:#f06858; box-shadow:0 0 12px rgba(192,57,43,0.2); }
.home-card--events   .home-card-icon { background:rgba(39,174,96,0.2); color:#5ee8a0; box-shadow:0 0 12px rgba(39,174,96,0.2); }

.home-card-title { font-size:0.9rem; font-weight:600; color:var(--text); letter-spacing:0.2px; }
.home-card--calendar .home-card-title { color:#8ac4ff; }
.home-card--audio    .home-card-title { color:#f0a848; }
.home-card--notes    .home-card-title { color:#cec0ff; }
.home-card--sevakart .home-card-title { color:#5ce0f0; }
.home-card--dhamas   .home-card-title { color:#f08070; }
.home-card--events   .home-card-title { color:#70eaaa; }
.home-card-desc  { font-size:0.67rem; color:var(--text2); line-height:1.45; flex:1; }

/* â”€â”€ Prayer Circle â”€â”€ */
.home-card--prayer {
  background:linear-gradient(145deg, rgba(232,168,56,0.18) 0%, rgba(55,38,12,0.95) 60%, var(--card) 100%);
  border:1px solid rgba(232,168,56,0.3);
  box-shadow:0 4px 20px rgba(232,168,56,0.1), inset 0 1px 0 rgba(232,168,56,0.15);
}
.home-card--prayer::after { background:rgba(232,168,56,0.25); }
.home-card--prayer .home-card-icon { background:rgba(232,168,56,0.2); color:#f0c850; box-shadow:0 0 12px rgba(232,168,56,0.2); }
.home-card--prayer .home-card-title { color:#f0c850; }

/* ===== CENTRALIZED ADMIN DASHBOARD ===== */
.adm-wrap { padding:18px 16px 80px; }
.adm-header {
  text-align:center; margin-bottom:20px; padding:20px 16px;
  background:linear-gradient(135deg,rgba(167,139,250,0.08),rgba(232,168,56,0.06));
  border:1px solid rgba(167,139,250,0.15); border-radius:18px;
}
.adm-header-icon { font-size:2rem; margin-bottom:6px; }
.adm-header-title { font-size:1.15rem; font-weight:700; color:var(--lavender); letter-spacing:0.3px; }
.adm-header-sub { font-size:0.72rem; color:var(--text3); margin-top:4px; }

.adm-summary {
  display:grid; grid-template-columns:repeat(3,1fr); gap:8px; margin-bottom:20px;
}
.adm-summary-card {
  background:var(--bg2); border:1px solid var(--border); border-radius:14px;
  padding:14px 10px; text-align:center;
}
.adm-summary-num { font-size:1.4rem; font-weight:700; color:var(--text); }
.adm-summary-num.pending { color:#f39c12; }
.adm-summary-num.ok { color:#2ecc71; }
.adm-summary-lbl { font-size:0.6rem; color:var(--text3); text-transform:uppercase; letter-spacing:0.5px; margin-top:3px; }

.adm-section {
  background:var(--bg2); border:1px solid var(--border); border-radius:16px;
  margin-bottom:14px; overflow:hidden; transition:all 0.25s;
}
.adm-section-header {
  display:flex; align-items:center; gap:12px; padding:16px;
  cursor:pointer; user-select:none;
}
.adm-section-icon {
  width:40px; height:40px; border-radius:12px; display:flex; align-items:center;
  justify-content:center; font-size:1.15rem; flex-shrink:0;
}
.adm-section-icon.sevakart { background:rgba(167,139,250,0.12); }
.adm-section-icon.prayer { background:rgba(232,168,56,0.12); }
.adm-section-icon.users { background:rgba(52,152,219,0.12); }

/* User List Screen */
.ul-wrap { padding:18px 16px 80px; }
.ul-header {
  display:flex; align-items:center; gap:12px; margin-bottom:18px;
}
.ul-back { background:none; border:none; color:var(--text); font-size:1.3rem; cursor:pointer; padding:4px; }
.ul-title { font-size:1.05rem; font-weight:700; color:var(--text); }

.ul-summary {
  display:grid; grid-template-columns:repeat(3,1fr); gap:8px; margin-bottom:16px;
}
.ul-summary-card {
  background:var(--bg2); border:1px solid var(--border); border-radius:14px;
  padding:12px 8px; text-align:center;
}
.ul-summary-num { font-size:1.3rem; font-weight:700; }
.ul-summary-num.total { color:var(--lavender); }
.ul-summary-num.active { color:#2ecc71; }
.ul-summary-num.inactive { color:#f39c12; }
.ul-summary-lbl { font-size:0.58rem; color:var(--text3); text-transform:uppercase; letter-spacing:0.4px; margin-top:2px; }

.ul-filters {
  display:flex; gap:8px; margin-bottom:16px; flex-wrap:wrap; justify-content:center;
}
.ul-filter-chip {
  padding:7px 16px; border-radius:20px; border:1px solid var(--border);
  background:var(--bg3); color:var(--text3); font-size:0.72rem; font-weight:500;
  cursor:pointer; transition:all 0.2s;
}
.ul-filter-chip.active { border-color:rgba(167,139,250,0.4); background:rgba(167,139,250,0.1); color:var(--lavender); }

.ul-search {
  width:100%; padding:10px 14px; border-radius:12px; border:1px solid var(--border);
  background:var(--bg3); color:var(--text); font-size:0.8rem; margin-bottom:14px;
  box-sizing:border-box;
}
.ul-search::placeholder { color:var(--text3); }

.ul-list { display:flex; flex-direction:column; gap:8px; }
.ul-user {
  display:flex; align-items:center; gap:12px; padding:12px 14px;
  background:var(--bg2); border:1px solid var(--border); border-radius:14px;
  transition:all 0.2s;
}
.ul-avatar {
  width:38px; height:38px; border-radius:50%; display:flex; align-items:center;
  justify-content:center; font-size:0.85rem; font-weight:700; flex-shrink:0;
  color:#fff;
}
.ul-avatar.active-user { background:linear-gradient(135deg,#2ecc71,#27ae60); }
.ul-avatar.inactive-user { background:linear-gradient(135deg,#f39c12,#e67e22); }
.ul-user-info { flex:1; min-width:0; }
.ul-user-name { font-size:0.82rem; font-weight:600; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.ul-user-email { font-size:0.65rem; color:var(--text3); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-top:1px; }
.ul-user-meta { display:flex; gap:8px; margin-top:3px; }
.ul-user-meta-item { font-size:0.6rem; color:var(--text3); }
.ul-user-right { text-align:right; flex-shrink:0; }
.ul-user-status {
  font-size:0.6rem; font-weight:600; padding:3px 8px; border-radius:8px;
  text-transform:uppercase; letter-spacing:0.3px;
}
.ul-user-status.active { background:rgba(46,204,113,0.1); color:#2ecc71; }
.ul-user-status.inactive { background:rgba(243,156,18,0.1); color:#f39c12; }
.ul-user-lastseen { font-size:0.58rem; color:var(--text3); margin-top:4px; }
.ul-empty { text-align:center; padding:40px 20px; font-size:0.82rem; color:var(--text3); }
.adm-section-info { flex:1; }
.adm-section-name { font-size:0.88rem; font-weight:600; color:var(--text); }
.adm-section-status { font-size:0.68rem; color:var(--text3); margin-top:2px; }
.adm-section-badge {
  background:#f39c12; color:#000; font-size:0.65rem; font-weight:700;
  padding:3px 8px; border-radius:10px; min-width:22px; text-align:center;
}
.adm-section-badge.zero { background:rgba(46,204,113,0.15); color:#2ecc71; }
.adm-section-arrow {
  font-size:0.75rem; color:var(--text3); transition:transform 0.25s;
}
.adm-section.expanded .adm-section-arrow { transform:rotate(180deg); }

.adm-section-body {
  max-height:0; overflow:hidden; transition:max-height 0.3s ease;
}
.adm-section.expanded .adm-section-body { max-height:800px; }

.adm-section-content { padding:0 16px 16px; }
.adm-stats {
  display:grid; grid-template-columns:repeat(4,1fr); gap:6px; margin-bottom:12px;
}
.adm-stat {
  background:var(--bg3); border-radius:10px; padding:10px 6px; text-align:center;
}
.adm-stat-num { font-size:1.1rem; font-weight:700; color:var(--text); }
.adm-stat-lbl { font-size:0.55rem; color:var(--text3); text-transform:uppercase; letter-spacing:0.4px; margin-top:2px; }

.adm-actions { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.adm-action-btn {
  display:flex; align-items:center; justify-content:center; gap:6px;
  padding:11px 12px; border-radius:12px; border:1px solid var(--border);
  background:var(--bg3); color:var(--text2); font-size:0.75rem; font-weight:500;
  cursor:pointer; transition:all 0.2s;
}
.adm-action-btn:active { transform:scale(0.96); opacity:0.8; }
.adm-action-btn.primary { border-color:rgba(167,139,250,0.3); background:rgba(167,139,250,0.08); color:var(--lavender); }

.adm-pending-list { margin-top:12px; display:flex; flex-direction:column; gap:8px; }
.adm-pending-item {
  display:flex; align-items:center; gap:10px; padding:10px 12px;
  background:var(--bg3); border:1px solid var(--border); border-radius:12px;
  cursor:pointer; transition:all 0.2s;
}
.adm-pending-item:active { transform:scale(0.98); }
.adm-pending-item-info { flex:1; overflow:hidden; }
.adm-pending-item-name { font-size:0.78rem; font-weight:600; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.adm-pending-item-meta { font-size:0.62rem; color:var(--text3); margin-top:2px; }
.adm-pending-item-actions { display:flex; gap:6px; }
.adm-pending-approve, .adm-pending-reject {
  padding:6px 10px; border-radius:8px; font-size:0.65rem; font-weight:600;
  cursor:pointer; border:none; transition:all 0.2s;
}
.adm-pending-approve { background:rgba(46,204,113,0.12); color:#2ecc71; }
.adm-pending-reject { background:rgba(231,76,60,0.1); color:#e74c3c; }
.adm-pending-approve:active, .adm-pending-reject:active { opacity:0.7; }

.adm-empty { text-align:center; padding:20px; font-size:0.78rem; color:var(--text3); }

/* Admin icon on home */
.home-admin-btn {
  display:none; /* Hidden by default, shown via JS for admins */
  color:var(--lavender) !important;
}

/* ===== PRAYER CIRCLE ===== */
.pc-screen { padding:14px 18px 100px; overflow-y:auto; height:100%; }
.pc-header { text-align:center; padding:8px 0 16px; }
.pc-title { font-family:'Philosopher',serif; font-size:1.3rem; font-weight:700;
  background:linear-gradient(135deg,#e8c800,#f0d860,#d4a84c);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
.pc-subtitle { font-size:0.72rem; color:var(--text3); margin-top:2px; letter-spacing:0.3px; }
.pc-actions { display:flex; gap:10px; margin-bottom:16px; }
.pc-action-btn {
  flex:1; padding:10px; border-radius:12px; border:1px solid rgba(232,168,56,0.3);
  background:linear-gradient(135deg,rgba(232,168,56,0.12),rgba(232,168,56,0.06));
  color:#f0c850; font-size:0.78rem; font-weight:600; cursor:pointer;
  transition:all 0.2s; text-align:center;
}
.pc-action-btn:active { transform:scale(0.96); }
.pc-action-btn.secondary { border-color:var(--border); background:var(--card); color:var(--text2); }
.pc-search-bar { display:flex; gap:8px; margin-bottom:14px; }
.pc-search-inp {
  flex:1; padding:9px 14px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:0.82rem; outline:none;
}
.pc-search-inp:focus { border-color:rgba(232,168,56,0.4); }
.pc-filter-btn {
  padding:8px 14px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text2); font-size:0.78rem; cursor:pointer;
}
.pc-stats-bar {
  display:flex; gap:8px; margin-bottom:16px; flex-wrap:wrap;
  justify-content:center;
}
.pc-stat-chip {
  flex:0 0 auto; padding:6px 12px; border-radius:20px; font-size:0.68rem;
  font-weight:500; white-space:nowrap; cursor:pointer; transition:all 0.2s;
  border:1px solid var(--border); background:var(--card); color:var(--text2);
}
.pc-stat-chip.active { border-color:rgba(232,168,56,0.4); background:rgba(232,168,56,0.12); color:#f0c850; }

/* Prayer cards */
.pc-feed { display:flex; flex-direction:column; gap:12px; }
.pc-card {
  background:var(--card); border-radius:16px; padding:16px;
  border:1px solid var(--border); position:relative; overflow:hidden;
  transition:transform 0.15s;
}
.pc-card:active { transform:scale(0.98); }
.pc-card.urgent { border-color:rgba(192,57,43,0.4); }
.pc-card.urgent::before {
  content:''; position:absolute; top:0; left:0; right:0; height:3px;
  background:linear-gradient(90deg,#c0392b,#e74c3c,#c0392b);
}
.pc-card.answered { border-color:rgba(39,174,96,0.3); opacity:0.85; }
.pc-card.answered::before {
  content:''; position:absolute; top:0; left:0; right:0; height:3px;
  background:linear-gradient(90deg,#27ae60,#2ecc71,#27ae60);
}
.pc-card-top { display:flex; align-items:center; gap:8px; margin-bottom:8px; }
.pc-card-avatar {
  width:32px; height:32px; border-radius:50%; background:rgba(232,168,56,0.15);
  display:flex; align-items:center; justify-content:center; font-size:0.9rem;
  flex-shrink:0; color:#f0c850;
}
.pc-card-meta { flex:1; min-width:0; }
.pc-card-author { font-size:0.75rem; font-weight:600; color:var(--text); }
.pc-card-time { font-size:0.62rem; color:var(--text3); }
.pc-card-badges { display:flex; gap:5px; flex-wrap:wrap; margin-bottom:8px; }
.pc-badge {
  font-size:0.58rem; padding:3px 8px; border-radius:8px; font-weight:600;
  letter-spacing:0.3px; text-transform:uppercase;
}
.pc-badge.cat-health { background:rgba(46,204,113,0.12); color:#2ecc71; }
.pc-badge.cat-family { background:rgba(142,68,173,0.12); color:#bb8fce; }
.pc-badge.cat-career { background:rgba(52,152,219,0.12); color:#5dade2; }
.pc-badge.cat-spiritual { background:rgba(232,168,56,0.12); color:#f0c850; }
.pc-badge.cat-crisis { background:rgba(192,57,43,0.12); color:#e74c3c; }
.pc-badge.cat-other { background:rgba(127,140,141,0.12); color:#95a5a6; }
.pc-badge.urgent-tag { background:rgba(192,57,43,0.18); color:#e74c3c; }
.pc-badge.answered-tag { background:rgba(39,174,96,0.18); color:#2ecc71; }
.pc-badge.needs-tag { background:rgba(230,126,34,0.18); color:#e67e22; }
.pc-card-title { font-size:0.88rem; font-weight:600; color:var(--text); margin-bottom:4px; line-height:1.35; }
.pc-card-desc { font-size:0.75rem; color:var(--text2); line-height:1.5; margin-bottom:10px;
  display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
.pc-card-footer { display:flex; align-items:center; gap:8px; }
.pc-pray-btn {
  display:flex; align-items:center; gap:5px; padding:7px 14px; border-radius:10px;
  border:1px solid rgba(232,168,56,0.3); background:rgba(232,168,56,0.08);
  color:#f0c850; font-size:0.72rem; font-weight:600; cursor:pointer;
  transition:all 0.2s;
}
.pc-pray-btn:active { transform:scale(0.93); }
.pc-pray-btn.prayed { border-color:rgba(39,174,96,0.4); background:rgba(39,174,96,0.12); color:#2ecc71; }
.pc-write-btn {
  padding:7px 12px; border-radius:10px; border:1px solid var(--border);
  background:var(--bg3); color:var(--text2); font-size:0.72rem; cursor:pointer;
  transition:all 0.2s;
}
.pc-write-btn:active { transform:scale(0.93); }
.pc-pray-count { font-size:0.65rem; color:var(--text3); margin-left:auto; }
.pc-empty { text-align:center; padding:40px 20px; color:var(--text3); }
.pc-empty-icon { font-size:2.5rem; margin-bottom:12px; opacity:0.6; }
.pc-empty-text { font-size:0.82rem; line-height:1.5; }

/* Prayer detail */
.pc-detail { padding:0 0 100px; overflow-y:auto; height:100%; }
.pc-detail-header {
  display:flex; align-items:center; gap:12px; padding:14px 18px;
  background:var(--bg2); border-bottom:1px solid var(--border); position:sticky; top:0; z-index:5;
}
.pc-detail-back { background:none; border:none; color:var(--text2); font-size:1.2rem; cursor:pointer; padding:4px; }
.pc-detail-htitle { font-size:0.9rem; font-weight:600; color:var(--text); flex:1; }
.pc-detail-body { padding:18px; }
.pc-detail-card {
  background:var(--card); border-radius:16px; padding:18px; border:1px solid var(--border);
  margin-bottom:16px;
}
.pc-detail-title { font-size:1.05rem; font-weight:600; color:var(--text); margin-bottom:6px; line-height:1.4; }
.pc-detail-desc { font-size:0.82rem; color:var(--text2); line-height:1.65; margin-bottom:14px; white-space:pre-wrap; }
.pc-detail-info { display:flex; flex-wrap:wrap; gap:8px; margin-bottom:14px; }
.pc-detail-actions { display:flex; gap:10px; flex-wrap:wrap; }
.pc-detail-pray-btn {
  flex:1; display:flex; align-items:center; justify-content:center; gap:6px;
  padding:12px; border-radius:12px; border:1px solid rgba(232,168,56,0.3);
  background:linear-gradient(135deg,rgba(232,168,56,0.12),rgba(232,168,56,0.06));
  color:#f0c850; font-size:0.82rem; font-weight:600; cursor:pointer; transition:all 0.2s;
}
.pc-detail-pray-btn:active { transform:scale(0.96); }
.pc-detail-pray-btn.prayed { border-color:rgba(39,174,96,0.4); background:rgba(39,174,96,0.12); color:#2ecc71; }

/* Written prayers section */
.pc-prayers-section { margin-top:16px; }
.pc-prayers-title { font-size:0.82rem; font-weight:600; color:var(--text); margin-bottom:10px; }
.pc-prayer-item {
  background:rgba(232,168,56,0.04); border:1px solid rgba(232,168,56,0.1);
  border-radius:12px; padding:12px; margin-bottom:8px;
}
.pc-prayer-author { font-size:0.68rem; font-weight:600; color:#f0c850; margin-bottom:4px; }
.pc-prayer-text { font-size:0.78rem; color:var(--text2); line-height:1.5; font-style:italic; }
.pc-prayer-time { font-size:0.6rem; color:var(--text3); margin-top:4px; }

/* Updates / gratitude section */
.pc-updates-section { margin-top:16px; }
.pc-update-item {
  background:rgba(39,174,96,0.06); border:1px solid rgba(39,174,96,0.15);
  border-radius:12px; padding:12px; margin-bottom:8px;
}
.pc-update-type { font-size:0.65rem; font-weight:600; color:#2ecc71; text-transform:uppercase; letter-spacing:0.5px; margin-bottom:4px; }
.pc-update-text { font-size:0.78rem; color:var(--text2); line-height:1.5; }
.pc-update-time { font-size:0.6rem; color:var(--text3); margin-top:4px; }

/* Owner actions */
.pc-owner-actions {
  margin-top:16px; padding:14px; background:rgba(232,168,56,0.04);
  border:1px solid rgba(232,168,56,0.12); border-radius:14px;
}
.pc-owner-title { font-size:0.75rem; font-weight:600; color:#f0c850; margin-bottom:10px; }
.pc-owner-btns { display:flex; gap:8px; flex-wrap:wrap; }
.pc-owner-btn {
  padding:8px 14px; border-radius:10px; border:1px solid var(--border);
  background:var(--bg3); color:var(--text2); font-size:0.72rem; cursor:pointer;
  transition:all 0.2s;
}
.pc-owner-btn:active { transform:scale(0.95); }
.pc-owner-btn.answered { border-color:rgba(39,174,96,0.3); color:#2ecc71; }

/* Admin dashboard */
.pc-admin-section {
  background:rgba(167,139,250,0.04); border:1px solid rgba(167,139,250,0.15);
  border-radius:14px; padding:14px; margin-bottom:16px;
}
.pc-admin-title { font-size:0.78rem; font-weight:600; color:#c4b0ff; margin-bottom:10px; }
.pc-admin-stats { display:grid; grid-template-columns:repeat(4,1fr); gap:8px; margin-bottom:10px; }
.pc-admin-stat { text-align:center; padding:8px 4px; background:var(--card); border-radius:10px; border:1px solid var(--border); }
.pc-admin-stat-num { font-size:1rem; font-weight:700; color:var(--text); }
.pc-admin-stat-lbl { font-size:0.55rem; color:var(--text3); text-transform:uppercase; letter-spacing:0.3px; margin-top:2px; }
.pc-admin-btns { display:flex; gap:8px; }
.pc-admin-btn {
  flex:1; padding:8px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text2); font-size:0.7rem; cursor:pointer;
  text-align:center; transition:all 0.2s;
}
.pc-admin-btn:active { transform:scale(0.95); }

/* Report button */
.pc-report-btn {
  margin-top:14px; padding:8px 14px; border-radius:10px; border:1px solid rgba(192,57,43,0.2);
  background:transparent; color:var(--text3); font-size:0.68rem; cursor:pointer;
  transition:all 0.2s; width:100%; text-align:center;
}
.pc-report-btn:active { color:#e74c3c; }
.home-quote {
  margin:16px 22px 24px; padding:16px 18px;
  position:relative; text-align:center;
  opacity:0; animation:homeIn 0.5s ease 0.5s forwards;
  background:linear-gradient(135deg, rgba(167,139,250,0.06), rgba(212,160,23,0.04));
  border-radius:14px;
  border:1px solid rgba(167,139,250,0.1);
}
.home-quote-text {
  font-family:'Playfair Display', serif;
  font-size:0.97rem; line-height:1.7; letter-spacing:0.2px;
  background:linear-gradient(135deg, #e8c800 0%, #f0d860 40%, #d4a84c 70%, #e8c800 100%);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  background-clip:text;
}
.home-quote-text::before {
  content:'\201C'; display:block;
  font-family:'Playfair Display', serif; font-size:1.8rem;
  background:linear-gradient(135deg, var(--lavender), rgba(167,139,250,0.4));
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  background-clip:text;
  line-height:1; margin-bottom:2px;
}
.home-quote-text::after { content:none; }
</style>
  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-messaging-compat.js"></script>
  <!-- Google API client -->
  <script src="https://apis.google.com/js/api.js" async defer></script>
</head>
<body>
<!-- Gayatri / Rahu in-app alert banner -->
<div id="alertBanner" style="display:none;position:fixed;top:0;left:0;right:0;z-index:9999;
  padding:12px 18px 10px;background:linear-gradient(135deg,#1a3a1a,#0d2010);
  border-bottom:2px solid #2db84d;box-shadow:0 4px 20px rgba(0,0,0,0.6);
  animation:slideDown 0.35s ease;">
  <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;">
    <div id="alertBannerIcon" style="width:42px;height:42px;border-radius:50%;flex-shrink:0;overflow:hidden;display:none;box-shadow:0 2px 10px rgba(0,0,0,0.4);"></div>
    <div style="flex:1;min-width:0;">
      <div id="alertBannerTitle" style="font-size:0.88rem;font-weight:700;color:#4ddb6e;margin-bottom:2px;"></div>
      <div id="alertBannerBody"  style="font-size:0.78rem;color:rgba(255,255,255,0.8);"></div>
    </div>
    <button onclick="dismissAlertBanner()" style="background:rgba(255,255,255,0.12);border:none;border-radius:6px;
      color:rgba(255,255,255,0.7);padding:5px 10px;font-size:0.75rem;cursor:pointer;flex-shrink:0;">âœ• Dismiss</button>
  </div>
</div>
<style>
@keyframes slideDown { from{transform:translateY(-100%);opacity:0} to{transform:translateY(0);opacity:1} }
</style>

<!-- App Brand Bar -->
<div class="app-brand">
  <!-- Conch (Shankha) on left -->
  <img class="app-brand-logo" src="data:image/png;base64,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" alt="Conch" style="width:28px;height:28px;object-fit:contain;filter:drop-shadow(0 0 8px rgba(167,139,250,0.4));">

  <span class="app-brand-name">Bhakti Sakha</span>

  <!-- Pink Lotus on right -->
  <img class="app-brand-logo" src="data:image/png;base64,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" alt="Lotus">
</div>

<!-- Header -->
<!-- Update notification banner -->
<div class="update-banner" id="updateBanner">
  <div class="update-banner-inner">
    <div class="update-banner-icon">âœ¨</div>
    <div class="update-banner-text">
      <div class="update-banner-title">Bhakti Sakha Updated!</div>
      <div class="update-banner-desc">Enjoy the latest improvements and features.</div>
    </div>
    <button class="update-banner-dismiss" onclick="dismissUpdateBanner()">OK</button>
  </div>
</div>

<header class="header">
  <div class="header-date-wrap">
    <div class="header-date" id="headerDate">18 February 2026</div>
    <div class="header-masa" id="headerMasa"></div>
  </div>
  <div class="header-icons" id="headerIcons">
    <button onclick="openDatePicker()" title="Jump to Date">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
    </button>
    <button onclick="switchScreen('search', null)" title="Search">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
    </button>
    <button onclick="switchScreen('settings', null)" title="Settings">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
    </button>
    <button onclick="switchScreen('info',null)" title="About">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
    </button>
  </div>

</header>

<!-- Screens -->
<div class="screens">

  <!-- HOME -->
  <div class="screen active" id="screen-home">
    <div class="home-wrap">
      <!-- â”€â”€ Google Account Bar â”€â”€ -->
      <div class="home-gbar">
        <!-- Signed-in state -->
        <div id="homeGSignedIn" style="display:none;width:100%;">
          <div style="display:flex;align-items:center;gap:12px;width:100%;">
            <img id="homeGAvatar" class="home-g-avatar" src="" alt="">
            <div class="home-g-info">
              <div id="homeGName" class="home-g-name"></div>
              <div id="homeGEmail" class="home-g-email"></div>
            </div>
            <div class="home-g-actions">
              <button class="home-g-action-btn" onclick="gSyncAll()" title="Sync Now">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M1 4v6h6"/><path d="M23 20v-6h-6"/><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10"/><path d="M3.51 15A9 9 0 0 0 18.36 18.36L23 14"/></svg>
              </button>
              <button class="home-g-action-btn home-admin-btn" id="homeAdminBtn" onclick="switchScreen('admin',null)" title="Admin Dashboard">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
              </button>
              <button class="home-g-action-btn" onclick="switchScreen('settings',null)" title="Settings">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
              </button>
            </div>
          </div>
        </div>
        <!-- Signed-out state with Google logo -->
        <div id="homeGSignedOut" style="width:100%;">
          <div style="display:flex;align-items:center;gap:12px;width:100%;">
            <div class="home-g-btn-wrap" onclick="switchScreen('settings',null)">
              <svg class="home-g-logo" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"/>
                <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18A11.96 11.96 0 0 0 1 12c0 1.94.46 3.77 1.18 5.07l3.66-2.98z" fill="#FBBC05"/>
                <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
              </svg>
            </div>
            <div class="home-g-info">
              <div class="home-g-name" style="color:var(--text2);">Welcome, Devotee</div>
              <div class="home-g-signin-cta" onclick="switchScreen('settings',null)">Sign in with Google â†’</div>
            </div>
            <div class="home-g-actions">
              <button class="home-g-action-btn" onclick="switchScreen('settings',null)" title="Settings">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- â”€â”€ Greeting â”€â”€ -->
      <div class="home-greeting">
        <div class="home-greet-text" id="homeGreeting">Hare Krishna!</div>
        <div class="home-greet-sub">
          <span class="hg-date" id="homeDate"></span><br>
          <span class="hg-vaishnava" id="homeVDate"></span>
        </div>
      </div>

      <!-- â”€â”€ Today's highlight â”€â”€ -->
      <div class="home-today" id="homeTodayCard" onclick="switchScreen('calendar',document.querySelectorAll('.nav-btn')[1])" style="display:none;">
        <div class="home-today-label">âœ¦ Today</div>
        <div class="home-today-text" id="homeTodayText"></div>
      </div>

      <!-- â”€â”€ Feature Grid â”€â”€ -->
      <div class="home-grid">
        <div class="home-card home-card--calendar" onclick="switchScreen('calendar',document.querySelectorAll('.nav-btn')[1])">
          <div class="home-card-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" width="22" height="22"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
          </div>
          <div class="home-card-title">Calendar</div>
          <div class="home-card-desc">Vaishnava calendar with Ekadashis, festivals & tithis</div>
        </div>

        <div class="home-card home-card--audio" onclick="switchScreen('songs',document.querySelectorAll('.nav-btn')[2])">
          <div class="home-card-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>
          </div>
          <div class="home-card-title">Audio</div>
          <div class="home-card-desc">Transcendental vibrations â€” Vaishnava bhajans, and more</div>
        </div>

        <div class="home-card home-card--notes" onclick="switchScreen('notes',document.querySelectorAll('.nav-btn')[4])">
          <div class="home-card-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" width="20" height="20"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
          </div>
          <div class="home-card-title">Notes</div>
          <div class="home-card-desc">Spiritual journal â€” notes synced via Google Drive</div>
        </div>

        <div class="home-card home-card--sevakart" onclick="switchScreen('sevakart',document.querySelectorAll('.nav-btn')[6])">
          <div class="home-card-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" width="20" height="20"><path d="M12 2C8 2 4 6 4 10c0 5.33 8 12 8 12s8-6.67 8-12c0-4-4-8-8-8z"/><circle cx="12" cy="10" r="3"/></svg>
          </div>
          <div class="home-card-title">SevaKart</div>
          <div class="home-card-desc">Community services â€” find & offer seva opportunities</div>
        </div>

        <div class="home-card home-card--dhamas" onclick="switchScreen('dhamas',document.querySelectorAll('.nav-btn')[5])">
          <div class="home-card-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" width="20" height="20"><path d="M3 21h18"/><path d="M5 21V7l7-4 7 4v14"/><path d="M9 21v-6h6v6"/></svg>
          </div>
          <div class="home-card-title">Holy Dhamas</div>
          <div class="home-card-desc">Sacred places of pilgrimage â€” temples & holy sites</div>
        </div>

        <div class="home-card home-card--events" onclick="switchScreen('events',document.querySelectorAll('.nav-btn')[3])">
          <div class="home-card-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" width="20" height="20"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          </div>
          <div class="home-card-title">My Events</div>
          <div class="home-card-desc">Personal reminders, custom events and alerts</div>
        </div>

        <div class="home-card home-card--prayer" onclick="switchScreen('prayer',document.querySelectorAll('.nav-btn')[7])">
          <div class="home-card-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" width="20" height="20"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2z"/><path d="M12 6v6l4 2"/></svg>
          </div>
          <div class="home-card-title">Prayer Circle</div>
          <div class="home-card-desc">Support fellow devotees â€” request & offer prayers</div>
        </div>

      </div>

      <!-- Quote -->
      <div class="home-quote">
        <div class="home-quote-text" id="homeQuote">We should not only be thankful for what we have been given, but also for the opportunity for giving.</div>
      </div>
    </div>
  </div>

  <!-- CALENDAR -->
  <div class="screen" id="screen-calendar">
    <div class="cal-wrapper">
      <div class="month-nav">
        <button class="month-nav-btn" onclick="changeMonth(-1)">â€¹</button>
        <div class="month-display">
          <span class="month-name" id="calMonthYear">February 2026</span>
          <span class="month-vaishnava" id="calVMonthYear">Maghaâ€“Phalguna, Gaurabda 539</span>
        </div>
        <button class="month-nav-btn" onclick="changeMonth(1)">â€º</button>
      </div>
      <div class="cal-loc-bar" id="calLocBar" onclick="switchScreen('settings',null)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="13" height="13"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
        <span id="calLocName">Mumbai, India</span>
        <span class="cal-loc-change">Change</span>
      </div>
      <div class="day-headers">
        <div class="day-hdr">SU</div><div class="day-hdr">MO</div>
        <div class="day-hdr">TU</div><div class="day-hdr">WE</div>
        <div class="day-hdr">TH</div><div class="day-hdr">FR</div>
        <div class="day-hdr">SA</div>
      </div>
      <div class="days-grid-wrap">
        <div class="days-grid" id="calGrid"></div>
      </div>
      <div class="day-detail" id="dayDetail">
        <div class="empty-day">Select a date to see details</div>
      </div>
    </div>
  </div>

  <!-- SEARCH -->
  <div class="screen" id="screen-search">
    <div class="search-screen">
      <div class="screen-title">Search Calendar</div>
      <div class="search-box">
        <span class="search-box-icon">ðŸ”</span>
        <input class="search-input" id="searchQ" type="search" placeholder="Ekadashi, festival, tithi..." oninput="doSearch()">
      </div>
      <div class="filter-row">
        <button class="fc active" onclick="setFilter(this,'all')">All</button>
        <button class="fc" onclick="setFilter(this,'ekadashi')">Ekadashi</button>
        <button class="fc" onclick="setFilter(this,'festival')">Festivals</button>
        <button class="fc" onclick="setFilter(this,'appearance')">Appearance</button>
        <button class="fc" onclick="setFilter(this,'custom')">My Events</button>
      </div>
      <div id="searchResults"></div>
      <div class="jump-section">
        <div class="jump-title">ðŸ“… Jump to Date</div>
        <div class="jump-row">
          <select class="f-select" id="jumpDay"><option value="">Day</option></select>
          <select class="f-select" id="jumpMonth"><option value="">Month</option>
            <option value="0">January</option><option value="1">February</option>
            <option value="2">March</option><option value="3">April</option>
            <option value="4">May</option><option value="5">June</option>
            <option value="6">July</option><option value="7">August</option>
            <option value="8">September</option><option value="9">October</option>
            <option value="10">November</option><option value="11">December</option>
          </select>
        </div>
        <select class="f-select" id="jumpYear" style="margin-bottom:10px;"><option value="">Year (1975â€“2075)</option></select>
        <button class="jump-btn" onclick="doJump()">Go to Date â†’</button>
      </div>
    </div>
  </div>

  <!-- SONGS / KIRTANS -->
  <div class="screen" id="screen-songs">
    <!-- Fixed top bar -->
    <div class="kirtan-topbar">
      <div class="kirtan-search-wrap">
        <input class="kirtan-search-inp" id="kirtanSearchInp" placeholder="Search songs, author, lyricsâ€¦" autocomplete="off"
          oninput="kirtanSearch(this.value)" onfocus="kirtanSearch(this.value)" onblur="setTimeout(()=>kirtanHideDropdown(),200)">
        <button class="kirtan-clear-btn" id="kirtanClearBtn" onclick="kirtanClear()" style="display:none;">âœ•</button>
      </div>
      <!-- Live dropdown -->
      <div class="kirtan-dropdown" id="kirtanDropdown"></div>
      <div class="kirtan-actions">
        <div class="kirtan-sort-wrap">
          <button class="songs-sort-btn active" id="ksort-cat" onclick="setSongSort('cat',this)">Category</button>
          <button class="songs-sort-btn" id="ksort-author" onclick="setSongSort('author',this)">Author</button>
          <select class="song-lang-sel" id="songLangSelList" onchange="setSongLang(this.value)" style="margin-left:6px;">
            <option value="en">English</option>
            <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
            <option value="mr">à¤®à¤°à¤¾à¤ à¥€</option>
          </select>
        </div>
        <button class="kirtan-add-btn" style="margin-left:auto;" onclick="openAdminSong()">ï¼‹</button>
      </div>
    </div>
    <!-- Song list -->
    <div id="songsContent" style="overflow-y:auto; flex:1; padding:0 0 100px;"></div>
  </div>

  <!-- SONG DETAIL -->
  <div class="screen" id="screen-song-detail">
    <div class="song-detail-wrap">
      <div class="song-detail-header">
        <button class="song-back-btn" onclick="closeSongDetail()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" width="20" height="20"><polyline points="15 18 9 12 15 6"/></svg>
          Back
        </button>
        <div class="song-detail-hdr-actions">
          <select class="song-lang-sel" id="songLangSel" onchange="setSongLang(this.value)">
            <option value="en">English</option>
            <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
            <option value="mr">à¤®à¤°à¤¾à¤ à¥€</option>
          </select>
          <button class="songs-font-btn" onclick="changeSongFont(-1)" style="width:28px;height:28px;">Aâˆ’</button>
          <button class="songs-font-btn" onclick="changeSongFont(1)" style="width:28px;height:28px;">A+</button>
          <button class="song-edit-btn" onclick="openEditSongFromDetail()">âœï¸</button>
          <button class="song-del-btn" onclick="deleteSongFromDetail()">ðŸ—‘</button>
        </div>
      </div>
      <div class="song-detail-body" id="songDetailBody"></div>
    </div>
  </div>

  <!-- EVENTS -->
  <div class="screen" id="screen-events">
    <div class="events-screen">
      <div class="events-hdr">
        <div class="screen-title" style="margin:0;border:none;padding:0">My Events</div>
        <button class="add-evt-btn" onclick="openAddEvt()">+ Add Event</button>
      </div>
      <div class="backup-box" id="evtBackupBox">
        <div class="bk-text" id="evtBackupMsg"><strong>Sign in with Google</strong> to sync events across devices.</div>
        <div class="bk-btns">
          <button class="bk-btn" id="evtGoogleBtn" onclick="switchScreen('settings')" style="background:rgba(61,127,212,0.12);border-color:rgba(61,127,212,0.3);color:var(--accent-blue);">ðŸ”‘ Sign In</button>
          <button class="bk-btn" onclick="exportEvts()">ðŸ“¤ Export</button>
          <button class="bk-btn" onclick="importEvts()">ðŸ“¥ Import</button>
        </div>
      </div>
      <div id="evtList"></div>
    </div>
  </div>

  <!-- NOTES -->
  <div class="screen" id="screen-notes">
    <div class="notes-screen">
      <div class="notes-top-bar">
        <div class="notes-search-wrap">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
          <input class="notes-search-inp" id="notesSearchInp" placeholder="Search notesâ€¦" oninput="renderNotes()">
        </div>
        <div class="notes-sort-row">
          <button class="notes-sort-btn active" data-sort="date" onclick="setNoteSort('date',this)">ðŸ“… Date</button>
          <button class="notes-sort-btn" data-sort="title" onclick="setNoteSort('title',this)">ðŸ”¤ Title</button>
          <button class="notes-sort-btn" data-sort="cat" onclick="setNoteSort('cat',this)">ðŸ·ï¸ Category</button>
          <span class="notes-count" id="notesCount"></span>
        </div>
      </div>
      <div class="notes-list-wrap">
        <div class="notes-backup-box" id="notesBackupBox">
          <span id="notesBackupMsg"><strong>Sign in with Google</strong> to sync notes across devices.</span>
          <div class="notes-backup-btns">
            <button class="bk-btn" id="notesGoogleBtn" style="background:rgba(61,127,212,0.1);border-color:rgba(61,127,212,0.3);color:var(--accent-blue);" onclick="switchScreen('settings')">ðŸ”‘ Sign In</button>
            <button class="bk-btn" style="background:rgba(61,127,212,0.1);border-color:rgba(61,127,212,0.3);color:var(--accent-blue);" onclick="exportNotes()">ðŸ“¤ Export</button>
            <button class="bk-btn" style="background:rgba(61,127,212,0.1);border-color:rgba(61,127,212,0.3);color:var(--accent-blue);" onclick="importNotes()">ðŸ“¥ Import</button>
          </div>
        </div>
        <div id="notesList"></div>
      </div>
      <button class="notes-fab" onclick="openAddNote()" title="New Note">+</button>
    </div>
  </div>

  <!-- SETTINGS -->
  <div class="screen" id="screen-settings">
    <div class="settings-screen">
      <div class="settings-screen-title">âš™ï¸ Settings</div>
      <!-- GOOGLE ACCOUNT SECTION -->
      <div class="sett-section" id="googleAccountSection">
        <div class="sett-stitle"><span class="sett-stitle-icon blue">ðŸ”‘</span> Google Account</div>
        <div id="gSignedOut" class="g-signed-out-box">
          <div class="g-desc">Sign in to automatically sync your <strong>Notes</strong>, <strong>Events</strong> and <strong>Kirtans</strong> across all your devices via Google Drive.</div>
          <div id="g_signin_btn" class="g-signin-btn-wrap"></div>
          <div id="gSignInError" class="g-error" style="display:none;"></div>
        </div>
        <div id="gSignedIn" class="g-signed-in-box" style="display:none;">
          <div class="g-user-row">
            <img id="gUserAvatar" class="g-avatar" src="" alt="">
            <div class="g-user-info">
              <div id="gUserName" class="g-user-name"></div>
              <div id="gUserEmail" class="g-user-email"></div>
            </div>
          </div>
          <div class="g-sync-row">
            <div id="gSyncStatus" class="g-sync-status">Not synced yet</div>
            <button class="g-sync-btn" onclick="gSyncAll()">â†» Sync Now</button>
          </div>
          <div class="g-sync-details" id="gSyncDetails"></div>
          <button class="g-signout-btn" onclick="gSignOut()">Sign Out</button>
        </div>
      </div>

      <!-- ADMIN PANEL (only visible to super admin) -->
      <div class="sett-section admin-section" id="adminPanelSection" style="display:none;">
        <div class="sett-stitle"><span class="sett-stitle-icon purple">ðŸ›¡ï¸</span> Admin Panel <span class="admin-badge">Admin</span></div>
        <div style="font-size:0.78rem; color:var(--text3); margin-bottom:10px; line-height:1.5;">
          Admins can edit event descriptions and manage kirtans/bhajans. Only you (super admin) can add or remove other admins.
        </div>
        <div class="admin-email-list" id="adminEmailList"></div>
        <div class="admin-add-row">
          <input class="admin-add-input" id="adminAddInput" placeholder="Enter email to grant adminâ€¦" type="email">
          <button class="admin-add-btn" onclick="addAdmin()">+ Add</button>
        </div>
        <div class="admin-perms-wrap" id="adminPermsWrap">
          <div class="admin-perms-label">Permissions for new admin:</div>
          <div class="admin-perm-row">
            <label><input type="checkbox" id="permSongs" checked> ðŸŽµ Add / Edit Songs & Kirtans</label>
          </div>
          <div class="admin-perm-row">
            <label><input type="checkbox" id="permDhamas" checked> ðŸ›• Add Dhamas</label>
          </div>
          <div class="admin-perm-row">
            <label><input type="checkbox" id="permSevakart" checked> ðŸª” SevaKart Admin</label>
          </div>
          <div class="admin-perm-row">
            <label><input type="checkbox" id="permPrayer" checked> ðŸ™ Prayer Circle Admin</label>
          </div>
          <div class="admin-perm-row">
            <label><input type="checkbox" id="permUsers"> ðŸ‘¥ View User Stats</label>
          </div>
        </div>
      </div>

      <div class="sett-section">
        <div class="sett-stitle"><span class="sett-stitle-icon green">ðŸ“</span> Location</div>
        <div style="font-size:0.78rem;color:var(--text2);margin-bottom:8px;">Currently: <strong id="curLocName" style="color:var(--accent-blue);">Mumbai</strong></div>
        <input class="loc-search" id="locSearchInp" placeholder="ðŸ”  Search city..." oninput="filterLocGrid(this.value,'locGridSettings')" autocomplete="off">
        <div class="loc-grid" id="locGridSettings"></div>
        <div class="custom-loc-box">
          <div class="custom-loc-label">Not in the list? Search any city worldwide:</div>
          <div class="custom-loc-row">
            <input class="f-inp" id="customLocInput" placeholder="e.g. Tirupati, Dallas, Londonâ€¦" autocomplete="off" onkeydown="if(event.key==='Enter')geocodeCity()" style="flex:1;margin:0;">
            <button class="custom-loc-btn" onclick="geocodeCity()" id="geoBtn">Search</button>
          </div>
          <div id="geoStatus" class="geo-status"></div>
          <div id="geoResults" class="geo-results"></div>
        </div>
      </div>
      <div class="sett-section">
        <div class="sett-stitle"><span class="sett-stitle-icon orange">ðŸ””</span> Notifications</div>

        <!-- Push notifications toggle -->
        <div class="sett-row" style="margin-bottom:14px;">
          <div class="sett-info">
            <div class="sett-name">ðŸ“± Push Notifications</div>
            <div class="sett-desc" id="pushNotifStatus">Tap to enable real phone notifications</div>
          </div>
          <button id="pushNotifBtn" class="g-sync-btn" onclick="togglePushNotifications()" style="min-width:80px;">Enable</button>
        </div>

        <div class="notif-divider"></div>

        <!-- How it works info box -->
        <div class="notif-info-box">
          <div class="notif-info-title">â„¹ï¸ How reminders work</div>
          <div class="notif-info-text">With push notifications <strong>enabled</strong>, you'll receive real phone notifications for upcoming events even when the app is closed. Reminders are sent daily based on your settings below.</div>
        </div>

        <!-- Notification time -->
        <div class="sett-row" style="margin-bottom:14px;">
          <div class="sett-info">
            <div class="sett-name">Alert Time</div>
            <div class="sett-desc">Time of day to show reminders</div>
          </div>
          <input type="time" id="n-time" value="07:00" onchange="saveS()" class="notif-time-input">
          <div class="notif-time-display">
            <select id="n-time-hour" onchange="syncTimeFromSelects()" style="width:52px;">
              <option value="01">01</option><option value="02">02</option><option value="03">03</option>
              <option value="04">04</option><option value="05">05</option><option value="06">06</option>
              <option value="07" selected>07</option><option value="08">08</option><option value="09">09</option>
              <option value="10">10</option><option value="11">11</option><option value="12">12</option>
            </select>
            <span class="time-colon">:</span>
            <select id="n-time-min" onchange="syncTimeFromSelects()" style="width:52px;">
              <option value="00" selected>00</option><option value="05">05</option><option value="10">10</option>
              <option value="15">15</option><option value="20">20</option><option value="25">25</option>
              <option value="30">30</option><option value="35">35</option><option value="40">40</option>
              <option value="45">45</option><option value="50">50</option><option value="55">55</option>
            </select>
            <select id="n-time-ampm" onchange="syncTimeFromSelects()" style="width:56px;">
              <option value="AM" selected>AM</option><option value="PM">PM</option>
            </select>
          </div>
        </div>

        <!-- Advance days -->
        <div class="sett-row" style="margin-bottom:14px;">
          <div class="sett-info">
            <div class="sett-name">Advance Notice</div>
            <div class="sett-desc">How many days before to remind</div>
          </div>
          <select class="notif-advance-sel" id="n-advance" onchange="saveS();updateNotifDescs()">
            <option value="1">1 day</option>
            <option value="2">2 days</option>
            <option value="3">3 days</option>
            <option value="7">7 days</option>
          </select>
        </div>

        <div class="notif-divider"></div>

        <!-- Each notification toggle -->
        <div class="sett-row">
          <div class="sett-info">
            <div class="sett-name">Ekadashi Reminders</div>
            <div class="sett-desc" id="desc-ekadashi">Alert 1 day before, at 7:00 am</div>
          </div>
          <label class="toggle"><input type="checkbox" id="n-ekadashi" checked onchange="saveS()"></label>
        </div>
        <div class="sett-row">
          <div class="sett-info">
            <div class="sett-name">Festival Reminders</div>
            <div class="sett-desc" id="desc-festival">Alert 1 day before, at 7:00 am</div>
          </div>
          <label class="toggle"><input type="checkbox" id="n-festival" checked onchange="saveS()"></label>
        </div>
        <div class="sett-row">
          <div class="sett-info">
            <div class="sett-name">Appearance Days</div>
            <div class="sett-desc" id="desc-appearance">Alert 1 day before, at 7:00 am</div>
          </div>
          <label class="toggle"><input type="checkbox" id="n-appearance" checked onchange="saveS()"></label>
        </div>
        <div class="sett-row">
          <div class="sett-info">
            <div class="sett-name">My Custom Events</div>
            <div class="sett-desc" id="desc-custom">Alert 1 day before, at 7:00 am</div>
          </div>
          <label class="toggle"><input type="checkbox" id="n-custom" checked onchange="saveS()"></label>
        </div>
        <div class="sett-row">
          <div class="sett-info">
            <div class="sett-name">Gayatri / Sandhya Times</div>
            <div class="sett-desc" id="desc-gayatri">Remind 10 min before sunrise Â· noon Â· sunset</div>
          </div>
          <label class="toggle"><input type="checkbox" id="n-gayatri" onchange="saveS()"></label>
        </div>
        <div class="sett-row">
          <div class="sett-info">
            <div class="sett-name">Rahu Kalam</div>
            <div class="sett-desc" id="desc-rahu">Alert on the day, at start of Rahu Kalam</div>
          </div>
          <label class="toggle"><input type="checkbox" id="n-rahu" onchange="saveS()"></label>
        </div>
        <div class="notif-divider"></div>
        <div class="sett-row">
          <div class="sett-info">
            <div class="sett-name">ðŸ™ Prayer Circle Alerts</div>
            <div class="sett-desc">Get notified about new prayer requests from devotees</div>
          </div>
          <label class="toggle"><input type="checkbox" id="n-prayer" checked onchange="saveS()"></label>
        </div>
      </div>
    </div>
  </div>

</div>

  <!-- HOLY DHAMAS -->
  <div class="screen" id="screen-dhamas">
    <div class="dhamas-screen">
      <div class="dhamas-hdr">
        <div class="screen-title" style="margin:0;border:none;padding:0">Holy Dhamas</div>
        <button class="dham-add-btn" id="dhamAddBtn" onclick="openAddDham()" style="display:none;">ï¼‹ Add Dham</button>
      </div>
      <input class="dhamas-search" id="dhamSearchInp" placeholder="ðŸ”  Search dhamas..." oninput="renderDhamas(this.value)">
      <div class="dhamas-grid" id="dhamasGrid"></div>
    </div>
  </div>

  <!-- DHAM DETAIL -->
  <div class="screen" id="screen-dham-detail">
    <div class="dham-detail-screen">
      <div class="dham-detail-header">
        <button class="dham-back-btn" onclick="closeDhamDetail()">â†</button>
        <div class="dham-detail-title" id="dhamDetailTitle"></div>
      </div>
      <div class="dham-detail-body" id="dhamDetailBody"></div>
    </div>
  </div>

  <!-- INFO SCREEN -->
  <div class="screen" id="screen-info">
    <div class="info-screen">

      <button class="info-back-btn" onclick="switchScreen('home',document.querySelectorAll('.nav-btn')[0])">â† Back to Home</button>

      <!-- Hero Section -->
      <div class="info-hero">
        <div class="info-hero-icon">ðŸ™</div>
        <div class="info-hero-name">Bhakti Sakha</div>
        <div class="info-hero-version">V2.0</div>
        <div class="info-hero-sub"><strong>Data range:</strong> 1975â€“2075 CE &nbsp;Â·&nbsp; Per <strong>ISKCON standards</strong> &amp; Panchangam</div>
        <div class="info-hero-glory">All glories to Srila Prabhupada!</div>
      </div>

      <!-- NOTIFICATION GUIDE -->
      <div class="info-section">
        <div class="info-section-title">
          <span class="info-icon">ðŸ””</span> How Notifications Work
        </div>
        <div class="info-text">
          Bhakti Sakha sends you timely reminders for Vaishnava events, Ekadashis, festivals, appearance days, and your own custom events â€” so you never miss an important day of devotional service.
        </div>
      </div>

      <!-- STEP 1: Phone Permission -->
      <div class="info-section">
        <div class="info-section-title">
          <span class="info-icon">ðŸ“±</span> Step 1 â€” Enable Phone Permission
        </div>
        <div class="info-text" style="margin-bottom:14px;">
          Before enabling notifications inside the app, you must first allow notification permissions on your phone:
        </div>

        <div class="info-step">
          <div class="info-step-num amber">1</div>
          <div class="info-step-text">Open your phone's <strong>Settings</strong> app</div>
        </div>
        <div class="info-step">
          <div class="info-step-num amber">2</div>
          <div class="info-step-text">Go to <strong>Notifications</strong> â†’ <strong>App Notifications</strong> (or <strong>Apps & Notifications</strong> on some phones)</div>
        </div>
        <div class="info-step">
          <div class="info-step-num amber">3</div>
          <div class="info-step-text">Find your <strong>browser app</strong> (Chrome, Safari, etc.) or <strong>Bhakti Sakha</strong> if installed as a PWA</div>
        </div>
        <div class="info-step">
          <div class="info-step-num amber">4</div>
          <div class="info-step-text">Make sure notifications are <strong>turned ON</strong> for this app. Also check that <strong>"Show on Lock Screen"</strong> and <strong>"Allow Sound"</strong> are enabled.</div>
        </div>

        <div class="info-note-box">
          <div class="info-note-title">âš ï¸ Important</div>
          <div class="info-note-text">If phone-level permissions are not enabled, the app will not be able to send you any notifications â€” even if they are turned on inside Bhakti Sakha.</div>
        </div>
      </div>

      <!-- STEP 2: Enable in App -->
      <div class="info-section">
        <div class="info-section-title">
          <span class="info-icon">âš™ï¸</span> Step 2 â€” Enable Inside the App
        </div>
        <div class="info-step">
          <div class="info-step-num blue">1</div>
          <div class="info-step-text">Open Bhakti Sakha and go to the <strong>Settings</strong> screen (gear icon in header)</div>
        </div>
        <div class="info-step">
          <div class="info-step-num blue">2</div>
          <div class="info-step-text">Scroll to the <strong>Notifications</strong> section</div>
        </div>
        <div class="info-step">
          <div class="info-step-num blue">3</div>
          <div class="info-step-text">Tap the <strong>"Enable"</strong> button next to <strong>Push Notifications</strong></div>
        </div>
        <div class="info-step">
          <div class="info-step-num blue">4</div>
          <div class="info-step-text">When your browser prompts "Allow notifications?", tap <strong>Allow</strong></div>
        </div>
        <div class="info-step" style="margin-bottom:0;">
          <div class="info-step-num blue">5</div>
          <div class="info-step-text">The button will change to <strong>"Enabled âœ“"</strong> â€” you're all set!</div>
        </div>
      </div>

      <!-- CUSTOMIZE -->
      <div class="info-section">
        <div class="info-section-title">
          <span class="info-icon">ðŸŽ›ï¸</span> What You Can Customize
        </div>
        <div class="info-text" style="margin-bottom:12px;">Once enabled, you can tailor your reminders in Settings:</div>

        <div class="info-toggle-row">
          <div class="info-toggle-emoji">â°</div>
          <div>
            <div class="info-toggle-label">Alert Time</div>
            <div class="info-toggle-desc">Choose what time of day you receive reminders (default 7:00 AM)</div>
          </div>
        </div>
        <div class="info-toggle-row">
          <div class="info-toggle-emoji">ðŸ“…</div>
          <div>
            <div class="info-toggle-label">Advance Notice</div>
            <div class="info-toggle-desc">Get reminded 1, 2, 3, or 7 days before the event</div>
          </div>
        </div>

        <div class="info-divider"></div>

        <div class="info-text" style="margin-bottom:10px;"><strong>Toggle reminders ON/OFF individually:</strong></div>

        <div class="info-toggle-row">
          <div class="info-toggle-emoji">ðŸŸ£</div>
          <div><div class="info-toggle-label">Ekadashi Reminders</div></div>
        </div>
        <div class="info-toggle-row">
          <div class="info-toggle-emoji">ðŸŸ </div>
          <div><div class="info-toggle-label">Festival Reminders</div></div>
        </div>
        <div class="info-toggle-row">
          <div class="info-toggle-emoji">ðŸ”µ</div>
          <div><div class="info-toggle-label">Appearance Day Reminders</div></div>
        </div>
        <div class="info-toggle-row">
          <div class="info-toggle-emoji">ðŸŸ¢</div>
          <div><div class="info-toggle-label">Your Custom Events</div></div>
        </div>
        <div class="info-toggle-row">
          <div class="info-toggle-emoji">ðŸŒ…</div>
          <div>
            <div class="info-toggle-label">Gayatri / Sandhya Times</div>
            <div class="info-toggle-desc">Reminders 10 min before sunrise, noon &amp; sunset</div>
          </div>
        </div>
        <div class="info-toggle-row">
          <div class="info-toggle-emoji">âš«</div>
          <div>
            <div class="info-toggle-label">Rahu Kalam Alerts</div>
            <div class="info-toggle-desc">Get notified at the start of Rahu Kalam each day</div>
          </div>
        </div>
      </div>

      <!-- HOW IT WORKS -->
      <div class="info-section">
        <div class="info-section-title">
          <span class="info-icon">ðŸ§©</span> How It Works Behind the Scenes
        </div>
        <div class="info-step">
          <div class="info-step-num purple">â—</div>
          <div class="info-step-text">Bhakti Sakha uses <strong>Firebase Cloud Messaging</strong> to deliver real push notifications to your phone or browser â€” even when the app is closed</div>
        </div>
        <div class="info-step">
          <div class="info-step-num purple">â—</div>
          <div class="info-step-text">Your notification preferences and upcoming events are synced with our server, which sends the reminders at the right time</div>
        </div>
        <div class="info-step" style="margin-bottom:0;">
          <div class="info-step-num purple">â—</div>
          <div class="info-step-text"><strong>No personal data is shared</strong> â€” only your device token and event schedule are stored securely</div>
        </div>
      </div>

      <!-- PLATFORM NOTES -->
      <div class="info-section">
        <div class="info-section-title">
          <span class="info-icon">ðŸ’¡</span> Platform-Specific Tips
        </div>

        <div class="info-tip-box" style="margin-top:0; margin-bottom:10px;">
          <div class="info-tip-title">ðŸ¤– Android</div>
          <div class="info-tip-text">Notifications work best when the app is <strong>installed as a PWA</strong> (tap the browser menu â†’ "Add to Home Screen"). This ensures reliable background delivery.</div>
        </div>

        <div class="info-tip-box" style="margin-bottom:10px;">
          <div class="info-tip-title">ðŸŽ iOS (iPhone / iPad)</div>
          <div class="info-tip-text">You <strong>must first "Add to Home Screen"</strong> from Safari, then open the installed app and enable notifications from within. iOS does not support push notifications in the browser â€” only through installed PWAs.</div>
        </div>

        <div class="info-note-box" style="margin-top:0;">
          <div class="info-note-title">ðŸ”„ Troubleshooting</div>
          <div class="info-note-text">
            If notifications stop working, try these steps:<br><br>
            <strong>1.</strong> Check that phone-level notification permissions are still ON (Settings â†’ Notifications â†’ App Notifications)<br>
            <strong>2.</strong> Open Bhakti Sakha Settings and <strong>Disable</strong> then <strong>re-Enable</strong> push notifications<br>
            <strong>3.</strong> Make sure you have an active internet connection<br>
            <strong>4.</strong> On Android, ensure battery optimization is not killing the app in background
          </div>
        </div>
      </div>

      <!-- App Info -->
      <div class="info-section" style="text-align:center; padding:20px 16px;">
        <div style="font-size:0.78rem; color:var(--text3); line-height:1.7;">
          Built with devotion for the Vaishnava community<br>
          <strong style="color:var(--accent-gold);">Hare Krishna Hare Krishna Krishna Krishna Hare Hare</strong><br>
          <strong style="color:var(--accent-gold);">Hare Rama Hare Rama Rama Rama Hare Hare</strong>
        </div>
      </div>

    </div>
  </div>

<!-- Add Dham Modal -->
<div class="modal-overlay" id="addDhamModal">
  <div class="modal-sheet" style="max-height:92vh;">
    <div class="modal-handle"></div>
    <div class="modal-title">ðŸ›• Add Holy Dham</div>
    <div style="overflow-y:auto;max-height:calc(92vh - 120px);padding-bottom:20px;">
      <div class="dham-form-section">
        <label class="dham-form-label">Name *</label>
        <input class="dham-form-input" id="dhamFName" placeholder="e.g. Sri Vrindavan Dham">
      </div>
      <div class="dham-form-section">
        <label class="dham-form-label">Location *</label>
        <input class="dham-form-input" id="dhamFLoc" placeholder="e.g. Mathura, Uttar Pradesh, India">
      </div>
      <div class="dham-form-section" style="display:flex;gap:10px;">
        <div style="flex:1"><label class="dham-form-label">Icon (emoji)</label><input class="dham-form-input" id="dhamFIcon" placeholder="ðŸ›•" maxlength="4"></div>
        <div style="flex:1"><label class="dham-form-label">Tag</label>
          <select class="dham-form-input" id="dhamFTag"><option value="">None</option><option value="char-dham">Char Dham</option><option value="divya-desam">Divya Desam</option><option value="iskcon">ISKCON</option><option value="shakti-peetha">Shakti Peetha</option></select>
        </div>
      </div>
      <div class="dham-form-section"><label class="dham-form-label">Overview *</label><textarea class="dham-form-textarea" id="dhamFOverview" placeholder="Brief introduction, spiritual significance, main deity..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Scriptural & Historical Significance</label><textarea class="dham-form-textarea" id="dhamFScript" placeholder="References from scriptures, important pastimes, connection to acharyas..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Location & How to Reach</label><textarea class="dham-form-textarea" id="dhamFReach" placeholder="Nearest airport, railway, road options, local transport tips..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Temple Timings & Darshan</label><textarea class="dham-form-textarea" id="dhamFDarshan" placeholder="Daily darshan timings, aarti schedule, best time for darshan..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Festivals & Special Days</label><textarea class="dham-form-textarea" id="dhamFFest" placeholder="Major festivals, unique celebrations, best time of year..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Accommodation</label><textarea class="dham-form-textarea" id="dhamFAccom" placeholder="Temple guest houses, hotels, booking tips..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Prasadam & Food</label><textarea class="dham-form-textarea" id="dhamFFood" placeholder="Temple prasadam, sattvik food options, annadan..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Seva & Donations</label><textarea class="dham-form-textarea" id="dhamFSeva" placeholder="Available sevas, how to book or participate..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Key Places (one per line: Name | Description)</label><textarea class="dham-form-textarea" id="dhamFPlaces" placeholder="Main Temple | Description of the temple&#10;Sacred Lake | Description of the lake"></textarea><div class="dham-form-help">Format: Place Name | Short description (one per line)</div></div>
      <div class="dham-form-section"><label class="dham-form-label">Suggested Itinerary</label><textarea class="dham-form-textarea" id="dhamFItin" placeholder="Day 1 â€” Title&#10;6:00 AM â€” Activity&#10;..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Do's & Don'ts</label><textarea class="dham-form-textarea" id="dhamFDos" placeholder="Do's and Don'ts for visitors..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Best Time to Visit</label><textarea class="dham-form-textarea" id="dhamFBest" placeholder="Weather guidance, peak vs peaceful times..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Important Contacts</label><textarea class="dham-form-textarea" id="dhamFContacts" placeholder="Temple office numbers, websites..."></textarea></div>
      <div class="dham-form-section"><label class="dham-form-label">Devotee Tips</label><textarea class="dham-form-textarea" id="dhamFTips" placeholder="Practical tips from experience..."></textarea></div>
      <button class="dham-form-save" onclick="saveNewDham()">Save Dham</button>
      <button class="f-cancel" onclick="closeModal('addDhamModal')" style="margin-top:8px;">Cancel</button>
    </div>
  </div>
</div>

<!-- Persistent Audio Container (hidden, keeps audio playing across screens) -->
<div id="persistentAudioWrap"></div>

<!-- Now Playing Mini Bar -->
<div class="now-playing-bar" id="nowPlayingBar">
  <div class="now-playing-bar-inner" onclick="npBarTap(event)">
    <div class="np-bar-icon">
      <div class="now-playing-bars"><span></span><span></span><span></span><span></span></div>
    </div>
    <div class="np-bar-info">
      <div class="np-bar-title" id="npBarTitle">â€”</div>
      <div class="np-bar-subtitle" id="npBarSubtitle">Now Playing</div>
    </div>
    <button class="np-bar-close" onclick="npBarStop(event)" title="Stop">âœ•</button>
  </div>
</div>

<!-- Bottom Nav -->
  <!-- SEVAKART SCREEN -->
  <div class="screen" id="screen-sevakart">
    <div class="sk-screen">
      <div class="sk-header">
        <div class="sk-title">ðŸª” SevaKart</div>
        <div class="sk-subtitle">Devotees Supporting Devotees</div>
      </div>
      <div class="sk-search-bar">
        <input class="sk-search-inp" id="skSearchInp" placeholder="ðŸ” Search service, city, category..." oninput="skFilterListings()">
        <button class="sk-filter-btn" onclick="openModal('skFilterModal')">âš™ Filter</button>
      </div>
      <div class="sk-actions">
        <button class="sk-action-btn" onclick="skStartListing()">ðŸª” List Your Service</button>
        <button class="sk-action-btn secondary" onclick="skShowMyListings()">ðŸ“‹ My Listings</button>
      </div>
      <div class="sk-section-title">Browse Categories</div>
      <div class="sk-categories" id="skCategoriesGrid"></div>
      <div class="sk-section-title" id="skListingsTitle">Featured Listings</div>
      <div class="sk-listings" id="skListingsContainer"></div>
      <div class="sk-empty" id="skEmptyState" style="display:none;">
        <div class="sk-empty-icon">ðŸª”</div>
        <div>No listings yet. Be the first to list your service!</div>
      </div>
    </div>
  </div>

  <!-- SEVAKART DETAIL SCREEN -->
  <div class="screen" id="screen-sevakart-detail">
    <div class="sk-detail">
      <div class="sk-detail-header">
        <button class="sk-detail-back" onclick="skCloseDetail()">â†</button>
        <div class="sk-detail-htitle" id="skDetailHTitle"></div>
      </div>
      <div id="skDetailContent"></div>
    </div>
  </div>

  <!-- SEVAKART MY LISTINGS SCREEN -->
  <div class="screen" id="screen-sevakart-mylistings">
    <div class="sk-detail">
      <div class="sk-detail-header">
        <button class="sk-detail-back" onclick="skBackToMain()">â†</button>
        <div class="sk-detail-htitle">My Listings</div>
      </div>
      <div class="sk-my-listings" id="skMyListingsContainer" style="padding-top:14px;"></div>
    </div>
  </div>

  <!-- PRAYER CIRCLE -->
  <div class="screen" id="screen-prayer">
    <div class="pc-screen">
      <div class="pc-header">
        <div class="pc-title">ðŸ™ Prayer Circle</div>
        <div class="pc-subtitle">Supporting One Another Through Prayer</div>
      </div>
      <div class="pc-actions">
        <button class="pc-action-btn" onclick="pcOpenSubmitModal()">ðŸ™ Request Prayer</button>
        <button class="pc-action-btn secondary" onclick="pcShowMyRequests()">ðŸ“‹ My Requests</button>
      </div>
      <div class="pc-search-bar">
        <input class="pc-search-inp" id="pcSearchInp" placeholder="ðŸ” Search prayers..." oninput="pcFilterFeed()">
        <button class="pc-filter-btn" onclick="pcCycleFilter()">All â–¾</button>
      </div>
      <div class="pc-stats-bar" id="pcStatsBar">
        <div class="pc-stat-chip active" onclick="pcSetCatFilter('')">All</div>
        <div class="pc-stat-chip" onclick="pcSetCatFilter('Health')">ðŸ’š Health</div>
        <div class="pc-stat-chip" onclick="pcSetCatFilter('Family')">ðŸ‘¨â€ðŸ‘©â€ðŸ‘§ Family</div>
        <div class="pc-stat-chip" onclick="pcSetCatFilter('Career')">ðŸ’¼ Career</div>
        <div class="pc-stat-chip" onclick="pcSetCatFilter('Spiritual Growth')">ðŸ™ Spiritual</div>
        <div class="pc-stat-chip" onclick="pcSetCatFilter('Crisis')">ðŸ†˜ Crisis</div>
        <div class="pc-stat-chip" onclick="pcSetCatFilter('Other')">ðŸ“¿ Other</div>
      </div>
      <!-- Admin Dashboard -->
      <div class="pc-feed" id="pcFeedContainer"></div>
      <div class="pc-empty" id="pcEmptyState" style="display:none;">
        <div class="pc-empty-icon">ðŸ™</div>
        <div class="pc-empty-text">No prayer requests yet.<br>Be the first to request or share a prayer.</div>
      </div>
    </div>
  </div>

  <!-- PRAYER CIRCLE DETAIL -->
  <div class="screen" id="screen-prayer-detail">
    <div class="pc-detail">
      <div class="pc-detail-header">
        <button class="pc-detail-back" onclick="pcCloseDetail()">â†</button>
        <div class="pc-detail-htitle">Prayer Request</div>
      </div>
      <div class="pc-detail-body" id="pcDetailBody"></div>
    </div>
  </div>

  <!-- PRAYER CIRCLE MY REQUESTS -->
  <div class="screen" id="screen-prayer-my">
    <div class="pc-detail">
      <div class="pc-detail-header">
        <button class="pc-detail-back" onclick="pcBackToMain()">â†</button>
        <div class="pc-detail-htitle">My Prayer Requests</div>
      </div>
      <div style="padding:14px 18px 100px;" id="pcMyRequestsContainer"></div>
    </div>
  </div>

  <!-- CENTRALIZED ADMIN DASHBOARD -->
  <div class="screen" id="screen-admin">
    <div class="adm-wrap">
      <div class="adm-header">
        <div class="adm-header-icon">ðŸ›¡ï¸</div>
        <div class="adm-header-title">Admin Dashboard</div>
        <div class="adm-header-sub">Manage approvals, reviews & moderation</div>
      </div>

      <!-- Summary cards -->
      <div class="adm-summary" id="admSummary">
        <div class="adm-summary-card">
          <div class="adm-summary-num pending" id="admTotalPending">0</div>
          <div class="adm-summary-lbl">Pending</div>
        </div>
        <div class="adm-summary-card">
          <div class="adm-summary-num" id="admTotalReported">0</div>
          <div class="adm-summary-lbl">Reported</div>
        </div>
        <div class="adm-summary-card">
          <div class="adm-summary-num ok" id="admTotalApproved">0</div>
          <div class="adm-summary-lbl">Approved</div>
        </div>
      </div>

      <!-- Feature sections container -->
      <div id="admSectionsContainer"></div>
    </div>
  </div>

  <!-- USER LIST SCREEN -->
  <div class="screen" id="screen-userlist">
    <div class="ul-wrap">
      <div class="ul-header">
        <button class="ul-back" onclick="switchScreen('admin',null)">â†</button>
        <div class="ul-title">ðŸ‘¥ App Users</div>
      </div>
      <div class="ul-summary">
        <div class="ul-summary-card"><div class="ul-summary-num total" id="ulTotal">0</div><div class="ul-summary-lbl">Total Users</div></div>
        <div class="ul-summary-card"><div class="ul-summary-num active" id="ulActive">0</div><div class="ul-summary-lbl">Active (24h)</div></div>
        <div class="ul-summary-card"><div class="ul-summary-num inactive" id="ulInactive">0</div><div class="ul-summary-lbl">Inactive</div></div>
      </div>
      <input class="ul-search" id="ulSearchInput" placeholder="ðŸ” Search users..." oninput="ulFilterList()">
      <div class="ul-filters">
        <div class="ul-filter-chip active" onclick="ulSetFilter('all')">All</div>
        <div class="ul-filter-chip" onclick="ulSetFilter('active')">ðŸŸ¢ Active</div>
        <div class="ul-filter-chip" onclick="ulSetFilter('inactive')">ðŸŸ¡ Inactive</div>
      </div>
      <div class="ul-list" id="ulListContainer">
        <div class="ul-empty">Loading user data...</div>
      </div>
    </div>
  </div>

<!-- Prayer Circle: Submit Request Modal -->
<div class="modal-overlay" id="pcSubmitModal">
  <div class="modal-sheet" style="max-height:92vh;">
    <div class="modal-handle"></div>
    <div class="modal-title">ðŸ™ Submit Prayer Request</div>
    <div class="f-grp">
      <label class="f-lbl">Your Name</label>
      <input class="f-inp" id="pcReqName" placeholder="Enter your name...">
      <div style="display:flex;align-items:center;gap:6px;margin-top:6px;">
        <label class="toggle" style="transform:scale(0.8);"><input type="checkbox" id="pcReqAnon" onchange="document.getElementById('pcReqName').disabled=this.checked; if(this.checked)document.getElementById('pcReqName').value='Anonymous';"></label>
        <span style="font-size:0.72rem;color:var(--text3);">Submit Anonymously</span>
      </div>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Prayer For</label>
      <select class="f-sel" id="pcReqFor">
        <option value="self">Myself</option>
        <option value="other">Someone Else</option>
      </select>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Category</label>
      <select class="f-sel" id="pcReqCategory">
        <option value="Health">ðŸ’š Health</option>
        <option value="Family">ðŸ‘¨â€ðŸ‘©â€ðŸ‘§ Family</option>
        <option value="Career">ðŸ’¼ Career</option>
        <option value="Spiritual Growth">ðŸ™ Spiritual Growth</option>
        <option value="Crisis">ðŸ†˜ Crisis</option>
        <option value="Other">ðŸ“¿ Other</option>
      </select>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Short Title</label>
      <input class="f-inp" id="pcReqTitle" placeholder="e.g., Prayer for speedy recovery..." maxlength="100">
    </div>
    <div class="f-grp">
      <label class="f-lbl">Detailed Description</label>
      <textarea class="f-area" id="pcReqDesc" rows="4" placeholder="Share more details about your prayer request..."></textarea>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Urgency</label>
      <select class="f-sel" id="pcReqUrgency">
        <option value="normal">Normal</option>
        <option value="urgent">Urgent</option>
      </select>
    </div>
    <div class="f-grp" style="display:flex;align-items:flex-start;gap:8px;">
      <input type="checkbox" id="pcReqConsent" style="margin-top:3px;">
      <label for="pcReqConsent" style="font-size:0.72rem;color:var(--text2);line-height:1.5;">I consent to sharing this prayer request with the community. I understand it will be visible to other devotees once approved and may be moderated by admins.</label>
    </div>
    <div style="display:flex;gap:10px;margin-top:10px;">
      <button class="f-cancel" onclick="closeModal('pcSubmitModal')" style="flex:0.4;">Cancel</button>
      <button class="f-submit" onclick="pcSubmitRequest()" style="flex:1;">Submit Prayer Request</button>
    </div>
  </div>
</div>

<!-- Prayer Circle: Write Prayer Modal -->
<div class="modal-overlay" id="pcWritePrayerModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">âœï¸ Write a Prayer</div>
    <div class="f-grp">
      <label class="f-lbl">Your Prayer</label>
      <textarea class="f-area" id="pcWritePrayerText" rows="4" placeholder="Write your heartfelt prayer..."></textarea>
    </div>
    <div style="display:flex;gap:10px;margin-top:10px;">
      <button class="f-cancel" onclick="closeModal('pcWritePrayerModal')" style="flex:0.4;">Cancel</button>
      <button class="f-submit" onclick="pcSubmitWrittenPrayer()" style="flex:1;">Offer Prayer</button>
    </div>
  </div>
</div>

<!-- Prayer Circle: Update/Gratitude Modal -->
<div class="modal-overlay" id="pcUpdateModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">ðŸ’¬ Post Update</div>
    <div class="f-grp">
      <label class="f-lbl">Update Type</label>
      <select class="f-sel" id="pcUpdateType">
        <option value="update">General Update</option>
        <option value="gratitude">Gratitude Message</option>
      </select>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Message</label>
      <textarea class="f-area" id="pcUpdateText" rows="3" placeholder="Share your update or gratitude..."></textarea>
    </div>
    <div style="display:flex;gap:10px;margin-top:10px;">
      <button class="f-cancel" onclick="closeModal('pcUpdateModal')" style="flex:0.4;">Cancel</button>
      <button class="f-submit" onclick="pcSubmitUpdate()" style="flex:1;">Post Update</button>
    </div>
  </div>
</div>

<!-- Prayer Circle: Report Modal -->
<div class="modal-overlay" id="pcReportModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">ðŸš© Report Content</div>
    <div class="f-grp">
      <label class="f-lbl">Reason</label>
      <select class="f-sel" id="pcReportReason">
        <option value="inappropriate">Inappropriate Content</option>
        <option value="spam">Spam</option>
        <option value="offensive">Offensive Language</option>
        <option value="other">Other</option>
      </select>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Details (optional)</label>
      <textarea class="f-area" id="pcReportDetails" rows="2" placeholder="Provide more details..."></textarea>
    </div>
    <div style="display:flex;gap:10px;margin-top:10px;">
      <button class="f-cancel" onclick="closeModal('pcReportModal')" style="flex:0.4;">Cancel</button>
      <button class="f-submit" onclick="pcSubmitReport()" style="flex:1;">Submit Report</button>
    </div>
  </div>
</div>

<!-- Prayer Circle: Admin Reject Modal -->
<div class="modal-overlay" id="pcAdminRejectModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">âŒ Reject Prayer Request</div>
    <div class="f-grp">
      <label class="f-lbl">Reason for Rejection</label>
      <textarea class="f-area" id="pcRejectReason" rows="2" placeholder="Reason..."></textarea>
    </div>
    <div style="display:flex;gap:10px;margin-top:10px;">
      <button class="f-cancel" onclick="closeModal('pcAdminRejectModal')" style="flex:0.4;">Cancel</button>
      <button class="f-submit" onclick="pcAdminReject()" style="flex:1;background:var(--accent-red);">Reject</button>
    </div>
  </div>
</div>

<nav class="bottom-nav" id="bottomNav">
  <div class="nav-scroll-area" id="navScrollArea">
    <button class="nav-btn active" onclick="switchScreen('home',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
      <span class="nav-lbl">Home</span>
    </button>
    <button class="nav-btn" onclick="switchScreen('calendar',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
      <span class="nav-lbl">Calendar</span>
    </button>
    <button class="nav-btn" onclick="switchScreen('songs',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>
      <span class="nav-lbl">Audio</span>
    </button>
    <button class="nav-btn" onclick="switchScreen('events',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
      <span class="nav-lbl">Events</span>
    </button>
    <button class="nav-btn" onclick="switchScreen('notes',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
      <span class="nav-lbl">Notes</span>
    </button>
    <button class="nav-btn" onclick="switchScreen('dhamas',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 21h18"/><path d="M5 21V7l7-4 7 4v14"/><path d="M9 21v-6h6v6"/><path d="M10 10h.01"/><path d="M14 10h.01"/></svg>
      <span class="nav-lbl">Dhamas</span>
    </button>
    <button class="nav-btn" onclick="switchScreen('sevakart',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2C8 2 4 6 4 10c0 5.33 8 12 8 12s8-6.67 8-12c0-4-4-8-8-8z"/><circle cx="12" cy="10" r="3"/></svg>
      <span class="nav-lbl">SevaKart</span>
    </button>
    <button class="nav-btn" onclick="switchScreen('prayer',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M9 12h6"/><path d="M12 9v6"/></svg>
      <span class="nav-lbl">Prayers</span>
    </button>
  </div>
  <button class="nav-arrow-hint" id="navArrowHint" onclick="scrollNavForward()">
    <div class="nav-arrow-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
    </div>
  </button>
</nav>

<!-- Location Modal -->
<div class="modal-overlay" id="locModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">ðŸ“ Change Location</div>
    <input class="loc-search" id="locSearchModal" placeholder="ðŸ”  Search city..." oninput="filterLocGrid(this.value,'modalLocGrid')" autocomplete="off">
    <div class="loc-grid" id="modalLocGrid"></div>
    <button class="f-cancel" onclick="closeModal('locModal')">Cancel</button>
  </div>
</div>

<!-- Add Event Modal -->
<div class="modal-overlay" id="addEvtModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">âœ¨ Add Custom Event</div>
    <div class="f-grp">
      <label class="f-lbl">Event Name *</label>
      <input class="f-inp" id="evtName" placeholder="e.g. Radha's Birthday Puja">
    </div>
    <div class="f-row">
      <div class="f-grp">
        <label class="f-lbl">Day *</label>
        <select class="f-sel" id="evtDay"></select>
      </div>
      <div class="f-grp">
        <label class="f-lbl">Month *</label>
        <select class="f-sel" id="evtMonth">
          <option value="0">January</option><option value="1">February</option>
          <option value="2">March</option><option value="3">April</option>
          <option value="4">May</option><option value="5">June</option>
          <option value="6">July</option><option value="7">August</option>
          <option value="8">September</option><option value="9">October</option>
          <option value="10">November</option><option value="11">December</option>
        </select>
      </div>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Year (optional â€” leave blank for annual)</label>
      <input class="f-inp" id="evtYear" type="number" placeholder="e.g. 1990" min="1900" max="2100">
    </div>
    <div class="f-grp">
      <label class="f-lbl">Event Type</label>
      <select class="f-sel" id="evtType">
        <option value="birthday">ðŸŽ‚ Birthday</option>
        <option value="marriage">ðŸ’ Marriage Anniversary</option>
        <option value="puja">ðŸª· Puja / Ceremony</option>
        <option value="initiation">ðŸŒº Initiation Day</option>
        <option value="other">ðŸ“Œ Other</option>
      </select>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Notes (optional)</label>
      <textarea class="f-area" id="evtNotes" placeholder="Any notes..."></textarea>
    </div>
    <div class="sett-row" style="padding:8px 0;">
      <div class="sett-info"><div class="sett-name">Enable Reminder</div></div>
      <label class="toggle"><input type="checkbox" id="evtReminder" checked></label>
    </div>
    <button class="f-submit" onclick="saveEvt()">Save Event</button>
    <button class="f-cancel" onclick="closeModal('addEvtModal')">Cancel</button>
  </div>
</div>

<!-- SevaKart: List Service Modal -->
<div class="modal-overlay" id="skListModal">
  <div class="modal-sheet" style="max-height:92vh;overflow-y:auto;">
    <div class="modal-handle"></div>
    <div class="modal-title" id="skListModalTitle">ðŸª” List Your Service</div>
    <div class="sk-step-indicator" id="skStepIndicator">
      <div class="sk-step-dot active"></div>
      <div class="sk-step-dot"></div>
      <div class="sk-step-dot"></div>
    </div>
    <!-- Step 1: Eligibility -->
    <div class="sk-form-step active" id="skStep1">
      <div style="font-size:0.85rem;color:var(--text2);margin-bottom:14px;">Please confirm before proceeding:</div>
      <div class="sk-eligibility-check">
        <input type="checkbox" id="skElig1">
        <label for="skElig1">I confirm this service aligns with Bhakti values.</label>
      </div>
      <div class="sk-eligibility-check">
        <input type="checkbox" id="skElig2">
        <label for="skElig2">No alcohol, meat, gambling, political or speculative activities involved.</label>
      </div>
      <button class="f-submit" onclick="skNextStep(1)" style="margin-top:10px;">Continue â†’</button>
      <button class="f-cancel" onclick="closeModal('skListModal')">Cancel</button>
    </div>
    <!-- Step 2: Details -->
    <div class="sk-form-step" id="skStep2">
      <div class="f-grp"><label class="f-lbl">Business / Service Name *</label>
        <input class="f-inp" id="skBizName" placeholder="e.g. Radha's Prasadam Kitchen"></div>
      <div class="f-grp"><label class="f-lbl">Contact Person Name *</label>
        <input class="f-inp" id="skContactName" placeholder="Your name"></div>
      <div class="f-grp"><label class="f-lbl">Mobile Number *</label>
        <input class="f-inp" id="skMobile" type="tel" placeholder="+91 98765 43210"></div>
      <div class="f-grp">
        <label class="f-lbl">WhatsApp Number (same as mobile?)</label>
        <div style="display:flex;gap:10px;align-items:center;">
          <label style="font-size:0.8rem;color:var(--text2);display:flex;align-items:center;gap:6px;cursor:pointer;">
            <input type="checkbox" id="skWASame" checked onchange="document.getElementById('skWA').disabled=this.checked; if(this.checked) document.getElementById('skWA').value='';" style="accent-color:var(--accent-gold);"> Same as mobile
          </label>
          <input class="f-inp" id="skWA" type="tel" placeholder="WhatsApp number" disabled style="flex:1;">
        </div>
      </div>
      <div class="f-grp"><label class="f-lbl">Email (optional)</label>
        <input class="f-inp" id="skEmail" type="email" placeholder="email@example.com"></div>
      <div class="f-grp"><label class="f-lbl">City *</label>
        <input class="f-inp" id="skCity" placeholder="e.g. Mumbai, Vrindavan, Dallas"></div>
      <div class="f-grp"><label class="f-lbl">Category *</label>
        <select class="f-sel" id="skCategory">
          <option value="">Select category</option>
          <option value="Deity Services">ðŸª· Deity Services</option>
          <option value="Prasadam & Catering">ðŸ² Prasadam & Catering</option>
          <option value="Kirtan & Events">ðŸŽµ Kirtan & Events</option>
          <option value="Devotional Products">ðŸ“¿ Devotional Products</option>
          <option value="Education">ðŸ“– Education</option>
          <option value="Professional Services">ðŸ’¼ Professional Services</option>
          <option value="Temple Supplies">ðŸ›• Temple Supplies</option>
          <option value="Yatra & Travel">ðŸš Yatra & Travel</option>
        </select></div>
      <div class="f-grp"><label class="f-lbl">Short Description (max 100 chars) *</label>
        <input class="f-inp" id="skShortDesc" maxlength="100" placeholder="Brief summary of your service"></div>
      <div class="f-grp"><label class="f-lbl">Full Description (max 500 chars)</label>
        <textarea class="f-area" id="skFullDesc" maxlength="500" placeholder="Detailed description..." style="min-height:100px;"></textarea></div>
      <div class="f-grp"><label class="f-lbl">Years in Service (optional)</label>
        <input class="f-inp" id="skYears" type="number" min="0" placeholder="e.g. 5"></div>
      <div class="f-grp"><label class="f-lbl">Website / Instagram link (optional)</label>
        <input class="f-inp" id="skWebsite" type="url" placeholder="https://..."></div>
      <div class="f-grp"><label class="f-lbl">Photos (up to 3)</label>
        <div class="sk-photo-upload" id="skPhotoUpload">
          <div class="sk-photo-slot" onclick="skPickPhoto(0)">ï¼‹</div>
          <div class="sk-photo-slot" onclick="skPickPhoto(1)">ï¼‹</div>
          <div class="sk-photo-slot" onclick="skPickPhoto(2)">ï¼‹</div>
        </div>
        <input type="file" id="skPhotoInput" accept="image/*" style="display:none;" onchange="skHandlePhoto(event)">
      </div>
      <div style="display:flex;gap:8px;margin-top:8px;">
        <button class="f-cancel" onclick="skPrevStep(2)" style="flex:1;">â† Back</button>
        <button class="f-submit" onclick="skNextStep(2)" style="flex:1;">Preview â†’</button>
      </div>
    </div>
    <!-- Step 3: Preview & Submit -->
    <div class="sk-form-step" id="skStep3">
      <div id="skPreviewContainer"></div>
      <div class="sk-eligibility-check" style="margin-top:10px;">
        <input type="checkbox" id="skTerms">
        <label for="skTerms">I agree to the <span style="color:var(--accent-gold);cursor:pointer;" onclick="alert('SevaKart Terms:\\n\\n1. Only Bhakti-aligned services allowed.\\n2. No alcohol, meat, gambling, political campaigns, MLM, or financial schemes.\\n3. SevaKart facilitates connection only â€” all transactions are between users.\\n4. Listings may be reviewed and moderated by admins.\\n5. Misleading or inappropriate listings will be removed.')">Terms & Conditions</span>.</label>
      </div>
      <div style="display:flex;gap:8px;margin-top:10px;">
        <button class="f-cancel" onclick="skPrevStep(3)" style="flex:1;">â† Edit</button>
        <button class="f-submit" onclick="skSubmitListing()" style="flex:1;">Submit for Approval</button>
      </div>
    </div>
  </div>
</div>

<!-- SevaKart: Filter Modal -->
<div class="modal-overlay" id="skFilterModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">âš™ Filter Listings</div>
    <div class="sk-filter-section">
      <div class="sk-filter-lbl">Category</div>
      <div class="sk-filter-chips" id="skFilterCats"></div>
    </div>
    <div class="f-grp"><label class="f-lbl">City</label>
      <input class="f-inp" id="skFilterCity" placeholder="Filter by city..."></div>
    <button class="f-submit" onclick="skApplyFilter()">Apply Filter</button>
    <button class="f-cancel" onclick="skClearFilter()">Clear Filters</button>
  </div>
</div>

<!-- SevaKart: Review Modal -->
<div class="modal-overlay" id="skReviewModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">â­ Write a Review</div>
    <div class="f-grp">
      <label class="f-lbl">Your Rating *</label>
      <div class="sk-star-input" id="skReviewStars">
        <span onclick="skSetReviewRating(1)">â˜†</span>
        <span onclick="skSetReviewRating(2)">â˜†</span>
        <span onclick="skSetReviewRating(3)">â˜†</span>
        <span onclick="skSetReviewRating(4)">â˜†</span>
        <span onclick="skSetReviewRating(5)">â˜†</span>
      </div>
    </div>
    <div class="f-grp"><label class="f-lbl">Your Review (max 300 chars)</label>
      <textarea class="f-area" id="skReviewText" maxlength="300" placeholder="Share your experience..."></textarea></div>
    <button class="f-submit" onclick="skSubmitReview()">Submit Review</button>
    <button class="f-cancel" onclick="closeModal('skReviewModal')">Cancel</button>
  </div>
</div>

<!-- SevaKart: Report Modal -->
<div class="modal-overlay" id="skReportModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">ðŸš© Report Listing</div>
    <div class="f-grp"><label class="f-lbl">Reason for reporting *</label>
      <select class="f-sel" id="skReportReason">
        <option value="">Select reason</option>
        <option value="not_bhakti">Not aligned with Bhakti values</option>
        <option value="misleading">Misleading information</option>
        <option value="inappropriate">Inappropriate content</option>
        <option value="spam">Spam or duplicate</option>
        <option value="fraud">Suspected fraud</option>
        <option value="other">Other</option>
      </select></div>
    <div class="f-grp"><label class="f-lbl">Details (optional)</label>
      <textarea class="f-area" id="skReportDetails" placeholder="Additional details..."></textarea></div>
    <button class="f-submit" onclick="skSubmitReport()">Submit Report</button>
    <button class="f-cancel" onclick="closeModal('skReportModal')">Cancel</button>
  </div>
</div>

<!-- SevaKart: Admin Reject Modal -->
<div class="modal-overlay" id="skRejectModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">âŒ Reject Listing</div>
    <div class="f-grp"><label class="f-lbl">Reason for rejection *</label>
      <textarea class="f-area" id="skRejectReason" placeholder="Explain why this listing is being rejected..."></textarea></div>
    <button class="f-submit" onclick="skConfirmReject()" style="background:var(--accent-red);">Reject Listing</button>
    <button class="f-cancel" onclick="closeModal('skRejectModal')">Cancel</button>
  </div>
</div>

<!-- Admin Song Modal -->
<div class="modal-overlay" id="adminSongModal">
  <div class="modal-sheet" style="max-height:90vh;overflow-y:auto;">
    <div class="modal-handle"></div>
    <div class="modal-title">ðŸŽµ Add Song / Kirtan</div>
    <div class="f-grp">
      <label class="f-lbl">Song Name *</label>
      <input class="f-inp" id="aSongTitle" placeholder="e.g. Hare Krishna Maha-Mantra">
    </div>
    <div class="f-grp">
      <label class="f-lbl">Official Name</label>
      <input class="f-inp" id="aSongOfficialName" placeholder="e.g. MahÄ-mantra / Hare Ká¹›á¹£á¹‡a KÄ«rtana">
    </div>
    <div class="f-grp">
      <label class="f-lbl">Author / Composer</label>
      <input class="f-inp" id="aSongAuthor" placeholder="e.g. Bhaktivinoda Thakura">
    </div>
    <div class="f-grp">
      <label class="f-lbl">Category</label>
      <select class="f-sel" id="aSongCat">
        <option value="vbhajan">Vaishnava Bhajans</option>
        <option value="hkkirtan">Hare Krsna Kirtans</option>
        <option value="astakam">Astakams</option>
        <option value="stotram">Stotrams</option>
        <option value="gita">Bhagavad Gita Verses</option>
        <option value="bhagavatam">Srimad Bhagavatam Prayers</option>
        <option value="samhita">Samhita</option>
      </select>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Book Name</label>
      <input class="f-inp" id="aSongBook" placeholder="e.g. Gitavali, Bhagavad Gita, Padyavali">
    </div>
    <div class="f-grp">
      <label class="f-lbl">Language</label>
      <select class="f-sel" id="aSongLang">
        <option value="Sanskrit">Sanskrit</option>
        <option value="Bengali">Bengali</option>
        <option value="Hindi">Hindi</option>
        <option value="English">English</option>
        <option value="Gujarati">Gujarati</option>
        <option value="Tamil">Tamil</option>
        <option value="Telugu">Telugu</option>
        <option value="Kannada">Kannada</option>
        <option value="Marathi">Marathi</option>
        <option value="Odia">Odia</option>
        <option value="Mixed">Mixed / Multiple</option>
        <option value="Other">Other</option>
      </select>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Lyrics (Original)</label>
      <div class="rte-toolbar">
        <button class="rte-btn" onclick="rteCmd('bold')" title="Bold"><b>B</b></button>
        <button class="rte-btn" onclick="rteCmd('italic')" title="Italic"><i>I</i></button>
        <button class="rte-btn" onclick="rteCmd('underline')" title="Underline"><u>U</u></button>
        <span class="rte-sep"></span>
        <input type="color" class="rte-color" id="rteLyricsColor" value="#c9a84c" onchange="rteColor(this.value)" title="Text Color">
        <button class="rte-btn" onclick="rteRemoveFormat()" title="Clear Formatting" style="font-size:0.65rem;">âœ•</button>
      </div>
      <div class="f-area rte-editable" id="aSongLyrics" contenteditable="true" style="min-height:110px" data-placeholder="Full lyrics in original script or transliteration..."></div>
    </div>
    <div class="f-grp">
      <label class="f-lbl">Translation / Meaning</label>
      <div class="rte-toolbar">
        <button class="rte-btn" onclick="rteCmd('bold')" title="Bold"><b>B</b></button>
        <button class="rte-btn" onclick="rteCmd('italic')" title="Italic"><i>I</i></button>
        <button class="rte-btn" onclick="rteCmd('underline')" title="Underline"><u>U</u></button>
        <span class="rte-sep"></span>
        <input type="color" class="rte-color" id="rteTransColor" value="#c9a84c" onchange="rteColor(this.value)" title="Text Color">
        <button class="rte-btn" onclick="rteRemoveFormat()" title="Clear Formatting" style="font-size:0.65rem;">âœ•</button>
      </div>
      <div class="f-area rte-editable" id="aSongTrans" contenteditable="true" style="min-height:80px" data-placeholder="English meaning or word-for-word translation..."></div>
    </div>
    <div style="font-size:0.78rem;color:var(--text2);margin-bottom:8px;font-weight:500;">ðŸŽ¤ Audio Recordings (up to 5)</div>
    <datalist id="singerList">
      <option value="HG Jai Sacinandana Pr">
      <option value="HG RadhaGopinath Pr">
      <option value="HG Svarupa Damodar Pr">
      <option value="HH BB Govinda Swami Maharaj">
      <option value="HH Bhakti Caru Swami Maharaj">
      <option value="HH Radhanath Swami Maharaj">
    </datalist>
    <div id="audioFieldsWrap">
      <div class="audio-field-row" id="aRow0">
        <div class="f-grp" style="margin-bottom:4px;"><label class="f-lbl">Singer / Artist 1</label><input class="f-inp a-singer" data-idx="0" placeholder="Select or type name" list="singerList"></div>
        <div class="f-grp"><label class="f-lbl">Audio URL 1</label><input class="f-inp a-url" data-idx="0" placeholder="https://...mp3"></div>
      </div>
      <div class="audio-field-row" id="aRow1" style="display:none;">
        <div class="f-grp" style="margin-bottom:4px;"><label class="f-lbl">Singer / Artist 2</label><input class="f-inp a-singer" data-idx="1" placeholder="Select or type name" list="singerList"></div>
        <div class="f-grp"><label class="f-lbl">Audio URL 2</label><input class="f-inp a-url" data-idx="1" placeholder="https://...mp3"></div>
      </div>
      <div class="audio-field-row" id="aRow2" style="display:none;">
        <div class="f-grp" style="margin-bottom:4px;"><label class="f-lbl">Singer / Artist 3</label><input class="f-inp a-singer" data-idx="2" placeholder="Select or type name" list="singerList"></div>
        <div class="f-grp"><label class="f-lbl">Audio URL 3</label><input class="f-inp a-url" data-idx="2" placeholder="https://...mp3"></div>
      </div>
      <div class="audio-field-row" id="aRow3" style="display:none;">
        <div class="f-grp" style="margin-bottom:4px;"><label class="f-lbl">Singer / Artist 4</label><input class="f-inp a-singer" data-idx="3" placeholder="Select or type name" list="singerList"></div>
        <div class="f-grp"><label class="f-lbl">Audio URL 4</label><input class="f-inp a-url" data-idx="3" placeholder="https://...mp3"></div>
      </div>
      <div class="audio-field-row" id="aRow4" style="display:none;">
        <div class="f-grp" style="margin-bottom:4px;"><label class="f-lbl">Singer / Artist 5</label><input class="f-inp a-singer" data-idx="4" placeholder="Select or type name" list="singerList"></div>
        <div class="f-grp"><label class="f-lbl">Audio URL 5</label><input class="f-inp a-url" data-idx="4" placeholder="https://...mp3"></div>
      </div>
    </div>
    <button class="bk-btn" id="addAudioBtn" onclick="showNextAudioField()" style="margin-bottom:14px;background:rgba(61,127,212,0.1);border-color:rgba(61,127,212,0.3);color:var(--accent-blue);">+ Add Another Recording</button>
    <button class="f-submit" onclick="adminAddSong()">Save Song</button>
    <button class="f-cancel" onclick="delete document.getElementById('adminSongModal').dataset.editId; document.querySelector('#adminSongModal .modal-title').textContent='ðŸŽµ Add Song / Kirtan'; closeModal('adminSongModal')">Cancel</button>
  </div>
</div>

<!-- Add/Edit Note Modal -->
<!-- Note Editor Overlay (Full-screen) -->
<div class="note-editor-overlay" id="noteEditorOverlay">
  <div class="note-editor-topbar">
    <button class="ne-back-btn" onclick="closeNoteEditor()">â† Back</button>
    <div class="ne-topbar-actions">
      <button class="songs-font-btn" onclick="changeNoteFont(-1)" style="width:28px;height:28px;">Aâˆ’</button>
      <button class="songs-font-btn" onclick="changeNoteFont(1)" style="width:28px;height:28px;">A+</button>
      <button class="ne-action-btn" onclick="toggleNotePin()" id="nePinBtn" title="Pin note">ðŸ“Œ</button>
      <button class="ne-action-btn" onclick="toggleNoteLock()" id="neLockBtn" title="Lock note">ðŸ”’</button>
      <button class="ne-action-btn" onclick="deleteCurrentNote()" title="Delete note">ðŸ—‘ï¸</button>
      <button class="ne-save-btn" onclick="saveNote()">ðŸ’¾ Save</button>
    </div>
  </div>
  <input class="ne-title-input" id="neTitle" placeholder="Note titleâ€¦" maxlength="120">
  <div class="ne-meta-row">
    <select class="ne-meta-sel" id="neCat">
      <option value="spiritual">ðŸ”µ Spiritual</option>
      <option value="personal">ðŸŸ£ Personal</option>
      <option value="prayer">ðŸŸ¡ Prayer</option>
      <option value="reminder">ðŸŸ¢ Reminder</option>
      <option value="other">âšª Other</option>
    </select>
    <input class="ne-meta-date" id="neLinkedDate" type="date" title="Link to date" style="display:none;">
  </div>
  <div class="ne-toolbar">
    <button class="ne-fmt-btn" onclick="neExec('bold')" title="Bold"><b>B</b></button>
    <button class="ne-fmt-btn" onclick="neExec('italic')" title="Italic"><i>I</i></button>
    <button class="ne-fmt-btn" onclick="neExec('underline')" title="Underline"><u>U</u></button>
    <div class="ne-fmt-sep"></div>
    <button class="ne-fmt-btn" onclick="neExec('insertUnorderedList')" title="Bullet list">â€¢â‰¡</button>
    <button class="ne-fmt-btn" onclick="neExec('insertOrderedList')" title="Numbered list">1.</button>
    <div class="ne-fmt-sep"></div>
    <button class="ne-fmt-btn" onclick="neExecHeading('h1')" title="Heading 1" style="font-weight:800;font-size:0.9rem;">H1</button>
    <button class="ne-fmt-btn" onclick="neExecHeading('h2')" title="Heading 2" style="font-weight:700;font-size:0.82rem;">H2</button>
    <div class="ne-fmt-sep"></div>
    <button class="ne-fmt-btn" onclick="neExecHighlight()" title="Highlight" style="background:rgba(241,196,15,0.2);">ðŸ–</button>
  </div>
  <div class="ne-content-area">
    <div class="ne-content-editable" id="neBody" contenteditable="true" data-placeholder="Write your note hereâ€¦"></div>
  </div>
  <div class="ne-autosave-indicator" id="neAutosaveMsg">Ready</div>
  <input type="hidden" id="neEditId" value="">
</div>

<!-- PIN Entry/Setup Modal -->
<div class="pin-overlay" id="pinOverlay">
  <div class="pin-box">
    <div class="pin-box-title" id="pinTitle">ðŸ” Enter PIN</div>
    <div class="pin-box-sub" id="pinSubtitle">Enter your 4-digit PIN to unlock this note</div>
    <div class="pin-dots" id="pinDots">
      <div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div>
    </div>
    <div class="pin-error-msg" id="pinErrorMsg"></div>
    <div class="pin-numpad" id="pinNumpad">
      <button class="pin-key" onclick="pinInput(1)">1</button>
      <button class="pin-key" onclick="pinInput(2)">2</button>
      <button class="pin-key" onclick="pinInput(3)">3</button>
      <button class="pin-key" onclick="pinInput(4)">4</button>
      <button class="pin-key" onclick="pinInput(5)">5</button>
      <button class="pin-key" onclick="pinInput(6)">6</button>
      <button class="pin-key" onclick="pinInput(7)">7</button>
      <button class="pin-key" onclick="pinInput(8)">8</button>
      <button class="pin-key" onclick="pinInput(9)">9</button>
      <button class="pin-key" style="visibility:hidden"></button>
      <button class="pin-key" onclick="pinInput(0)">0</button>
      <button class="pin-key pin-del" onclick="pinDelete()">âŒ«</button>
    </div>
    <div class="pin-forgot-link" id="pinForgotLink" onclick="forgotPin()" style="display:none;">Forgot PIN?</div>
    <div style="margin-top:12px;">
      <button class="f-cancel" onclick="closePinOverlay()" style="font-size:0.78rem;padding:6px 18px;">Cancel</button>
    </div>
  </div>
</div>

<!-- Legacy note modal (hidden, kept for compat) -->
<div class="modal-overlay" id="noteModal" style="display:none!important;">
  <div class="modal-sheet"><div class="modal-handle"></div></div>
</div>

<!-- Date Picker Modal -->
<div class="dp-overlay" id="dpModal" onclick="dpOverlayClick(event)">
  <div class="dp-box">
    <div class="dp-header">
      <div class="dp-header-label">Jump to Date</div>
      <div class="dp-header-date" id="dpHeaderDate">Select a date</div>
      <div class="dp-header-vaishnava" id="dpHeaderVaishnava"></div>
    </div>
    <div class="dp-body">
      <div class="dp-section-label">Year</div>
      <div class="dp-year-grid" id="dpYearGrid"></div>
      <div class="dp-section-label">Month</div>
      <div class="dp-month-grid" id="dpMonthGrid"></div>
      <div class="dp-section-label">Day</div>
      <div class="dp-day-grid" id="dpDayGrid"></div>
    </div>
    <div class="dp-footer">
      <button class="dp-cancel" onclick="closeModal('dpModal')">Cancel</button>
      <button class="dp-go" onclick="dpGo()">Go to Date â†’</button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<!-- Event Detail Modal -->
<div class="evt-modal-overlay" id="evtModalOverlay" onclick="closeEvtModal(event)">
  <div class="evt-modal-sheet" id="evtModalSheet">
    <div class="evt-modal-handle"></div>
    <div class="evt-modal-header">
      <div class="evt-modal-title-wrap">
        <div class="evt-modal-type" id="evtModalType"></div>
        <div class="evt-modal-title" id="evtModalTitle"></div>
      </div>
      <button class="evt-modal-close" onclick="closeEvtModal()">âœ•</button>
    </div>
    <div class="evt-modal-icon" id="evtModalIcon"></div>
    <div class="evt-modal-date" id="evtModalDate"></div>
    <div class="evt-modal-desc" id="evtModalDesc"></div>
    <div class="evt-modal-notes" id="evtModalNotes">
      <hr class="evt-notes-divider">
      <div class="evt-notes-header">
        <span class="evt-notes-label">About This Day</span>
        <div style="display:flex;align-items:center;gap:6px;">
          <button class="evt-notes-font-btn" onclick="changeEvtNoteFont(-1)" title="Decrease font">Aâˆ’</button>
          <button class="evt-notes-font-btn" onclick="changeEvtNoteFont(1)" title="Increase font">A+</button>
          <button class="evt-notes-edit-btn" id="evtNotesEditBtn" onclick="toggleEvtNoteEditor()" style="display:none;">âœŽ Edit</button>
        </div>
      </div>
      <div class="evt-notes-display" id="evtNotesDisplay"></div>
      <div class="evt-notes-editor" id="evtNotesEditor">
        <textarea class="evt-notes-textarea" id="evtNotesTextarea" placeholder="Add details about this day â€” significance, rituals, mantras, historyâ€¦"></textarea>
        <div class="evt-notes-actions">
          <button class="evt-notes-delete" id="evtNotesDeleteBtn" onclick="deleteEvtNote()">ðŸ—‘ Delete</button>
          <button class="evt-notes-cancel" onclick="cancelEvtNoteEdit()">Cancel</button>
          <button class="evt-notes-save" onclick="saveEvtNote()">Save</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Sign-in Prompt Modal -->
<div class="signin-prompt-overlay" id="signInPromptOverlay" onclick="if(event.target===this)closeSignInPrompt()">
  <div class="signin-prompt-sheet">
    <div class="signin-prompt-icon">ðŸ”</div>
    <div class="signin-prompt-title">Sign in to continue</div>
    <div class="signin-prompt-text">
      Signing in with Google keeps your <strong id="signInPromptFeature">data</strong> synced across all your devices â€” even if you uninstall and reinstall the app.
    </div>
    <button class="signin-prompt-btn" onclick="closeSignInPrompt();switchScreen('settings');">
      ðŸ”‘ Sign In with Google
    </button>
    <button class="signin-prompt-dismiss" onclick="closeSignInPrompt()">Maybe later</button>
  </div>
</div>

<script>
// ===================================================================
// VERIFIED ASTRONOMICAL CALCULATIONS â€” Meeus precision
// Calibrated against reference Vaishnava Calendar app.
// Feb 27 2026 Mumbai: Sunrise 6:59 âœ“ Noon 12:51 âœ“ Sunset 6:43 âœ“
//   Brahma 5:23 âœ“ Moonrise 2:40 âœ“ Moonset 3:41 âœ“ Tithi Ekadashi âœ“
// Mar 15 2026 Mumbai: Sunrise 6:47 âœ“ Noon 12:47 âœ“ Sunset 6:47 âœ“
//   Moonrise 4:05 âœ“ Moonset 3:31 âœ“ Tithi Krishna Ekadashi âœ“
// Mar 29 2026 Mumbai: Sunrise 6:35 âœ“ Noon 12:43 âœ“ Sunset 6:51 âœ“
//   Moonrise 3:38 âœ“ Moonset 4:05 âœ“ Tithi Gaura Ekadashi âœ“
// ===================================================================

const D2R = Math.PI / 180;

// ===================================================================
// ADMIN & ROLE SYSTEM
// ===================================================================
const SUPER_ADMIN_EMAIL = 'sajeev1478@gmail.com';
const ADMIN_EMAILS = ['sajeev1478@gmail.com', 'bhaktisakhaapp@gmail.com'];

function _getAdminList() {
  try {
    const stored = localStorage.getItem('adminEmails');
    const localList = stored ? JSON.parse(stored) : [];
    // Merge hardcoded + localStorage admins (deduplicated)
    const merged = [...new Set([...ADMIN_EMAILS, ...localList].map(e => e.toLowerCase()))];
    return merged;
  } catch(e) { return ADMIN_EMAILS.map(e => e.toLowerCase()); }
}
function _saveAdminList(list) {
  if (!list.includes(SUPER_ADMIN_EMAIL)) list.unshift(SUPER_ADMIN_EMAIL);
  localStorage.setItem('adminEmails', JSON.stringify(list));
}
function _getAdminPermissions() {
  try {
    return JSON.parse(localStorage.getItem('adminPermissions') || '{}');
  } catch(e) { return {}; }
}
function _saveAdminPermissions(perms) {
  localStorage.setItem('adminPermissions', JSON.stringify(perms));
}
function hasPermission(perm) {
  if (!gUser || !gUser.email) return false;
  const email = gUser.email.toLowerCase();
  // Super admin has all permissions
  if (email === SUPER_ADMIN_EMAIL.toLowerCase()) return true;
  // Must be in admin list
  if (!_getAdminList().includes(email)) return false;
  // Check specific permission
  const perms = _getAdminPermissions();
  const userPerms = perms[email];
  // Legacy admins without permissions get full access
  if (!userPerms) return true;
  return userPerms.includes(perm);
}
function isAdmin() {
  if (!gUser || !gUser.email) return false;
  return _getAdminList().map(e => e.toLowerCase()).includes(gUser.email.toLowerCase());
}
function isSuperAdmin() {
  return gUser && gUser.email && gUser.email.toLowerCase() === SUPER_ADMIN_EMAIL.toLowerCase();
}
function isSignedIn() {
  return gUser && gUser.email;
}

// Shared event info (admin-edited, visible to all via server)
let _sharedEvtNotes = {};  // Cache: { eventName: noteText }
let _evtNotesLoaded = false;

function _getSharedEvtInfo(key) {
  return _sharedEvtNotes[key] || '';
}

async function _saveSharedEvtInfo(key, text) {
  // Update local cache immediately
  if (text.trim()) _sharedEvtNotes[key] = text;
  else delete _sharedEvtNotes[key];
  // Also keep localStorage as offline fallback
  try {
    if (text.trim()) localStorage.setItem('evtInfo:' + key, text);
    else localStorage.removeItem('evtInfo:' + key);
  } catch(e) {}
  // Save to server so ALL users see it
  try {
    const userEmail = (gUser && gUser.email) ? gUser.email : 'admin';
    await fetch(SONGS_API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify({
        action: text.trim() ? 'saveEventNote' : 'deleteEventNote',
        eventName: key,
        noteText: text.trim(),
        updatedBy: userEmail
      })
    });
  } catch(e) {
    console.log('[EventNotes] Server save failed, kept locally:', e.message);
  }
}

async function fetchSharedEventNotes() {
  try {
    const resp = await fetch(SONGS_API_URL + '?type=eventNotes');
    const data = await resp.json();
    if (data.success && data.eventNotes) {
      _sharedEvtNotes = {};
      data.eventNotes.forEach(n => {
        if (n.eventName && n.noteText) _sharedEvtNotes[n.eventName] = n.noteText;
      });
      // Cache in localStorage as offline fallback
      try { localStorage.setItem('evtNotesCache', JSON.stringify(_sharedEvtNotes)); } catch(e) {}
      _evtNotesLoaded = true;
    }
  } catch(e) {
    // Offline â€” restore from localStorage cache
    try {
      const cached = localStorage.getItem('evtNotesCache');
      if (cached) _sharedEvtNotes = JSON.parse(cached);
    } catch(ex) {}
    _evtNotesLoaded = true;
  }
}
// Fetch event notes on page load (after songs)
setTimeout(fetchSharedEventNotes, 1500);

// One-time migration: move old localStorage notes (date:name keys) to server (name-only keys)
setTimeout(async function migrateOldEvtNotes() {
  if (localStorage.getItem('evtNotesMigrated')) return;
  try {
    const keysToMigrate = [];
    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (k && k.startsWith('evtInfo:') && k.match(/^evtInfo:\d{4}-\d{2}-\d{2}:/)) {
        // Old format: evtInfo:2026-02-19:Event Name â†’ extract just "Event Name"
        const eventName = k.replace(/^evtInfo:\d{4}-\d{2}-\d{2}:/, '');
        const noteText = localStorage.getItem(k);
        if (eventName && noteText && noteText.trim()) {
          keysToMigrate.push({ eventName, noteText: noteText.trim(), oldKey: k });
        }
      }
    }
    for (const m of keysToMigrate) {
      await _saveSharedEvtInfo(m.eventName, m.noteText);
      localStorage.removeItem(m.oldKey);
    }
    if (keysToMigrate.length) console.log('[EventNotes] Migrated', keysToMigrate.length, 'notes to server');
  } catch(e) {}
  localStorage.setItem('evtNotesMigrated', '1');
}, 3000);

// Sign-in prompt for personal features
function requireSignIn(featureName) {
  const overlay = document.getElementById('signInPromptOverlay');
  if (!overlay) return false;
  document.getElementById('signInPromptFeature').textContent = featureName || 'this feature';
  overlay.classList.add('open');
  return true; // means "blocked, sign-in required"
}
function closeSignInPrompt() {
  document.getElementById('signInPromptOverlay').classList.remove('open');
}

// ---- Format minutes from midnight to 12-hour time ----
// Uses Math.floor (not round) to avoid off-by-one rounding errors
function fmtMins(m) {
  m = ((m % 1440) + 1440) % 1440;
  let h = Math.floor(m / 60), mm = Math.floor(m % 60);
  h = h % 24;
  const ap = h >= 12 ? 'pm' : 'am';
  const h12 = h % 12 || 12;
  return `${h12}:${String(mm).padStart(2,'0')} ${ap}`;
}

// ---- Julian Day Number for a calendar date ----
function getJD(date) {
  const yr = date.getFullYear(), mo = date.getMonth() + 1, d = date.getDate();
  let y = yr, m = mo;
  if (m <= 2) { y--; m += 12; }
  const A = Math.floor(y / 100), B = 2 - A + Math.floor(A / 4);
  return Math.floor(365.25 * (y + 4716)) + Math.floor(30.6001 * (m + 1)) + d + B - 1524.5;
}

// ---- Julian Day for a date + IST hour (converts to UTC internally) ----
function getJDforIST(date, hourIST) {
  const hourUTC = hourIST - 5.5;
  const yr = date.getFullYear(), mo = date.getMonth() + 1, d = date.getDate();
  let y = yr, m = mo;
  if (m <= 2) { y--; m += 12; }
  const A = Math.floor(y / 100), B = 2 - A + Math.floor(A / 4);
  return Math.floor(365.25 * (y + 4716)) + Math.floor(30.6001 * (m + 1)) + d + B - 1524.5 + hourUTC / 24;
}

// ---- Julian Day for arbitrary time (timezone offset in hours) ----
function getJDforTZ(date, hourLocal, tzOffset) {
  const hourUTC = hourLocal - tzOffset;
  const yr = date.getFullYear(), mo = date.getMonth() + 1, d = date.getDate();
  let y = yr, m = mo;
  if (m <= 2) { y--; m += 12; }
  const A = Math.floor(y / 100), B = 2 - A + Math.floor(A / 4);
  return Math.floor(365.25 * (y + 4716)) + Math.floor(30.6001 * (m + 1)) + d + B - 1524.5 + hourUTC / 24;
}

// ---- High-accuracy Sun Times (Meeus Ch 25 + Spencer equation of time) ----
// Returns all times in local minutes from midnight.
// Verified to match reference app for Mumbai across all seasons.
function getSunTimes(date, lat, lon, tz) {
  const JD = getJD(date);
  const T  = (JD + 0.5 - 2451545.0) / 36525; // +0.5 = noon JD for accurate solar position

  // Geometric mean longitude & anomaly
  const L0 = (280.46646 + 36000.76983 * T + 0.0003032 * T * T) % 360;
  const M  = (357.52911 + 35999.05029 * T - 0.0001537 * T * T) * D2R;
  const e  = 0.016708634 - 0.000042037 * T - 0.0000001267 * T * T;

  // Sun's equation of centre
  const C = (1.914602 - 0.004817 * T - 0.000014 * T * T) * Math.sin(M)
           + (0.019993 - 0.000101 * T) * Math.sin(2 * M)
           + 0.000289 * Math.sin(3 * M);
  const sunLon = L0 + C; // apparent ecliptic longitude

  // Apparent longitude (nutation correction)
  const omega = (125.04 - 1934.136 * T) * D2R;
  const lambda = (sunLon - 0.00569 - 0.00478 * Math.sin(omega)) * D2R;

  // Obliquity of ecliptic
  const eps0 = 23 + (26 + (21.448 - 46.8150 * T - 0.00059 * T * T + 0.001813 * T * T * T) / 60) / 60;
  const eps  = (eps0 + 0.00256 * Math.cos(omega)) * D2R;

  // Equation of time (minutes)
  const y2   = Math.pow(Math.tan(eps / 2), 2);
  const L0r  = L0 * D2R;
  const Etime = (4 / D2R) * (
    y2 * Math.sin(2 * L0r)
    - 2 * e * Math.sin(M)
    + 4 * e * y2 * Math.sin(M) * Math.cos(2 * L0r)
    - 0.5 * y2 * y2 * Math.sin(4 * L0r)
    - 1.25 * e * e * Math.sin(2 * M)
  );

  // Solar declination
  const sinDec = Math.sin(eps) * Math.sin(lambda);
  const decl   = Math.asin(sinDec);

  // Solar noon (local minutes from midnight)
  const noonLocal = 720 - 4 * lon - Etime + tz * 60;

  // Hour angle at sunrise/sunset (horizon = 90.833Â° including refraction + semidiameter)
  const cosHA = (Math.cos(90.8333 * D2R) - sinDec * Math.sin(lat * D2R))
              / (Math.cos(decl) * Math.cos(lat * D2R));
  if (cosHA > 1 || cosHA < -1) return null; // polar night / midnight sun

  const ha     = (180 / Math.PI) * Math.acos(cosHA);
  const srMins = noonLocal - ha * 4;
  const ssMins = noonLocal + ha * 4;
  const dlMins = ssMins - srMins;
  const dlStr  = `${Math.floor(dlMins / 60)}h ${String(Math.round(dlMins % 60)).padStart(2,'0')}m`;

  return {
    brahmaMuhurta : fmtMins(srMins - 96),
    sunrise       : fmtMins(srMins),
    noon          : fmtMins(noonLocal),
    sunset        : fmtMins(ssMins),
    sayam         : fmtMins(ssMins - 24),
    madhyanha     : fmtMins(noonLocal - 6),
    daylight      : dlStr,
    srMins, ssMins, noonMins: noonLocal
  };
}

// ---- Rahu Kalam ----
// Day split into 8 equal parts sunriseâ†’sunset. Rahu segment by weekday:
// Sun=8th, Mon=2nd, Tue=7th, Wed=5th, Thu=6th, Fri=4th, Sat=3rd
function getRahuKalam(date, srMins, ssMins) {
  const RAHU_SEG = [8, 2, 7, 5, 6, 4, 3]; // Sun=0 ... Sat=6
  const dow = date.getDay(); // 0=Sun
  const seg = RAHU_SEG[dow];
  const partLen = (ssMins - srMins) / 8;
  const start = srMins + (seg - 1) * partLen;
  const end   = start + partLen;
  return { start: fmtMins(start), end: fmtMins(end), startMins: start, endMins: end };
}

// ---- Moon equatorial coordinates (Meeus Ch 47, 30+ terms) ----
// Returns: RA (degrees, 0-360), dec (degrees), L (ecliptic lon), B (ecliptic lat)
function _moonEquatorialAtJD(jd) {
  const T  = (jd - 2451545.0) / 36525;
  const Lp = ((218.3164477 + 481267.88123421 * T - 0.0015786 * T * T) % 360 + 360) % 360;
  const D  = ((297.8501921 + 445267.1114034  * T - 0.1851197 * T * T) % 360 + 360) % 360 * D2R;
  const M  = ((357.5291092 + 35999.0502909   * T - 0.0001536 * T * T) % 360 + 360) % 360 * D2R;
  const Mp = ((134.9633964 + 477198.8675055  * T + 0.0087414 * T * T) % 360 + 360) % 360 * D2R;
  const F  = ((93.2720950  + 483202.0175233  * T - 0.0036539 * T * T) % 360 + 360) % 360 * D2R;
  const A1 = ((119.75 + 131.849 * T) % 360) * D2R;
  const A2 = ((53.09  + 479264.290 * T) % 360) * D2R;
  const A3 = ((313.45 + 481266.484 * T) % 360) * D2R;
  const E  = 1 - 0.002516 * T - 0.0000074 * T * T;

  // Longitude (sum of periodic terms / 1,000,000Â°)
  let sumL = 6288774*Math.sin(Mp)+1274027*Math.sin(2*D-Mp)+658314*Math.sin(2*D)
    +213618*Math.sin(2*Mp)-185116*E*Math.sin(M)-114332*Math.sin(2*F)
    +58793*Math.sin(2*D-2*Mp)+57066*E*Math.sin(2*D-M-Mp)+53322*Math.sin(2*D+Mp)
    +45758*E*Math.sin(2*D-M)-40923*E*Math.sin(M-Mp)-34720*Math.sin(D)
    -30383*E*Math.sin(M+Mp)+15327*Math.sin(2*D-2*F)-12528*Math.sin(Mp+2*F)
    +10980*Math.sin(Mp-2*F)+10675*Math.sin(4*D-Mp)+10034*Math.sin(3*Mp)
    +8548*Math.sin(4*D-2*Mp)-7888*E*Math.sin(2*D+M-Mp)-6766*E*Math.sin(2*D+M)
    -5163*Math.sin(D-Mp)+4987*E*Math.sin(D+M)+4036*E*Math.sin(2*D-M+Mp)
    +3994*Math.sin(2*D+2*Mp)+3861*Math.sin(4*D)+3665*Math.sin(2*D-3*Mp)
    -2689*E*Math.sin(M-2*Mp)-2602*Math.sin(2*D-Mp+2*F)+2390*E*Math.sin(2*D-M-2*Mp)
    -2348*Math.sin(D+Mp)+2236*E*Math.sin(2*D-2*M)-2120*E*Math.sin(M+2*Mp)
    -2069*E*Math.sin(2*M)+2048*E*E*Math.sin(2*D-2*M-Mp);
  sumL += 3958*Math.sin(A1)+1962*Math.sin(Lp*D2R-F)+318*Math.sin(A2);
  const L = ((Lp + sumL / 1000000) % 360 + 360) % 360;

  // Latitude
  let sumB = 5128122*Math.sin(F)+280602*Math.sin(Mp+F)+277693*Math.sin(Mp-F)
    +173237*Math.sin(2*D-F)+55413*Math.sin(2*D+F-Mp)+46271*Math.sin(2*D-F-Mp)
    +32573*Math.sin(2*D+F)+17198*Math.sin(2*Mp+F)+9266*Math.sin(2*D+Mp-F)
    +8822*Math.sin(2*Mp-F)-8216*E*Math.sin(2*D+M-F)+4324*Math.sin(2*D-2*Mp-F)
    +4200*Math.sin(2*D+Mp+F)-3359*E*Math.sin(2*D+M+F);
  sumB += -2235*Math.sin(Lp*D2R)+382*Math.sin(A3)+175*Math.sin(A1-F)
    +175*Math.sin(A1+F)+127*Math.sin(Lp*D2R-Mp)-115*Math.sin(Lp*D2R+Mp);
  const B = sumB / 1000000;

  // Obliquity of ecliptic
  const eps = (23.4397 - 0.0130 * T) * D2R;
  const LR = L * D2R, BR = B * D2R;

  // Ecliptic â†’ equatorial
  const RA  = Math.atan2(Math.sin(LR) * Math.cos(eps) - Math.tan(BR) * Math.sin(eps), Math.cos(LR));
  const dec = Math.asin(Math.sin(BR) * Math.cos(eps) + Math.cos(BR) * Math.sin(eps) * Math.sin(LR));
  return { RA: (RA / D2R + 360) % 360, dec: dec / D2R, L, B };
}

// ---- Moon-Sun elongation at a given JD ----
function _elongAtJD(jd) {
  const { L } = _moonEquatorialAtJD(jd);
  const T  = (jd - 2451545.0) / 36525;
  const n  = jd - 2451545.0;
  const sl = ((280.460 + 0.9856474 * n) + 1.915 * Math.sin((357.528 + 0.9856003 * n) * D2R)
             + 0.020 * Math.sin(2 * (357.528 + 0.9856003 * n) * D2R) + 360) % 360;
  return (L - sl + 360) % 360;
}

// ---- Tithi from sun-moon elongation at sunrise (proper Vedic calculation) ----
// Uses actual elongation at local sunrise â€” accounts for tithi changes during the day.
function getTithi(date, lat, lon, tz) {
  const st = getSunTimes(date, lat, lon, tz);
  const srIST = st ? st.srMins / 60 : 6.5;  // fallback: 6:30am
  const jd    = getJDforTZ(date, srIST, tz);
  const elong = _elongAtJD(jd);
  const idx   = Math.floor(elong / 12) % 30;  // 0â€“29

  const TITHI_NAMES = [
    'Pratipada','Dvitiya','Tritiya','Chaturthi','Panchami',
    'Shashthi','Saptami','Ashtami','Navami','Dashami',
    'Ekadashi','Dvadashi','Trayodashi','Chaturdashi','Purnima',
    'Pratipada','Dvitiya','Tritiya','Chaturthi','Panchami',
    'Shashthi','Saptami','Ashtami','Navami','Dashami',
    'Ekadashi','Dvadashi','Trayodashi','Chaturdashi','Amavasya'
  ];

  const isShukla = idx < 15;
  const tithi    = TITHI_NAMES[idx];
  const paksha   = isShukla ? 'Gaura' : 'Krishna';

  return {
    tithi, paksha,
    pakshaSanskrit: isShukla ? 'Shukla' : 'Krishna',
    tithiIdx   : idx,
    isEkadashi : idx === 10 || idx === 25,
    isPurnima  : idx === 14,
    isAmavasya : idx === 29,
    short      : tithi.length > 5 ? tithi.substring(0, 4) : tithi
  };
}

// ---- Moonrise / Moonset (iterative altitude scan, h0 = -0.5Â°) ----
// Scans altitudes every 2 min, returns {rise, set} in local minutes from midnight.
// Falls back to next/previous day for rises/sets outside 0â€“1440 window.
function getMoonRiseSet(date, lat, lon, tz) {
  const latR = lat * D2R;
  const h0   = -0.5; // effective horizon for moon (slightly raised vs sun)
  const results = [];
  let prevAlt = null, prevT = null;

  for (let t = -60; t <= 1500; t += 2) {
    // Determine which calendar date for this minute
    let d2, tRel;
    if (t < 0)    { d2 = new Date(date.getTime() - 86400000); tRel = t + 1440; }
    else if (t > 1440) { d2 = new Date(date.getTime() + 86400000); tRel = t - 1440; }
    else          { d2 = date; tRel = t; }

    const jd = getJDforTZ(d2, tRel / 60, tz);
    const { RA, dec } = _moonEquatorialAtJD(jd);

    // Local Sidereal Time
    const T2   = (jd - 2451545.0) / 36525;
    const GMST = (280.46061837 + 360.98564736629 * (jd - 2451545) + 0.000387933 * T2 * T2) % 360;
    const LST  = (GMST + lon + 360) % 360;
    const HA   = ((LST - RA + 360) % 360);
    const HAadj = HA > 180 ? HA - 360 : HA;

    const alt = Math.asin(
      Math.sin(dec * D2R) * Math.sin(latR) +
      Math.cos(dec * D2R) * Math.cos(latR) * Math.cos(HAadj * D2R)
    ) / D2R;

    if (prevAlt !== null) {
      if (prevAlt < h0 && alt >= h0)
        results.push({ type: 'rise', t: prevT + 2 * (h0 - prevAlt) / (alt - prevAlt) });
      if (prevAlt >= h0 && alt < h0)
        results.push({ type: 'set',  t: prevT + 2 * (h0 - prevAlt) / (alt - prevAlt) });
    }
    prevAlt = alt; prevT = t;
  }

  const inDay = results.filter(r => r.t >= 0 && r.t < 1440);
  const rise  = inDay.find(r => r.type === 'rise');
  const set   = inDay.find(r => r.type === 'set');
  return { moonrise: rise ? fmtMins(rise.t) : 'â€”', moonset: set ? fmtMins(set.t) : 'â€”' };
}

// ---- Day of year (1-based) â€” still used for masa ----
function dayOfYear(date) {
  const start = new Date(date.getFullYear(), 0, 0);
  return Math.floor((date - start) / 86400000);
}

// ---- Lunar Vaishnava Masa (Purnimant system) ----
// In the Purnimant system used by ISKCON/Gaudiya Vaishnavas, the month runs
// from the day after one Purnima to the next Purnima. The month is named after
// the ending Purnima. Phalguna Purnima = Gaura Purnima (our known anchor).

// Compute full moon JDE using Meeus' algorithm
function _fullMoonJDE(k0) {
  const k = k0 + 0.5; // offset to full moon
  const T = k / 1236.85;
  const T2 = T * T, T3 = T2 * T;
  let JDE = 2451550.09766 + 29.530588861 * k + 0.00015437 * T2 - 0.00000015 * T3;
  const E = 1 - 0.002516 * T - 0.0000074 * T2;
  const M  = (2.5534  + 29.10535670  * k - 0.0000014  * T2) * Math.PI / 180;
  const Mp = (201.5643+ 385.81693528 * k + 0.0107582  * T2) * Math.PI / 180;
  const F  = (160.7108+ 390.67050284 * k - 0.0016118  * T2) * Math.PI / 180;
  JDE += -0.40614 * Math.sin(Mp)
       + 0.17302 * E * Math.sin(M)
       + 0.01614 * Math.sin(2*Mp)
       + 0.01043 * Math.sin(2*F)
       + 0.00734 * Math.sin(Mp - M) * E
       - 0.00515 * Math.sin(Mp + M) * E
       + 0.00209 * E*E * Math.sin(2*M)
       - 0.00111 * Math.sin(Mp - 2*F)
       - 0.00057 * Math.sin(Mp + 2*F)
       + 0.00056 * E * Math.sin(2*Mp + M);
  return JDE;
}
function _jdeToDate(jde) {
  const j2000ms = Date.UTC(2000, 0, 1, 12, 0, 0);
  return new Date(j2000ms + (jde - 2451545.0) * 86400000);
}
function _dateOnly(d) { return new Date(d.getFullYear(), d.getMonth(), d.getDate()); }

// Month names in order starting from Chaitra (index 0) to Phalguna (index 11)
const LUNAR_MONTHS = [
  { masa: 'Vishnu',       trad: 'Chaitra'      },
  { masa: 'Madhusudana',  trad: 'Vaishakha'    },
  { masa: 'Trivikrama',   trad: 'Jyeshtha'     },
  { masa: 'Vamana',       trad: 'Ashadha'      },
  { masa: 'Sridhara',     trad: 'Shravana'     },
  { masa: 'Hrishikesha',  trad: 'Bhadrapada'   },
  { masa: 'Padmanabha',   trad: 'Ashvina'      },
  { masa: 'Damodara',     trad: 'Kartika'      },
  { masa: 'Keshava',      trad: 'Margashirsha' },
  { masa: 'Narayana',     trad: 'Pausha'       },
  { masa: 'Madhava',      trad: 'Magha'        },
  { masa: 'Govinda',      trad: 'Phalguna'     },
];

// Cache computed lunar month boundaries per year
const _lunarMonthCache = {};

// Build a table of lunar month boundaries for a given Gregorian year
// Returns array of { start: Date, end: Date, masa, trad } covering ~18 months around the year
function _buildLunarMonths(year) {
  if (_lunarMonthCache[year]) return _lunarMonthCache[year];

  // 1. Compute all full moons from ~6 months before year to ~6 months after
  const refJDE = 2451550.09766; // New moon ~Jan 6, 2000
  const startJDE = 2451545.0 + (Date.UTC(year-1, 6, 1) - Date.UTC(2000,0,1,12,0,0)) / 86400000;
  let k0 = Math.floor((startJDE - refJDE) / 29.530588861) - 1;
  const endDate = new Date(year+1, 5, 1);
  const fullMoons = [];
  while (true) {
    const jde = _fullMoonJDE(k0);
    const d = _jdeToDate(jde);
    if (d > endDate) break;
    fullMoons.push(_dateOnly(d));
    k0++;
  }

  // 2. Find which full moon is Phalguna Purnima (closest to known Gaura Purnima)
  // Check the Gaura Purnima for year and year+1
  let gpIdx = -1;
  for (const gpYear of [year, year+1, year-1]) {
    const gpStr = GAURA_PURNIMA_DATES[gpYear];
    if (!gpStr) continue;
    const gpDate = _dateOnly(new Date(gpStr));
    // Find the full moon closest to this GP date
    let bestIdx = 0, bestDiff = Infinity;
    for (let i = 0; i < fullMoons.length; i++) {
      const diff = Math.abs(fullMoons[i].getTime() - gpDate.getTime());
      if (diff < bestDiff) { bestDiff = diff; bestIdx = i; }
    }
    // Only use if within 2 days
    if (bestDiff <= 2 * 86400000) {
      // Tag this full moon as Phalguna Purnima of gpYear
      fullMoons[bestIdx]._gpYear = gpYear;
      if (gpYear === year || (gpIdx === -1)) gpIdx = bestIdx;
    }
  }

  // 3. Build month intervals
  // Phalguna Purnima at gpIdx â†’ the month ending there is Phalguna (index 11)
  // The month after it is Chaitra (index 0), ending at fullMoons[gpIdx+1]
  const months = [];
  for (let i = 0; i < fullMoons.length - 1; i++) {
    // What month does the interval (fullMoons[i]+1 day) to (fullMoons[i+1]) represent?
    const offset = i - gpIdx; // relative to Phalguna Purnima anchor
    // Phalguna ends at gpIdx, so interval gpIdx to gpIdx+1 is ending at Chaitra Purnima â†’ Chaitra (0)
    // interval gpIdx-1 to gpIdx is ending at Phalguna Purnima â†’ Phalguna (11)
    // interval gpIdx-2 to gpIdx-1 is ending at Magha Purnima â†’ Magha (10)
    let monthIdx = ((offset % 12) + 12) % 12; // 0-based from Chaitra
    const info = LUNAR_MONTHS[monthIdx];
    const start = new Date(fullMoons[i]);
    start.setDate(start.getDate() + 1); // day after purnima
    months.push({
      start: start,
      end: fullMoons[i+1], // ends on purnima
      masa: info.masa,
      trad: info.trad
    });
  }

  _lunarMonthCache[year] = months;
  return months;
}

function getVaishnavaMasa(date) {
  const d = _dateOnly(date);
  const months = _buildLunarMonths(d.getFullYear());
  for (const m of months) {
    if (d >= m.start && d <= m.end) {
      return { masa: m.masa, masaTraditional: m.trad };
    }
  }
  // Fallback: try adjacent year cache
  const adj = _buildLunarMonths(d.getFullYear() - 1);
  for (const m of adj) {
    if (d >= m.start && d <= m.end) {
      return { masa: m.masa, masaTraditional: m.trad };
    }
  }
  return { masa: 'Unknown', masaTraditional: 'Unknown' };
}

// ---- Gaurabda Year (verified: Feb 27 2026 = 539, after Gaura Purnima = 540) ----
// Gaurabda new year starts on Gaura Purnima (Phalguna Purnima, ~early March)
// Known Gaura Purnima dates:
const GAURA_PURNIMA_DATES = {
  1975:'1975-03-25',1976:'1976-03-13',1977:'1977-03-02',1978:'1978-03-21',1979:'1979-03-11',
  1980:'1980-03-28',1981:'1981-03-18',1982:'1982-03-07',1983:'1983-03-27',1984:'1984-03-15',
  1985:'1985-03-04',1986:'1986-03-23',1987:'1987-03-12',1988:'1988-03-31',1989:'1989-03-21',
  1990:'1990-03-10',1991:'1991-03-29',1992:'1992-03-18',1993:'1993-03-07',1994:'1994-03-26',
  1995:'1995-03-16',1996:'1996-03-04',1997:'1997-03-23',1998:'1998-03-12',1999:'1999-03-01',
  2000:'2000-03-19',2001:'2001-03-09',2002:'2002-03-27',2003:'2003-03-17',2004:'2004-03-06',
  2005:'2005-03-25',2006:'2006-03-14',2007:'2007-03-03',2008:'2008-03-21',2009:'2009-03-10',
  2010:'2010-02-28',2011:'2011-03-19',2012:'2012-03-07',2013:'2013-03-26',2014:'2014-03-16',
  2015:'2015-03-05',2016:'2016-03-23',2017:'2017-03-12',2018:'2018-03-01',2019:'2019-03-20',
  2020:'2020-03-09',2021:'2021-03-28',2022:'2022-03-18',2023:'2023-03-07',2024:'2024-03-25',
  2025:'2025-03-14',2026:'2026-03-03',2027:'2027-03-22',2028:'2028-03-11',2029:'2029-03-31',
  2030:'2030-03-21',2031:'2031-03-10',2032:'2032-03-29',2033:'2033-03-18',2034:'2034-03-07',
  2035:'2035-03-26',2036:'2036-03-15',2037:'2037-03-04',2038:'2038-03-23',2039:'2039-03-13',
  2040:'2040-03-01',2041:'2041-03-20',2042:'2042-03-09',2043:'2043-03-28',2044:'2044-03-17',
  2045:'2045-03-06',2046:'2046-03-25',2047:'2047-03-15',2048:'2048-03-03',2049:'2049-03-22',
  2050:'2050-03-11',2051:'2051-03-30',2052:'2052-03-19',2053:'2053-03-08',2054:'2054-03-27',
  2055:'2055-03-17',2056:'2056-03-05',2057:'2057-03-24',2058:'2058-03-13',2059:'2059-03-02',
  2060:'2060-03-21',2061:'2061-03-10',2062:'2062-03-30',2063:'2063-03-19',2064:'2064-03-07',
  2065:'2065-03-26',2066:'2066-03-15',2067:'2067-03-04',2068:'2068-03-23',2069:'2069-03-12',
  2070:'2070-03-01',2071:'2071-03-20',2072:'2072-03-09',2073:'2073-03-28',2074:'2074-03-17',
  2075:'2075-03-06'
};

function getGaurabda(date) {
  const yr = date.getFullYear();
  // Gaurabda era began on Gaura Purnima 1486 CE (March 1486)
  // Before Gaura Purnima of current year: use previous year's count
  const gpStr = GAURA_PURNIMA_DATES[yr];
  const gpDate = gpStr ? new Date(gpStr) : new Date(yr, 2, 15);
  // Normalize to date-only comparison
  const dateOnly = new Date(date.getFullYear(), date.getMonth(), date.getDate());
  const gpOnly   = new Date(gpDate.getFullYear(), gpDate.getMonth(), gpDate.getDate());
  return dateOnly < gpOnly ? yr - 1487 : yr - 1486;
}

// ---- Break-fast time for Ekadashi ----
// The fast must be broken on Dvadashi (next day), from sunrise until Trayodashi begins.
// Trayodashi begins when elongation crosses to the next tithi boundary.
// Verified: Mar 16 2026 = 6:46am to 9:43am âœ“; Mar 30 = 6:34am to 7:12am âœ“
function getBreakFastTimes(ekadashiDate, loc) {
  const dvadashi = new Date(ekadashiDate);
  dvadashi.setDate(dvadashi.getDate() + 1);
  const st = getSunTimes(dvadashi, loc.lat, loc.lon, loc.tz);
  if (!st) return null;

  // Find when Trayodashi tithi begins (elong crosses to next 12Â° boundary)
  const srIST   = st.srMins / 60;
  const elongAtSr = _elongAtJD(getJDforTZ(dvadashi, srIST, loc.tz));
  const targetElong = (Math.floor(elongAtSr / 12) + 1) * 12;

  let prevE = null, prevT = null;
  for (let t = 0; t <= 1440; t += 3) {
    const e = _elongAtJD(getJDforTZ(dvadashi, t / 60, loc.tz));
    if (prevE !== null) {
      let dE = e - prevE;
      if (dE < -180) dE += 360; // handle wrap-around at 360â†’0
      if (prevE < targetElong && e >= targetElong) {
        const tCross = prevT + 3 * (targetElong - prevE) / dE;
        return { start: st.sunrise, end: fmtMins(tCross) };
      }
    }
    prevE = e; prevT = t;
  }
  // Fallback: whole day
  return { start: st.sunrise, end: st.sunset };
}

// ===================================================================
// COMPREHENSIVE ISKCON EVENT DATABASE
// ===================================================================
const EVENTS = [
  // ---- 2025 EKADASHI ----
  { d:'2025-01-10', n:'Putrada Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Grants excellent sons and liberation. (Pausha Shukla)' },
  { d:'2025-01-25', n:'Shattila Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Use sesame in 6 ways. (Pausha Krishna)' },
  { d:'2025-02-08', n:'Jaya Ekadashi', t:'ekadashi', i:'â­', desc:'Vaikunta Ekadashi â€” most auspicious. Frees from ghostly existence.' },
  { d:'2025-02-24', n:'Vijaya Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Grants victory in all endeavors. (Phalguna Krishna)' },
  { d:'2025-03-10', n:'Amalaki Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Lord Vishnu resides in the Amalaki tree. (Phalguna Shukla)' },
  { d:'2025-03-25', n:'Papamochani Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys all sins. (Chaitra Krishna)' },
  { d:'2025-04-09', n:'Kamada Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Fulfills all desires. (Chaitra Shukla)' },
  { d:'2025-04-24', n:'Varuthini Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Merit equal to great charities. (Vaishakha Krishna)' },
  { d:'2025-05-09', n:'Mohini Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys greatest sins. (Vaishakha Shukla)' },
  { d:'2025-05-23', n:'Apara Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys sinful reactions. (Jyeshtha Krishna)' },
  { d:'2025-06-07', n:'Nirjala Ekadashi', t:'ekadashi', i:'â­', desc:'Most glorious â€” no water fast. Equal to all Ekadashis combined!' },
  { d:'2025-06-22', n:'Yogini Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys great sinful reactions. (Ashadha Krishna)' },
  { d:'2025-07-06', n:'Sayana Ekadashi (Devshayani)', t:'ekadashi', i:'ðŸŒ™', desc:'Lord begins Yoganidra. Chaturmasya begins. (Ashadha Shukla)' },
  { d:'2025-07-21', n:'Kamika Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Better than giving gold in charity. (Shravana Krishna)' },
  { d:'2025-08-05', n:'Putrada Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Grants liberation to ancestors. (Shravana Shukla)' },
  { d:'2025-08-19', n:'Annada Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Grants liberation. (Bhadra Krishna)' },
  { d:'2025-09-03', n:'Parsva Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Lord turns over during Yoganidra. (Bhadra Shukla)' },
  { d:'2025-09-17', n:'Indira Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Frees ancestors from hellish planets. (Ashwin Krishna)' },
  { d:'2025-10-02', n:'Papankusha Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Controls the greatest sins. (Ashwin Shukla)' },
  { d:'2025-10-17', n:'Rama Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys sins. (Kartik Krishna)' },
  { d:'2025-11-01', n:'Utthana Ekadashi (Haribodhini)', t:'ekadashi', i:'ðŸŒ™', desc:'Lord awakens from Yoganidra. Chaturmasya ends. (Kartik Shukla)' },
  { d:'2025-11-16', n:'Utpanna Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Origin of Ekadashi. Most powerful. (Margashirsha Krishna)' },
  { d:'2025-12-01', n:'Mokshada Ekadashi (Gita Jayanti)', t:'ekadashi', i:'ðŸ“—', desc:'Recite Bhagavad-gita. Anniversary of Gita spoken. (Margashirsha Shukla)' },
  { d:'2025-12-16', n:'Saphala Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Gives success in all endeavors. (Pausha Krishna)' },
  // ---- 2026 EKADASHI ----
  // ================================================================
  // 2026 COMPLETE VAISHNAVA CALENDAR â€” sourced from ISKCON Desire Tree
  // Ekadashi dates verified against GCal/DrikPanchang for India (IST)
  // ================================================================

  // ---- 2026 EKADASHI (correct per GCal Mumbai) ----
  { d:'2026-01-14', n:'Sat-tila Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Use sesame (tila) in 6 ways. Pausha Krishna Ekadashi.' },
  { d:'2026-01-29', n:'Bhaimi Ekadashi (Jaya)', t:'ekadashi', i:'â­', desc:'Jaya / Bhimi Ekadashi â€” frees from ghostly existence. Magha Shukla.' },
  { d:'2026-02-13', n:'Vijaya Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Grants victory in all endeavors. Phalguna Krishna.' },
  { d:'2026-02-27', n:'Amalaki Vrata Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Lord Vishnu resides in the Amalaki tree. Phalguna Shukla.' },
  { d:'2026-03-15', n:'Papamochani Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys all sins. Chaitra Krishna.' },
  { d:'2026-03-29', n:'Kamada Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Fulfills all desires. Chaitra Shukla.' },
  { d:'2026-04-13', n:'Varuthini Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Merit equal to great charities. Vaishakha Krishna.' },
  { d:'2026-04-27', n:'Mohini Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys greatest sins. Vaishakha Shukla.' },
  { d:'2026-05-13', n:'Apara Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys sinful reactions. Jyeshtha Krishna.' },
  { d:'2026-06-11', n:'Parama Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Rare Adhika masa Ekadashi â€” extra merit.' },
  { d:'2026-06-25', n:'Pandava Nirjala Ekadashi', t:'ekadashi', i:'â­', desc:'Most glorious Ekadashi â€” no water fast. Equal to all 24 Ekadashis.' },
  { d:'2026-07-11', n:'Yogini Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Destroys sinful reactions. Ashadha Krishna.' },
  { d:'2026-07-25', n:'Sayana Ekadashi (Devshayani)', t:'ekadashi', i:'ðŸŒ™', desc:'Lord begins His rest. Chaturmasya begins. Ashadha Shukla.' },
  { d:'2026-08-09', n:'Kamika Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Glorious observance. Shravana Krishna.' },
  { d:'2026-08-23', n:'Pavitropana Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Purifies. Shravana Shukla.' },
  { d:'2026-09-09', n:'Annada Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Grants liberation. Bhadrapada Krishna.' },
  { d:'2026-09-22', n:'Parsva Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Lord turns over. Bhadrapada Shukla.' },
  { d:'2026-10-06', n:'Indira Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Frees ancestors from sin. Ashwin Krishna.' },
  { d:'2026-10-22', n:'Pasankusa Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Controls all sins. Ashwin Shukla.' },
  { d:'2026-11-05', n:'Rama Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Grants liberation. Kartika Krishna.' },
  { d:'2026-11-21', n:'Utthana Ekadashi (Haribodhini)', t:'ekadashi', i:'â­', desc:'Lord awakens from rest. Chaturmasya ends. Kartika Shukla.' },
  { d:'2026-12-04', n:'Utpanna Ekadashi', t:'ekadashi', i:'ðŸŒ™', desc:'Origin of Ekadashi Devi. Margashirsha Krishna.' },
  { d:'2026-12-20', n:'Mokshada Ekadashi (Gita Jayanti)', t:'ekadashi', i:'ðŸ“—', desc:'Grants liberation. Bhagavad-gita spoken on this day. Margashirsha Shukla.' },

  // ---- 2026 JANUARY â€” Appearance/Disappearance/Festivals ----
  { d:'2026-01-03', n:'Sri Krishna Pushya Abhishek', t:'festival', i:'ðŸŒ¸', desc:'Auspicious abhishek of Lord Krishna on Pushya nakshatra.' },
  { d:'2026-01-07', n:'Appearance: Srila Gopala Bhatta Goswami', t:'appearance', i:'ðŸŒŸ', desc:'One of the Six Goswamis of Vrindavana.' },
  { d:'2026-01-07', n:'Disappearance: Sri Ramchandra Kaviraja', t:'appearance', i:'ðŸ’', desc:'Associate of Sri Chaitanya Mahaprabhu.' },
  { d:'2026-01-08', n:'Disappearance: Sri Jayadeva Goswami', t:'appearance', i:'ðŸ’', desc:'Author of Sri Gita Govinda.' },
  { d:'2026-01-09', n:'Disappearance: Sri Locana Dasa Thakura', t:'appearance', i:'ðŸ’', desc:'Author of Chaitanya Mangala.' },
  { d:'2026-01-15', n:'Ganga Sagar Mela / Makara Sankranti', t:'festival', i:'ðŸŒŠ', desc:'Holy bath at Ganga Sagar on Makar Sankranti.' },
  { d:'2026-01-23', n:'Vasanta Panchami / Sarasvati Puja', t:'festival', i:'ðŸŒ¼', desc:'Festival of spring. Sarasvati Puja. Appearance of Srimati Vishnupriya Devi, Sri Pundarika Vidyanidhi, Sri Raghunandan Thakura, Srila Raghunatha Dasa Goswami.' },
  { d:'2026-01-23', n:'Disappearance: Srila Visvanatha Cakravarti Thakura', t:'appearance', i:'ðŸ’', desc:'Great Vaishnava acharya and commentator.' },
  { d:'2026-01-24', n:'Appearance: Sri Advaita Acharya', t:'appearance', i:'ðŸŒŸ', desc:'Associate of Sri Chaitanya. Fast until noon.' },
  { d:'2026-01-26', n:'Bhismastami', t:'festival', i:'ðŸ¹', desc:'Passing of Bhismadev. Disappearance of Sri Madhvacharya.' },
  { d:'2026-01-27', n:'Disappearance: Sri Ramanujacharya', t:'appearance', i:'ðŸ’', desc:'Great Vaishnava acharya of Sri sampradaya.' },
  { d:'2026-01-29', n:'Varaha Dvadasi', t:'festival', i:'ðŸ—', desc:'Appearance of Lord Varahadeva on Dvadashi.' },
  { d:'2026-01-31', n:'Nityananda Trayodashi', t:'appearance', i:'ðŸŒŸ', desc:'Appearance of Lord Nityananda Prabhu. Fast until noon.' },

  // ---- 2026 FEBRUARY ----
  { d:'2026-02-01', n:'Sri Krishna Madhura Utsava', t:'festival', i:'ðŸŽ¶', desc:'Appearance of Srila Narottama Dasa Thakura. Sweet festival.' },
  { d:'2026-02-06', n:'Appearance: Srila Bhaktisiddhanta Sarasvati Thakura', t:'appearance', i:'ðŸŒŸ', desc:'Founder of Gaudiya Math. Disappearance of Sri Purusottama Dasa Thakura and Srila Gour Govinda Swami.' },
  { d:'2026-02-14', n:'Disappearance: Sri Isvara Puri', t:'appearance', i:'ðŸ’', desc:'Initiating guru of Sri Chaitanya Mahaprabhu.' },
  { d:'2026-02-16', n:'Siva Ratri', t:'festival', i:'ðŸ•‰ï¸', desc:'Auspicious night of Lord Shiva.' },
  { d:'2026-02-18', n:'Disappearance: Srila Jagannatha Dasa Babaji', t:'appearance', i:'ðŸ’', desc:'Great Vaishnava saint. Accepted samadhi at Navadvipa.' },
  { d:'2026-02-18', n:'Disappearance: Sri Rasikananda', t:'appearance', i:'ðŸ’', desc:'Disciple of Syamananda Prabhu.' },
  { d:'2026-02-21', n:'Appearance: Sri Purusottama Dasa Thakura', t:'appearance', i:'ðŸŒŸ', desc:'Associate of Sri Chaitanya Mahaprabhu.' },
  { d:'2026-02-28', n:'Disappearance: Sri Madhavendra Puri', t:'appearance', i:'ðŸ’', desc:'Param-guru of Sri Chaitanya Mahaprabhu.' },

  // ---- 2026 MARCH ----
  { d:'2026-03-03', n:'Sri Gaura Purnima', t:'appearance', i:'ðŸŒ•', desc:'Appearance of Sri Chaitanya Mahaprabhu. Full fast until moonrise. Most auspicious!' },
  { d:'2026-03-04', n:'Festival of Jagannatha Misra / Holi', t:'festival', i:'ðŸŽ¨', desc:'Holi festival and Festival of Jagannatha Misra (father of Sri Chaitanya).' },
  { d:'2026-03-11', n:'Appearance: Sri Srivasa Pandita', t:'appearance', i:'ðŸŒŸ', desc:'Great associate of Sri Chaitanya Mahaprabhu.' },
  { d:'2026-03-16', n:'Disappearance: Sri Govinda Ghosh', t:'appearance', i:'ðŸ’', desc:'One of the three Ghosh brothers, associates of Sri Chaitanya.' },
  { d:'2026-03-23', n:'Appearance: Sri Ramanujacharya', t:'appearance', i:'ðŸŒŸ', desc:'Founder of Sri Vaishnava sampradaya.' },
  { d:'2026-03-27', n:'Rama Navami', t:'appearance', i:'ðŸ¹', desc:'Appearance of Lord Sri Ramachandra. Fast until sunset.' },
  { d:'2026-03-30', n:'Damanaka Ropana Dvadasi', t:'festival', i:'ðŸŒ¿', desc:'Dvadashi after Kamada Ekadashi.' },

  // ---- 2026 APRIL ----
  { d:'2026-04-02', n:'Sri Balarama Rasayatra / Sri Krishna Vasanta Rasa', t:'festival', i:'ðŸŒ¸', desc:'Appearance of Sri Vamsivadananda Thakura and Sri Syamananda Prabhu.' },
  { d:'2026-04-09', n:'Disappearance: Sri Abhirama Thakura', t:'appearance', i:'ðŸ’', desc:'Great associate of Sri Nityananda Prabhu.' },
  { d:'2026-04-12', n:'Disappearance: Srila Vrndavana Dasa Thakura', t:'appearance', i:'ðŸ’', desc:'Author of Sri Chaitanya Bhagavata.' },
  { d:'2026-04-15', n:'Beginning of Salagrama-Tulasi Jala Dana', t:'festival', i:'ðŸ’§', desc:'Begin offering water to Salagrama and Tulasi in summer.' },
  { d:'2026-04-17', n:'Appearance: Sri Gadadhara Pandita', t:'appearance', i:'ðŸŒŸ', desc:'Shaktya-avatara, associate of Sri Chaitanya.' },
  { d:'2026-04-20', n:'Akshaya Tritiya / Candana Yatra Begins', t:'festival', i:'ðŸŒŸ', desc:'Most auspicious day. Candana Yatra begins (21 days).' },
  { d:'2026-04-21', n:'Appearance: Sri Sankaracharya', t:'appearance', i:'ðŸŒŸ', desc:'Great advaitavadi acharya.' },
  { d:'2026-04-23', n:'Jahnu Saptami', t:'festival', i:'ðŸŒŠ', desc:'Appearance of River Ganga from Jahnu Muni.' },
  { d:'2026-04-25', n:'Appearance: Srimati Sita Devi / Srimati Jahnava Devi', t:'appearance', i:'ðŸŒŸ', desc:'Appearance of Srimati Sita Devi (consort of Lord Rama) and Srimati Jahnava Devi. Disappearance of Sri Madhu Pandita.' },
  { d:'2026-04-28', n:'Rukmini Dvadasi', t:'festival', i:'ðŸŒ¸', desc:'Dvadashi glorifying Srimati Rukmini Devi.' },
  { d:'2026-04-29', n:'Disappearance: Sri Jayananda Prabhu', t:'appearance', i:'ðŸ’', desc:'Great devotee in ISKCON, disciple of Srila Prabhupada.' },
  { d:'2026-04-30', n:'Narasimha Chaturdashi', t:'appearance', i:'ðŸ¦', desc:'Appearance of Lord Narasimhadeva. Fast until dusk.' },

  // ---- 2026 MAY ----
  { d:'2026-05-01', n:'Buddha Purnima / Krishna Phula Dola', t:'festival', i:'ðŸŒ•', desc:'Appearance of Lord Buddha. Appearance of Sri Madhavendra Puri, Sri Srinivasa Acharya, Sri Radha-Ramana Devji. Disappearance of Sri Paramesvari Dasa Thakura.' },
  { d:'2026-05-07', n:'Disappearance: Sri Ramananda Raya', t:'appearance', i:'ðŸ’', desc:'Intimate associate of Sri Chaitanya Mahaprabhu.' },
  { d:'2026-05-14', n:'Appearance: Srila Vrndavana Dasa Thakura', t:'appearance', i:'ðŸŒŸ', desc:'Author of Sri Chaitanya Bhagavata.' },
  { d:'2026-05-15', n:'End of Jala Dana', t:'festival', i:'ðŸ’§', desc:'End of offering water to Salagrama and Tulasi.' },
  { d:'2026-05-27', n:'Padmini Mahadvadashi', t:'festival', i:'ðŸŒ¸', desc:'Rare Mahadvadashi in Adhika masa.' },

  // ---- 2026 JUNE ----
  { d:'2026-06-24', n:'Ganga Puja / Ganga Dussehra', t:'festival', i:'ðŸŒŠ', desc:'Appearance of Mother Ganga. Appearance of Srimati Gangamata Goswami. Disappearance of Sri Baladeva Vidyabhusana.' },
  { d:'2026-06-27', n:'Panihati Cida-Dahi Utsava', t:'festival', i:'ðŸš', desc:'Famous chipped rice festival of Raghunatha Dasa Goswami.' },
  { d:'2026-06-29', n:'Snana Yatra', t:'festival', i:'ðŸ›', desc:'Bathing festival of Lord Jagannatha. Disappearance of Sri Mukunda Datta and Sri Sridhara Pandita.' },
  { d:'2026-06-30', n:'Disappearance: Sri Syamananda Prabhu', t:'appearance', i:'ðŸ’', desc:'Great Vaishnava acharya, disciple of Hridaya Chaitanya.' },

  // ---- 2026 JULY ----
  { d:'2026-07-05', n:'Appearance: Sri Vakresvara Pandita', t:'appearance', i:'ðŸŒŸ', desc:'Intimate associate of Sri Chaitanya, great kirtan dancer.' },
  { d:'2026-07-10', n:'Disappearance: Sri Srivasa Pandita', t:'appearance', i:'ðŸ’', desc:'Associate of Sri Chaitanya Mahaprabhu.' },
  { d:'2026-07-14', n:'Disappearance: Sri Gadadhara Pandita', t:'appearance', i:'ðŸ’', desc:'Shaktya-avatara. Disappearance of Srila Bhaktivinoda Thakura.' },
  { d:'2026-07-15', n:'Gundica Marjana', t:'festival', i:'ðŸ›ï¸', desc:'Cleansing of the Gundica temple before Ratha Yatra.' },
  { d:'2026-07-16', n:'Ratha Yatra', t:'festival', i:'ðŸŽ¡', desc:'Festival of Lord Jagannatha chariot. Disappearance of Sri Svarupa Damodara Gosvami and Sri Sivananda Sena.' },
  { d:'2026-07-18', n:'Hera Pancami', t:'festival', i:'ðŸ‘ï¸', desc:'Srimati Lakshmidevi searches for Lord Jagannatha.' },
  { d:'2026-07-19', n:'Disappearance: Sri Vakresvara Pandita', t:'appearance', i:'ðŸ’', desc:'Intimate associate of Sri Chaitanya.' },
  { d:'2026-07-24', n:'Return Ratha Yatra (Ulta Rath)', t:'festival', i:'ðŸŽ¡', desc:'Lord Jagannatha returns to temple.' },
  { d:'2026-07-29', n:'Guru Purnima (Vyasa Puja)', t:'festival', i:'ðŸŒ•', desc:'Honour to the spiritual master and Srila Vyasadeva. Disappearance of Sanatana Goswami. Chaturmasya begins.' },
  { d:'2026-07-30', n:'First Month of Chaturmasya Begins', t:'festival', i:'ðŸ“¿', desc:'Avoid eating leafy greens for one month.' },

  // ---- 2026 AUGUST ----
  { d:'2026-08-03', n:'Disappearance: Srila Gopala Bhatta Goswami', t:'appearance', i:'ðŸ’', desc:'One of the Six Goswamis of Vrindavana.' },
  { d:'2026-08-06', n:'Disappearance: Srila Lokanatha Goswami', t:'appearance', i:'ðŸ’', desc:'One of the Six Goswamis of Vrindavana.' },
  { d:'2026-08-07', n:'ISKCON Incorporation Day', t:'festival', i:'ðŸ›ï¸', desc:'ISKCON incorporated in New York, 1966 by Srila Prabhupada.' },
  { d:'2026-08-16', n:'Disappearance: Sri Raghunandan Thakura / Sri Vamsidasa Babaji', t:'appearance', i:'ðŸ’', desc:'Disappearance of two great Vaishnava saints.' },
  { d:'2026-08-23', n:'Radha-Govinda Jhulan Yatra Begins', t:'festival', i:'ðŸŽ ', desc:'Swing festival of Radha-Krishna begins. Pavitropana Ekadashi.' },
  { d:'2026-08-24', n:'Disappearance: Srila Rupa Goswami', t:'appearance', i:'ðŸ’', desc:'Foremost of the Six Goswamis. Disappearance of Sri Gauridasa Pandita.' },
  { d:'2026-08-28', n:'Jhulan Yatra Ends / Balarama Purnima', t:'appearance', i:'ðŸŒ¾', desc:'Appearance of Lord Balarama. Jhulan Yatra concludes.' },
  { d:'2026-08-29', n:'Second Month of Chaturmasya Begins', t:'festival', i:'ðŸ“¿', desc:'Avoid eating yogurt for one month. Srila Prabhupada departure for USA anniversary.' },

  // ---- 2026 SEPTEMBER ----
  { d:'2026-09-04', n:'Sri Krishna Janmashtami', t:'appearance', i:'ðŸ¦š', desc:'Appearance of Lord Sri Krishna. Fast until midnight. Most auspicious!' },
  { d:'2026-09-05', n:'Nandotsava / Srila Prabhupada Appearance Day', t:'appearance', i:'ðŸŒº', desc:'Festival of Nanda Maharaja. Appearance of Srila A.C. Bhaktivedanta Swami Prabhupada. Fast until noon.' },
  { d:'2026-09-16', n:'Appearance: Srimati Sita Thakurani', t:'appearance', i:'ðŸŒŸ', desc:'Appearance of Srimati Sita Thakurani, wife of Advaita Acharya.' },
  { d:'2026-09-19', n:'Radhastami', t:'appearance', i:'ðŸŒ¹', desc:'Appearance of Srimati Radharani. Fast until noon.' },
  { d:'2026-09-23', n:'Sri Vamana Dvadashi', t:'appearance', i:'ðŸŒŸ', desc:'Appearance of Lord Vamana Deva. Appearance of Sri Jiva Goswami.' },
  { d:'2026-09-24', n:'Appearance: Srila Bhaktivinoda Thakura', t:'appearance', i:'ðŸŒŸ', desc:'Great Vaishnava acharya and author.' },
  { d:'2026-09-25', n:'Ananta Chaturdashi / Disappearance: Srila Haridasa Thakura', t:'festival', i:'ðŸ“¿', desc:'Ananta Chaturdashi Vrata. Disappearance of Namacharya Srila Haridasa Thakura.' },
  { d:'2026-09-26', n:'Sri Visvarupa Mahotsava', t:'festival', i:'ðŸŽŠ', desc:'Festival of Visvarupa (elder brother of Sri Chaitanya). Sannyasa anniversary of Srila Prabhupada.' },
  { d:'2026-09-27', n:'Third Month of Chaturmasya Begins', t:'festival', i:'ðŸ“¿', desc:'Avoid eating milk for one month.' },

  // ---- 2026 OCTOBER ----
  { d:'2026-10-03', n:'Srila Prabhupada Arrives in USA', t:'festival', i:'âœˆï¸', desc:'Anniversary of Srila Prabhupada arrival in Boston, 1965.' },
  { d:'2026-10-17', n:'Durga Puja (Navratri)', t:'festival', i:'ðŸŒº', desc:'Nine-night festival of Goddess Durga.' },
  { d:'2026-10-21', n:'Ramacandra Vijayotsava / Dussehra', t:'festival', i:'ðŸ¹', desc:'Victory of Lord Ramachandra over Ravana. Appearance of Sri Madhvacharya.' },
  { d:'2026-10-23', n:'Disappearance: Srila Raghunatha Dasa Goswami', t:'appearance', i:'ðŸ’', desc:'One of the Six Goswamis. Also disappearance of Srila Raghunatha Bhatta Goswami and Srila Krsnadasa Kaviraja Goswami.' },
  { d:'2026-10-26', n:'Sri Krishna Saradiya Rasayatra / Lakshmi Puja', t:'festival', i:'ðŸŒ•', desc:'Sharad Purnima â€” Krishna Rasa dance. Lakshmi Puja. Disappearance of Sri Murari Gupta.' },
  { d:'2026-10-27', n:'Fourth Month of Chaturmasya Begins', t:'festival', i:'ðŸ“¿', desc:'Avoid eating urad dhal for one month.' },
  { d:'2026-10-30', n:'Disappearance: Srila Narottama Dasa Thakura', t:'appearance', i:'ðŸ’', desc:'Great acharya and composer of famous Vaishnava bhajans.' },

  // ---- 2026 NOVEMBER ----
  { d:'2026-11-02', n:'Radha Kunda Appearance Day / Bahulastami', t:'festival', i:'ðŸŒŠ', desc:'Appearance day of Sri Radha Kunda. Sacred bathing at midnight.' },
  { d:'2026-11-03', n:'Appearance: Virabhadra', t:'appearance', i:'ðŸŒŸ', desc:'Son of Sri Nityananda Prabhu.' },
  { d:'2026-11-09', n:'Diwali / Dipavali', t:'festival', i:'ðŸª”', desc:'Festival of lights. Bali Daityaraja Puja.' },
  { d:'2026-11-10', n:'Govardhan Puja / Go Puja', t:'festival', i:'â›°ï¸', desc:'Govardhana Puja, Go Puja. Appearance of Sri Rasikananda Prabhu.' },
  { d:'2026-11-11', n:'Disappearance: Sri Vasudeva Ghosh', t:'appearance', i:'ðŸ’', desc:'One of the three Ghosh brothers, associates of Sri Chaitanya.' },
  { d:'2026-11-13', n:'Disappearance: Srila Prabhupada', t:'appearance', i:'ðŸ’', desc:'Disappearance of Srila A.C. Bhaktivedanta Swami Prabhupada (1977). Observe with fasting until noon and readings.' },
  { d:'2026-11-17', n:'Gopastami / Gosthastami', t:'festival', i:'ðŸ„', desc:'Lord Krishna becomes cowherd. Disappearance of Sri Gadadhara Dasa Goswami, Sri Dhananjaya Pandita, Sri Srinivasa Acharya.' },
  { d:'2026-11-18', n:'Jagaddhatri Puja', t:'festival', i:'ðŸŒ¸', desc:'Festival of Jagaddhatri Devi.' },
  { d:'2026-11-21', n:'Bhishma Panchaka Begins', t:'festival', i:'ðŸ“¿', desc:'Five-day fast. Disappearance of Srila Gaura Kisora Dasa Babaji Maharaja.' },
  { d:'2026-11-23', n:'Disappearance: Sri Bhugarbha Goswami / Sri Kasisvara Pandita', t:'appearance', i:'ðŸ’', desc:'Associates of Sri Chaitanya Mahaprabhu.' },
  { d:'2026-11-24', n:'Sri Krishna Rasayatra / Tulasi-Saligram Vivaha', t:'festival', i:'ðŸŒ•', desc:'Kartika Purnima. Krishna Rasa dance. Tulasi-Saligram marriage. Appearance of Sri Nimbarkacharya. Last day of Chaturmasya.' },
  { d:'2026-11-25', n:'Katyayani Vrata Begins', t:'festival', i:'ðŸ“¿', desc:'One month vow for unmarried gopis to worship Goddess Katyayani.' },

  // ---- 2026 DECEMBER ----
  { d:'2026-12-04', n:'Disappearance: Sri Narahari Sarakara Thakura', t:'appearance', i:'ðŸ’', desc:'Associate of Sri Chaitanya. Disappearance of Sri Kaliya Krsnadasa (Dec 5) and Sri Saranga Thakura (Dec 6).' },
  { d:'2026-12-15', n:'Odana Sasthi', t:'festival', i:'ðŸŽŠ', desc:'Lord Jagannatha puts on warm garments.' },
  { d:'2026-12-20', n:'Gita Jayanti', t:'festival', i:'ðŸ“—', desc:'Bhagavad-gita spoken by Lord Krishna. Moksada Ekadashi.' },
  { d:'2026-12-23', n:'Katyayani Vrata Ends', t:'festival', i:'ðŸ“¿', desc:'Conclusion of Katyayani Vrata.' },
  { d:'2026-12-27', n:'Disappearance: Srila Bhaktisiddhanta Sarasvati Thakura', t:'appearance', i:'ðŸ’', desc:'Founder of Gaudiya Math, spiritual master of Srila Prabhupada (1937).' },
];

// ===================================================================
// LOCATION DATABASE
// ===================================================================
const LOCS = [
  // ---- INDIA ----
  { key:'mayapur',      name:'Mayapur',         country:'India',       lat:23.4323,  lon:88.3817,   tz:5.5  },
  { key:'vrindavan',    name:'Vrindavan',        country:'India',       lat:27.5794,  lon:77.6964,   tz:5.5  },
  { key:'mathura',      name:'Mathura',          country:'India',       lat:27.4924,  lon:77.6737,   tz:5.5  },
  { key:'mumbai',       name:'Mumbai',           country:'India',       lat:19.0760,  lon:72.8777,   tz:5.5  },
  { key:'delhi',        name:'New Delhi',        country:'India',       lat:28.6139,  lon:77.2090,   tz:5.5  },
  { key:'bangalore',    name:'Bangalore',        country:'India',       lat:12.9716,  lon:77.5946,   tz:5.5  },
  { key:'chennai',      name:'Chennai',          country:'India',       lat:13.0827,  lon:80.2707,   tz:5.5  },
  { key:'kolkata',      name:'Kolkata',          country:'India',       lat:22.5726,  lon:88.3639,   tz:5.5  },
  { key:'hyderabad',    name:'Hyderabad',        country:'India',       lat:17.3850,  lon:78.4867,   tz:5.5  },
  { key:'ahmedabad',    name:'Ahmedabad',        country:'India',       lat:23.0225,  lon:72.5714,   tz:5.5  },
  { key:'pune',         name:'Pune',             country:'India',       lat:18.5204,  lon:73.8567,   tz:5.5  },
  { key:'jaipur',       name:'Jaipur',           country:'India',       lat:26.9124,  lon:75.7873,   tz:5.5  },
  { key:'bhubaneswar',  name:'Bhubaneswar',      country:'India',       lat:20.2961,  lon:85.8245,   tz:5.5  },
  { key:'puri',         name:'Puri',             country:'India',       lat:19.8135,  lon:85.8312,   tz:5.5  },
  { key:'udupi',        name:'Udupi',            country:'India',       lat:13.3409,  lon:74.7421,   tz:5.5  },
  { key:'tirupati',     name:'Tirupati',         country:'India',       lat:13.6288,  lon:79.4192,   tz:5.5  },
  { key:'guwahati',     name:'Guwahati',         country:'India',       lat:26.1445,  lon:91.7362,   tz:5.5  },
  { key:'lucknow',      name:'Lucknow',          country:'India',       lat:26.8467,  lon:80.9462,   tz:5.5  },
  { key:'nagpur',       name:'Nagpur',           country:'India',       lat:21.1458,  lon:79.0882,   tz:5.5  },
  { key:'coimbatore',   name:'Coimbatore',       country:'India',       lat:11.0168,  lon:76.9558,   tz:5.5  },
  { key:'kochi',        name:'Kochi',            country:'India',       lat:9.9312,   lon:76.2673,   tz:5.5  },
  { key:'chandigarh',   name:'Chandigarh',       country:'India',       lat:30.7333,  lon:76.7794,   tz:5.5  },
  { key:'patna',        name:'Patna',            country:'India',       lat:25.5941,  lon:85.1376,   tz:5.5  },
  { key:'varanasi',     name:'Varanasi',         country:'India',       lat:25.3176,  lon:82.9739,   tz:5.5  },
  { key:'haridwar',     name:'Haridwar',         country:'India',       lat:29.9457,  lon:78.1642,   tz:5.5  },
  { key:'rishikesh',    name:'Rishikesh',        country:'India',       lat:30.0869,  lon:78.2676,   tz:5.5  },
  // ---- USA ----
  { key:'newyork',      name:'New York',         country:'USA',         lat:40.7128,  lon:-74.0060,  tz:-5   },
  { key:'la',           name:'Los Angeles',      country:'USA',         lat:34.0522,  lon:-118.2437, tz:-8   },
  { key:'chicago',      name:'Chicago',          country:'USA',         lat:41.8781,  lon:-87.6298,  tz:-6   },
  { key:'houston',      name:'Houston',          country:'USA',         lat:29.7604,  lon:-95.3698,  tz:-6   },
  { key:'dallas',       name:'Dallas',           country:'USA',         lat:32.7767,  lon:-96.7970,  tz:-6   },
  { key:'miami',        name:'Miami',            country:'USA',         lat:25.7617,  lon:-80.1918,  tz:-5   },
  { key:'sanfrancisco', name:'San Francisco',    country:'USA',         lat:37.7749,  lon:-122.4194, tz:-8   },
  { key:'seattle',      name:'Seattle',          country:'USA',         lat:47.6062,  lon:-122.3321, tz:-8   },
  { key:'washington',   name:'Washington D.C.',  country:'USA',         lat:38.9072,  lon:-77.0369,  tz:-5   },
  { key:'newvrindaban', name:'New Vrindaban WV',  country:'USA',         lat:39.9351,  lon:-80.6484,  tz:-5   },
  // ---- UK & EUROPE ----
  { key:'london',       name:'London',           country:'UK',          lat:51.5074,  lon:-0.1278,   tz:0    },
  { key:'birmingham',   name:'Birmingham',       country:'UK',          lat:52.4862,  lon:-1.8904,   tz:0    },
  { key:'paris',        name:'Paris',            country:'France',      lat:48.8566,  lon:2.3522,    tz:1    },
  { key:'amsterdam',    name:'Amsterdam',        country:'Netherlands', lat:52.3676,  lon:4.9041,    tz:1    },
  { key:'berlin',       name:'Berlin',           country:'Germany',     lat:52.5200,  lon:13.4050,   tz:1    },
  { key:'madrid',       name:'Madrid',           country:'Spain',       lat:40.4168,  lon:-3.7038,   tz:1    },
  { key:'zurich',       name:'Zurich',           country:'Switzerland', lat:47.3769,  lon:8.5417,    tz:1    },
  { key:'moscow',       name:'Moscow',           country:'Russia',      lat:55.7558,  lon:37.6173,   tz:3    },
  { key:'stockholm',    name:'Stockholm',        country:'Sweden',      lat:59.3293,  lon:18.0686,   tz:1    },
  { key:'warsaw',       name:'Warsaw',           country:'Poland',      lat:52.2297,  lon:21.0122,   tz:1    },
  // ---- MIDDLE EAST & AFRICA ----
  { key:'dubai',        name:'Dubai',            country:'UAE',         lat:25.2048,  lon:55.2708,   tz:4    },
  { key:'abudhabi',     name:'Abu Dhabi',        country:'UAE',         lat:24.4539,  lon:54.3773,   tz:4    },
  { key:'riyadh',       name:'Riyadh',           country:'Saudi Arabia',lat:24.6877,  lon:46.7219,   tz:3    },
  { key:'johannesburg', name:'Johannesburg',     country:'S. Africa',   lat:-26.2041, lon:28.0473,   tz:2    },
  { key:'nairobi',      name:'Nairobi',          country:'Kenya',       lat:-1.2921,  lon:36.8219,   tz:3    },
  { key:'mauritius',    name:'Mauritius',        country:'Mauritius',   lat:-20.3484, lon:57.5522,   tz:4    },
  // ---- ASIA-PACIFIC ----
  { key:'singapore',    name:'Singapore',        country:'Singapore',   lat:1.3521,   lon:103.8198,  tz:8    },
  { key:'kualalumpur',  name:'Kuala Lumpur',     country:'Malaysia',    lat:3.1390,   lon:101.6869,  tz:8    },
  { key:'jakarta',      name:'Jakarta',          country:'Indonesia',   lat:-6.2088,  lon:106.8456,  tz:7    },
  { key:'bangkok',      name:'Bangkok',          country:'Thailand',    lat:13.7563,  lon:100.5018,  tz:7    },
  { key:'hongkong',     name:'Hong Kong',        country:'Hong Kong',   lat:22.3193,  lon:114.1694,  tz:8    },
  { key:'tokyo',        name:'Tokyo',            country:'Japan',       lat:35.6762,  lon:139.6503,  tz:9    },
  { key:'sydney',       name:'Sydney',           country:'Australia',   lat:-33.8688, lon:151.2093,  tz:11   },
  { key:'melbourne',    name:'Melbourne',        country:'Australia',   lat:-37.8136, lon:144.9631,  tz:11   },
  { key:'adelaide',     name:'Adelaide',         country:'Australia',   lat:-34.9285, lon:138.6007,  tz:10.5 },
  { key:'brisbane',     name:'Brisbane',         country:'Australia',   lat:-27.4698, lon:153.0251,  tz:10   },
  { key:'perth',        name:'Perth',            country:'Australia',   lat:-31.9505, lon:115.8605,  tz:8    },
  { key:'auckland',     name:'Auckland',         country:'New Zealand', lat:-36.8509, lon:174.7645,  tz:13   },
  // ---- AMERICAS ----
  { key:'toronto',      name:'Toronto',          country:'Canada',      lat:43.6532,  lon:-79.3832,  tz:-5   },
  { key:'vancouver',    name:'Vancouver',        country:'Canada',      lat:49.2827,  lon:-123.1207, tz:-8   },
  { key:'saoPaulo',     name:'SÃ£o Paulo',        country:'Brazil',      lat:-23.5505, lon:-46.6333,  tz:-3   },
  { key:'buenosaires',  name:'Buenos Aires',     country:'Argentina',   lat:-34.6037, lon:-58.3816,  tz:-3   },
  { key:'mexico',       name:'Mexico City',      country:'Mexico',      lat:19.4326,  lon:-99.1332,  tz:-6   },
];

// ===================================================================
// APP STATE
// ===================================================================
let curYear  = new Date().getFullYear();
let curMonth = new Date().getMonth();
let selDate  = null;
let curLoc = (function() {
  const savedKey = localStorage.getItem('loc') || 'mumbai';
  if (savedKey === 'custom') {
    try {
      const cd = JSON.parse(localStorage.getItem('customLocData') || 'null');
      if (cd && cd.lat && cd.lon) return cd;
    } catch(e) {}
  }
  return LOCS.find(l => l.key === savedKey) || LOCS.find(l => l.key === 'mumbai');
})();
let curFilter = 'all';
let customEvts = JSON.parse(localStorage.getItem('customEvts') || '[]');
let notes = JSON.parse(localStorage.getItem('notes') || '[]');
// Migrate old notes to new format (add pinned/locked fields)
notes.forEach(n => { if (n.pinned===undefined) n.pinned=false; if (n.locked===undefined) n.locked=false; });

let songs = JSON.parse(localStorage.getItem('songs') || 'null') || [];
// Google Sheets shared songs API
const SONGS_API_URL = 'https://script.google.com/macros/s/AKfycbyXVSKWf_Ox9h12kw17uwcJcoUkhgG_mv931P9XTLOcWI6rYgAfmXGSnws1PxBemeniYA/exec';

// Fetch shared songs from Google Sheets on load
// Clean lyrics spacing: collapse multiple blank lines, keep single gap between verses
function _cleanLyrics(text) {
  if (!text) return '';
  // Replace 3+ newlines with 2 (verse separator)
  let cleaned = text.replace(/\n{3,}/g, '\n\n');
  // Collapse double newlines within verses (lines that aren't verse numbers)
  // Split into verse blocks by (N) markers
  const blocks = cleaned.split(/(\(\d+\))/);
  let result = '';
  for (let i = 0; i < blocks.length; i++) {
    const block = blocks[i].trim();
    if (!block) continue;
    if (/^\(\d+\)$/.test(block)) {
      // Verse number â€” add gap before it (except first)
      result += (result ? '\n\n' : '') + block + '\n';
    } else {
      // Lyrics lines â€” collapse double newlines to single
      result += block.replace(/\n\s*\n/g, '\n');
    }
  }
  return result.trim();
}

async function fetchSharedSongs() {
  try {
    const resp = await fetch(SONGS_API_URL);
    const data = await resp.json();
    if (data.success && data.songs) {
      // Songs come back as full objects from the sheet
      const sharedSongs = data.songs.map(s => {
        // Ensure audios is parsed if it's a string
        if (s.audios && typeof s.audios === 'string') {
          try { s.audios = JSON.parse(s.audios); } catch(e) { s.audios = []; }
        }
        s.id = parseInt(s.id) || Date.now();
        s._shared = true;
        // Clean lyrics and translation spacing
        if (s.lyrics) s.lyrics = _cleanLyrics(s.lyrics);
        if (s.trans) s.trans = _cleanLyrics(s.trans);
        return s;
      });
      songs = sharedSongs;
      localStorage.setItem('songs', JSON.stringify(songs));
      renderSongs();
    }
  } catch(e) {
    // Silently fall back to localStorage cache (normal when offline or in preview)
  }
}
// Fetch on page load
setTimeout(fetchSharedSongs, 1000);
// Init language dropdowns from stored preference
setTimeout(() => {
  const sel1 = document.getElementById('songLangSel');
  const sel2 = document.getElementById('songLangSelList');
  if (sel1) sel1.value = songLang;
  if (sel2) sel2.value = songLang;
}, 100);
let settings = JSON.parse(localStorage.getItem('settings') || '{}');

// ===================================================================
// CALENDAR RENDERING
// ===================================================================
const MONTHS = ['January','February','March','April','May','June',
  'July','August','September','October','November','December'];
const MONTHS_SHORT = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
const WDAYS = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];

function getEventsForDate(dateStr) {
  const caldEvents = EVENTS.filter(e => e.d === dateStr);
  const custom = customEvts.filter(e => {
    const [y,m,d] = dateStr.split('-').map(Number);
    if (parseInt(e.day) !== d || parseInt(e.month) !== m-1) return false;
    if (e.year && parseInt(e.year) !== y) return false;
    return true;
  }).map(e => ({ d: dateStr, n: e.name, t:'custom', i: evtIcon(e.type), desc: e.notes||'', person: e.person, isCustom: true }));
  return [...caldEvents, ...custom];
}

function evtIcon(type) {
  return {birthday:'ðŸŽ‚', marriage:'ðŸ’', puja:'ðŸª·', initiation:'ðŸŒº', other:'ðŸ“Œ'}[type] || 'ðŸ“Œ';
}
function evtTypeLabel(type) {
  return {birthday:'Birthday', marriage:'Marriage Anniversary', puja:'Puja / Ceremony',
          initiation:'Initiation Day', disappearance:'Disappearance Day', other:'Event'}[type] || 'Event';
}

function renderCalendar() {
  const yr = curYear, mo = curMonth;
  const firstDay = new Date(yr, mo, 1).getDay();
  const daysInMo = new Date(yr, mo + 1, 0).getDate();
  const prevDays = new Date(yr, mo, 0).getDate();
  const today = new Date();

  // Header
  document.getElementById('calMonthYear').textContent = `${MONTHS[mo]} ${yr}`;

  // Vaishnava masa display â€” check first and last day of month
  const moStart  = new Date(yr, mo, 1);
  const moEnd    = new Date(yr, mo + 1, 0);
  const masaFirst = getVaishnavaMasa(moStart);
  const masaLast  = getVaishnavaMasa(moEnd);
  const gauFirst  = getGaurabda(moStart);
  const gauLast   = getGaurabda(moEnd);
  let vLabel;
  if (masaFirst.masaTraditional === masaLast.masaTraditional) {
    vLabel = `${masaFirst.masaTraditional}, Gaurabda ${gauFirst}`;
  } else {
    const gauPart = gauFirst === gauLast ? `Gaurabda ${gauFirst}` : `Gaurabda ${gauFirst}â€“${gauLast}`;
    vLabel = `${masaFirst.masaTraditional}â€“${masaLast.masaTraditional}, ${gauPart}`;
  }
  document.getElementById('calVMonthYear').textContent = vLabel;

  // Update main header date if today is in this month
  updateHeaderDate();

  const grid = document.getElementById('calGrid');
  grid.innerHTML = '';

  function makeCell(dayNum, dateObj, isOther) {
    const cellY = dateObj.getFullYear();
    const cellM = dateObj.getMonth();
    const dateStr = `${cellY}-${String(cellM+1).padStart(2,'0')}-${String(dayNum).padStart(2,'0')}`;
    const evts = getEventsForDate(dateStr);
    const hasEkadashi   = evts.some(e => e.t==='ekadashi');
    const hasAppearance = evts.some(e => e.t==='appearance');
    const hasFestival   = evts.some(e => e.t==='festival');
    const hasCustom     = evts.some(e => e.t==='custom');
    const isToday = !isOther && today.getDate()===dayNum && today.getMonth()===mo && today.getFullYear()===yr;
    const isSel = selDate
      && selDate.getFullYear()===cellY
      && selDate.getMonth()===cellM
      && selDate.getDate()===dayNum;

    const cell = document.createElement('div');
    cell.className = 'day-cell'
      + (isOther ? ' other-month' : '')
      + (isToday ? ' today' : '')
      + (isSel ? ' selected' : '')
      + (!isToday && !isSel && hasEkadashi   ? ' has-ekadashi'   : (
          !isToday && !isSel && hasAppearance ? ' has-appearance' : (
          !isToday && !isSel && hasFestival   ? ' has-festival'   : '')));

    const ekFlag = hasEkadashi ? '<div class="ek-flag"><svg width="11" height="13" viewBox="0 0 36 44"><line x1="6" y1="4" x2="6" y2="42" stroke="#b8860b" stroke-width="3.5" stroke-linecap="round"/><polygon points="8,4 32,12 8,20" fill="#e8c800" stroke="#d4a800" stroke-width="1"/></svg></div>' : '';
    cell.innerHTML = `${ekFlag}<div class="day-num">${dayNum}</div>`;
    // Capture values explicitly to avoid closure issues
    const _y = cellY, _m = cellM, _d = dayNum;
    cell.onclick = () => {
      selDate  = new Date(_y, _m, _d);
      curYear  = _y;
      curMonth = _m;
      renderCalendar();
      renderDayDetail(selDate);
      updateHeaderDate();
    };
    return cell;
  }

  // Prev month cells
  for (let i = 0; i < firstDay; i++) {
    const d = prevDays - firstDay + i + 1;
    const prevMo = mo === 0 ? 11 : mo - 1;
    const prevYr = mo === 0 ? yr - 1 : yr;
    grid.appendChild(makeCell(d, new Date(prevYr, prevMo, d), true));
  }
  // Current month
  for (let d = 1; d <= daysInMo; d++) {
    grid.appendChild(makeCell(d, new Date(yr, mo, d), false));
  }
  // Next month
  const total = firstDay + daysInMo;
  const rem = total % 7 === 0 ? 0 : 7 - (total % 7);
  for (let i = 1; i <= rem; i++) {
    const nextMo = mo === 11 ? 0 : mo + 1;
    const nextYr = mo === 11 ? yr + 1 : yr;
    grid.appendChild(makeCell(i, new Date(nextYr, nextMo, i), true));
  }
}

function updateHeaderDate() {
  const td = selDate || new Date();
  const day = td.getDate();
  const mo = MONTHS[td.getMonth()];
  const yr = td.getFullYear();
  const calLocEl = document.getElementById('calLocName');
  if (calLocEl) calLocEl.textContent = curLoc.name + ', ' + curLoc.country;
  document.getElementById('headerDate').textContent = `${day} ${mo} ${yr}`;
  // Show lunar month for this date
  try {
    const masa = getVaishnavaMasa(td);
    const gau = getGaurabda(td);
    document.getElementById('headerMasa').textContent = `${masa.masaTraditional}, Gaurabda ${gau}`;
  } catch(e) {
    document.getElementById('headerMasa').textContent = '';
  }
}

// Swipe to change month on calendar grid
(function() {
  let tx = 0, ty = 0;
  const el = () => document.getElementById('calGrid');
  document.addEventListener('touchstart', e => {
    if (!el() || !el().contains(e.target)) return;
    tx = e.touches[0].clientX;
    ty = e.touches[0].clientY;
  }, { passive: true });
  document.addEventListener('touchend', e => {
    if (!el() || !el().contains(e.changedTouches[0].target)) return;
    const dx = e.changedTouches[0].clientX - tx;
    const dy = e.changedTouches[0].clientY - ty;
    if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 40) {
      changeMonth(dx < 0 ? 1 : -1);
    }
  }, { passive: true });
})();

function changeMonth(dir) {
  curMonth += dir;
  if (curMonth > 11) { curMonth=0; curYear++; }
  if (curMonth < 0) { curMonth=11; curYear--; }
  renderCalendar();
}

function selectDay(date) {
  selDate = date;
  // If the clicked date is in a different month, navigate there
  curYear  = date.getFullYear();
  curMonth = date.getMonth();
  renderCalendar();
  renderDayDetail(date);
  updateHeaderDate();
}

// ===================================================================
// DAY DETAIL PANEL â€” matching screenshot layout
// ===================================================================
function renderDayDetail(date) {
  const y = date.getFullYear(), m = date.getMonth(), d = date.getDate();
  const dateStr = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
  const st      = getSunTimes(date, curLoc.lat, curLoc.lon, curLoc.tz);
  const tithi   = getTithi(date, curLoc.lat, curLoc.lon, curLoc.tz);
  const moon    = st ? getMoonRiseSet(date, curLoc.lat, curLoc.lon, curLoc.tz) : null;
  const masa    = getVaishnavaMasa(date);
  const gaurabda = getGaurabda(date);
  const events  = getEventsForDate(dateStr);
  const ekEvents    = events.filter(e => e.t==='ekadashi');
  const apEvents    = events.filter(e => e.t==='appearance');
  const festEvents  = events.filter(e => e.t==='festival');
  const allVEvents  = [...ekEvents, ...apEvents, ...festEvents];
  const customE     = events.filter(e => e.t==='custom');

  // Break fast info for Ekadashi days
  let fastNoticeHtml = '';
  if (ekEvents.length > 0) {
    const bf = getBreakFastTimes(date, curLoc);
    if (bf) {
      fastNoticeHtml = `
        <div class="fast-notice visible">
          <div class="fast-text">Break the fast tomorrow from ${bf.start} to ${bf.end}</div>
        </div>`;
    }
  }

  // Unified events block â€” all events, first 2 visible, rest collapsible
  function _typeClass(e) {
    if (e.t==='ekadashi') return 'type-ekadashi';
    if (e.t==='appearance') return 'type-appearance';
    return 'type-festival';
  }

  let festRowHtml = '';
  let extraFestHtml = '';

  if (allVEvents.length > 0) {
    const always = allVEvents.slice(0, 2);
    const extra  = allVEvents.slice(2);
    const uid    = 'evx' + dateStr.replace(/-/g,'');

    const makeRow = (e, isExtra) => {
      const tc     = _typeClass(e);
      const ekFlag = e.t==='ekadashi' ? '<svg class="ek-flag-inline" width="11" height="13" viewBox="0 0 36 44"><line x1="6" y1="4" x2="6" y2="42" stroke="#b8860b" stroke-width="3.5" stroke-linecap="round"/><polygon points="8,4 32,12 8,20" fill="#e8c800" stroke="#d4a800" stroke-width="1"/></svg> ' : '';
      const prefix = e.t==='ekadashi' ? 'Fasting: ' : '';
      const safeN  = e.n.replace(/'/g, '&apos;');
      return `<div class="evt-row ${tc}${isExtra ? ' evt-extra' : ''}" onclick="showEvtDetail('${safeN}')">
        <span class="evt-row-name">${ekFlag}${prefix}${e.n}</span>
        <span class="evt-row-arrow">â€º</span>
      </div>`;
    };

    const alwaysHtml = always.map(e => makeRow(e, false)).join('');
    const extraHtml  = extra.map(e => makeRow(e, true)).join('');
    const moreBtn    = extra.length ? `
      <div class="evt-show-more" id="${uid}" onclick="toggleEvtMore('${uid}')">
        <span id="${uid}lbl">+ ${extra.length} more</span>
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"/></svg>
      </div>` : '';

    festRowHtml = `<div class="events-block">${alwaysHtml}${extraHtml}${moreBtn}</div>`;
  }

  // Custom events
  let customHtml = customE.map(e => `
    <div class="custom-event-row">
      <span style="font-size:1.3rem;">${e.i}</span>
      <div>
        <div style="font-size:0.88rem;color:var(--text);">${e.n}</div>
        ${e.person ? `<div style="font-size:0.72rem;color:#27ae60;font-style:italic;">${e.person}</div>` : ''}
        ${e.desc ? `<div style="font-size:0.72rem;color:var(--text3);">${e.desc}</div>` : ''}
      </div>
    </div>`).join('');

  // Sun/Moon section
  let sunMoonHtml = '';
  if (st) {
    sunMoonHtml = `
      <div class="sun-moon-section">
        <div class="sm-col">
          <div class="sm-header"><span class="sm-icon">â˜€ï¸</span></div>
          <div class="sm-row"><span class="sm-label">Brahma Muhurta</span><span class="sm-value">${st.brahmaMuhurta}</span></div>
          <div class="sm-row"><span class="sm-label">Sunrise</span><span class="sm-value">${st.sunrise}</span></div>
          <div class="sm-row"><span class="sm-label">Noon</span><span class="sm-value">${st.noon}</span></div>
          <div class="sm-row"><span class="sm-label">Sunset</span><span class="sm-value">${st.sunset}</span></div>
        </div>
        <div class="sm-col">
          <div class="sm-header"><span class="sm-icon">ðŸŒ™</span></div>
          <div class="sm-row"><span class="sm-label">Paksa</span><span class="sm-value" style="color:#8fa8c0;">${tithi.paksha}</span></div>
          <div class="sm-row"><span class="sm-label">Moonrise</span><span class="sm-value">${moon ? moon.moonrise : 'â€”'}</span></div>
          <div class="sm-row"><span class="sm-label">Moonset</span><span class="sm-value">${moon ? moon.moonset : 'â€”'}</span></div>
        </div>
      </div>`;
  }

  // Gayatri / Sandhya times
  let gayatriHtml = '';
  if (st) {
    gayatriHtml = `
      <div class="gayatri-section">
        <div class="gayatri-title">Gayatri / Sandhya Times</div>
        <div class="gayatri-grid">
          <div class="gayatri-item g-pratah">
            <div class="g-sandhya-icon">${_sandhyaIcons.pratah.replace(/width="42" height="42"/g,'width="32" height="32"')}</div>
            <span class="g-sandhya">PrÄtaá¸¥</span>
            <div class="g-time">${st.sunrise}</div>
          </div>
          <div class="gayatri-item g-madhya">
            <div class="g-sandhya-icon">${_sandhyaIcons.madhya.replace(/width="42" height="42"/g,'width="32" height="32"')}</div>
            <span class="g-sandhya">MÄdhyÄhnika</span>
            <div class="g-time">${st.noon}</div>
          </div>
          <div class="gayatri-item g-sayam">
            <div class="g-sandhya-icon">${_sandhyaIcons.sayam.replace(/width="42" height="42"/g,'width="32" height="32"')}</div>
            <span class="g-sandhya">SÄyaá¹ƒ</span>
            <div class="g-time">${st.sunset}</div>
          </div>
        </div>
      </div>`;
  }

  // Rahu Kalam
  let rahuHtml = '';
  if (st) {
    const rahu = getRahuKalam(date, st.srMins, st.ssMins);
    rahuHtml = `
      <div class="rahu-section">
        <div class="rahu-header">
          <span class="rahu-title">Rahu Kalam</span>
          <span class="rahu-time">${rahu.start} â€“ ${rahu.end}</span>
        </div>

      </div>`;
  }

  // Panchanga row
  const panchaHtml = `
    <div class="panchanga-row">
      <div class="pancha-item">
        <span class="pancha-label">Gaurabda</span>
        <span class="pancha-value">${gaurabda}</span>
      </div>
      <div class="pancha-item">
        <span class="pancha-label">Masa</span>
        <span class="pancha-value">${masa.masa}</span>
      </div>
      <div class="pancha-item">
        <span class="pancha-label">Tithi</span>
        <span class="pancha-value">${tithi.tithi}</span>
      </div>
    </div>`;

  document.getElementById('dayDetail').innerHTML =
    fastNoticeHtml + festRowHtml + gayatriHtml + panchaHtml + sunMoonHtml + rahuHtml + customHtml;

  // Scroll detail into view
  setTimeout(() => {
    document.getElementById('dayDetail').scrollTop = 0;
  }, 50);
}

function showEvtDetail(name) {
  const evt = EVENTS.find(e => e.n === name);
  if (!evt) return;

  // Type label and color
  const typeMap = {
    ekadashi:   { label: 'Ekadashi Fast',        color: '#4ddb6e' },
    appearance: { label: 'Appearance / Disappearance Day', color: '#e8c800' },
    festival:   { label: 'Festival',              color: '#f08c1a' },
    custom:     { label: 'My Custom Event',        color: '#27ae60' },
  };
  const tm = typeMap[evt.t] || { label: evt.t, color: 'var(--text2)' };

  // Format date nicely
  const dt = new Date(evt.d + 'T12:00:00');
  const dateStr = dt.toLocaleDateString('en-IN', { weekday:'long', day:'numeric', month:'long', year:'numeric' });

  document.getElementById('evtModalType').textContent  = tm.label;
  document.getElementById('evtModalType').style.color  = tm.color;
  document.getElementById('evtModalTitle').textContent = evt.n;
  document.getElementById('evtModalIcon').textContent  = evt.i || '';
  document.getElementById('evtModalDate').innerHTML    = `ðŸ“… ${dateStr}`;
  document.getElementById('evtModalDesc').textContent  = evt.desc || '';

  // Load user notes
  _currentEvtKey = _evtNoteKey(evt.d, evt.n);
  _showEvtNoteDisplay();

  document.getElementById('evtModalOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeEvtModal(e) {
  if (e && e.target !== document.getElementById('evtModalOverlay')) return;
  document.getElementById('evtModalOverlay').classList.remove('open');
  document.body.style.overflow = '';
  // Reset editor state
  document.getElementById('evtNotesEditor').classList.remove('active');
  document.getElementById('evtNotesDisplay').style.display = '';
  document.getElementById('evtNotesEditBtn').style.display = '';
}

// ===== SHARED EVENT INFO (admin-editable, visible to all) =====
let _currentEvtKey = '';

function _evtNoteKey(dateStr, name) {
  // Use name only (no date) so notes carry forward to future years
  return name;
}

function _showEvtNoteDisplay() {
  const note = _getSharedEvtInfo(_currentEvtKey);
  document.getElementById('evtNotesDisplay').textContent = note;
  document.getElementById('evtNotesDisplay').style.display = '';
  // Only show edit button for admins
  document.getElementById('evtNotesEditBtn').style.display = isAdmin() ? '' : 'none';
  document.getElementById('evtNotesEditor').classList.remove('active');
  document.getElementById('evtNotesDeleteBtn').style.display = note.trim() ? '' : 'none';
  // Apply saved font size
  const sz = parseFloat(localStorage.getItem('evtNoteFontSize')) || 0.88;
  _applyEvtNoteFont(sz);
}

function toggleEvtNoteEditor() {
  if (!isAdmin()) return;
  const editor = document.getElementById('evtNotesEditor');
  const display = document.getElementById('evtNotesDisplay');
  const editBtn = document.getElementById('evtNotesEditBtn');
  const textarea = document.getElementById('evtNotesTextarea');
  const note = _getSharedEvtInfo(_currentEvtKey);

  display.style.display = 'none';
  editBtn.style.display = 'none';
  editor.classList.add('active');
  textarea.value = note;
  document.getElementById('evtNotesDeleteBtn').style.display = note.trim() ? '' : 'none';
  setTimeout(() => textarea.focus(), 200);
}

async function saveEvtNote() {
  if (!isAdmin()) return;
  const text = document.getElementById('evtNotesTextarea').value;
  await _saveSharedEvtInfo(_currentEvtKey, text);
  _showEvtNoteDisplay();
  showToast('Info saved & shared with all users âœ“');
}

function cancelEvtNoteEdit() {
  _showEvtNoteDisplay();
}

function changeEvtNoteFont(delta) {
  const key = 'evtNoteFontSize';
  let size = parseFloat(localStorage.getItem(key)) || 0.88;
  size = Math.max(0.7, Math.min(1.3, size + delta * 0.04));
  localStorage.setItem(key, size.toFixed(2));
  _applyEvtNoteFont(size);
}

function _applyEvtNoteFont(size) {
  const display = document.getElementById('evtNotesDisplay');
  const desc = document.getElementById('evtModalDesc');
  if (display) display.style.fontSize = size + 'rem';
  if (desc) desc.style.fontSize = size + 'rem';
}

async function deleteEvtNote() {
  if (!isAdmin()) return;
  await _saveSharedEvtInfo(_currentEvtKey, '');
  _showEvtNoteDisplay();
  showToast('Info deleted');
}

// ===================================================================
// SEARCH
// ===================================================================
function setFilter(el, f) {
  document.querySelectorAll('.fc').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  curFilter = f;
  doSearch();
}

function doSearch() {
  const q = document.getElementById('searchQ').value.toLowerCase();
  const now = new Date();
  const limit = new Date(now.getFullYear()+2, 11, 31);

  let pool = [...EVENTS];
  customEvts.forEach(e => {
    const yr = e.year || now.getFullYear();
    const ds = `${yr}-${String(parseInt(e.month)+1).padStart(2,'0')}-${String(e.day).padStart(2,'0')}`;
    pool.push({ d: ds, n: e.name, t:'custom', i: evtIcon(e.type), desc: e.notes||'' });
  });

  let res = pool.filter(e => {
    const dt = new Date(e.d);
    if (dt < new Date(now.getFullYear(),0,1) || dt > limit) return false;
    if (curFilter !== 'all' && e.t !== curFilter) return false;
    if (q && !e.n.toLowerCase().includes(q) && !(e.desc||'').toLowerCase().includes(q)) return false;
    return true;
  }).sort((a,b) => new Date(a.d)-new Date(b.d));

  if (!q && curFilter==='all') res = res.filter(e => new Date(e.d) >= now).slice(0,20);

  const c = document.getElementById('searchResults');
  if (!res.length) {
    c.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ðŸ”</div>No results found</div>';
    return;
  }
  c.innerHTML = res.slice(0,30).map(e => {
    const dt = new Date(e.d);
    const ds = `${MONTHS_SHORT[dt.getMonth()]} ${dt.getDate()}, ${dt.getFullYear()}`;
    const colMap = {ekadashi:'rgba(61,127,212,0.15)',festival:'rgba(192,57,43,0.15)',appearance:'rgba(212,160,23,0.12)',custom:'rgba(39,174,96,0.12)'};
    return `<div class="s-result" onclick="gotoDate(${dt.getFullYear()},${dt.getMonth()},${dt.getDate()})">
      <div class="s-icon" style="background:${colMap[e.t]||'rgba(255,255,255,0.06)'}">${e.i}</div>
      <div style="flex:1">
        <div class="s-name">${e.n}</div>
        <div class="s-date">${ds}</div>
        <div class="s-desc">${e.desc||''}</div>
      </div>
      <span class="s-tag">${e.t}</span>
    </div>`;
  }).join('');
}

function gotoDate(y,m,d) {
  curYear=y; curMonth=m;
  selDate = new Date(y,m,d);
  switchScreen('calendar', document.querySelectorAll('.nav-btn')[1]);
  renderCalendar();
  renderDayDetail(selDate);
  updateHeaderDate();
}

function doJump() {
  const d = document.getElementById('jumpDay').value;
  const m = document.getElementById('jumpMonth').value;
  const y = document.getElementById('jumpYear').value;
  if (d && m!=='' && y) { gotoDate(parseInt(y),parseInt(m),parseInt(d)); }
  else showToast('Please select day, month and year');
}

function initJumpSelects() {
  const dEl = document.getElementById('jumpDay');
  const yEl = document.getElementById('jumpYear');
  if (dEl.options.length <= 1) for (let i=1;i<=31;i++) dEl.innerHTML+=`<option value="${i}">${i}</option>`;
  if (yEl.options.length <= 1) {
    const cy = new Date().getFullYear();
    for (let y=1975;y<=2075;y++) yEl.innerHTML+=`<option value="${y}"${y===cy?' selected':''}>${y}</option>`;
  }
}

// ===================================================================
// SONGS
// ===================================================================

// ---- Language / Script system ----
let songLang = localStorage.getItem('songLang') || 'en'; // 'en' | 'hi' | 'mr'

function setSongLang(lang) {
  songLang = lang;
  localStorage.setItem('songLang', lang);
  // Sync both dropdowns
  const sel1 = document.getElementById('songLangSel');
  const sel2 = document.getElementById('songLangSelList');
  if (sel1) sel1.value = lang;
  if (sel2) sel2.value = lang;
  renderSongs();
  if (_currentSongId) openSongDetail(_currentSongId);
}

// IAST romanized â†’ Devanagari transliterator
function iastToDev(text) {
  if (!text) return '';
  // Normalize decomposed Unicode (e.g. n + combining accent â†’ Å„)
  text = text.normalize('NFC');
  // Replace non-breaking spaces, special chars
  text = text.replace(/\u00a0/g, ' ').replace(/Ã¯/g, 'i');
  const C2 = {'kh':'à¤–','gh':'à¤˜','ch':'à¤›','jh':'à¤','á¹­h':'à¤ ','á¸h':'à¤¢','th':'à¤¥','dh':'à¤§','ph':'à¤«','bh':'à¤­'};
  const C1 = {'á¹…':'à¤™','Ã±':'à¤ž','á¹‡':'à¤£','Å„':'à¤™','á¹­':'à¤Ÿ','á¸':'à¤¡','Å›':'à¤¶','á¹£':'à¤·',
    'k':'à¤•','g':'à¤—','c':'à¤š','j':'à¤œ','t':'à¤¤','d':'à¤¦','n':'à¤¨',
    'p':'à¤ª','b':'à¤¬','m':'à¤®','y':'à¤¯','r':'à¤°','l':'à¤²','v':'à¤µ','w':'à¤µ',
    's':'à¤¸','h':'à¤¹','á¸»':'à¤³'};
  const V2 = {'ai':'à¤','au':'à¤”'};
  const V1 = {'Ä':'à¤†','Ä«':'à¤ˆ','Å«':'à¤Š','á¹›':'à¤‹','á¹':'à¥ ','a':'à¤…','i':'à¤‡','u':'à¤‰','e':'à¤','o':'à¤“'};
  const M2 = {'ai':'à¥ˆ','au':'à¥Œ'};
  const M1 = {'Ä':'à¤¾','Ä«':'à¥€','Å«':'à¥‚','á¹›':'à¥ƒ','á¹':'à¥„','a':'','i':'à¤¿','u':'à¥','e':'à¥‡','o':'à¥‹'};
  let r='', i=0, ac=false;
  while(i<text.length){
    let ch=text[i], ch2=text.substring(i,i+2), cl=ch.toLowerCase(), c2l=ch2.toLowerCase();
    // Skip any remaining combining marks (U+0300-U+036F)
    if(ch.charCodeAt(0)>=0x300 && ch.charCodeAt(0)<=0x36F){i++;continue;}
    let hit=false;
    if(C2[c2l]){if(ac)r+='\u094D';r+=C2[c2l];ac=true;i+=2;hit=true;}
    else if(C1[cl]){if(ac)r+='\u094D';r+=C1[cl];ac=true;i+=1;hit=true;}
    else if(ch==='\u1E41'||ch==='\u1E3F'||ch==='\u1E43'){r+='\u0902';ac=false;i+=1;hit=true;}
    else if(ch==='\u1E25'){r+='\u0903';ac=false;i+=1;hit=true;}
    else{
      if(V2[c2l]){r+=(ac?M2[c2l]:V2[c2l]);ac=false;i+=2;hit=true;}
      else if(V1[cl]){r+=(ac?M1[cl]:V1[cl]);ac=false;i+=1;hit=true;}
    }
    if(!hit){
      if(ac)r+='\u094D';
      ac=false;
      if(ch==="'"||ch==='\u2018'||ch==='\u2019')r+='\u093D'; else r+=ch;
      i+=1;
    }
  }
  if(ac)r+='\u094D';
  return r;
}

// Apply script to song title (for list view)
function _songTitle(s) {
  if (songLang === 'en') return s.title || '';
  // Use stored Devanagari title if available, else transliterate
  return s.title_dev || iastToDev(s.title || '');
}

// Apply script to lyrics
function _songLyrics(s) {
  if (songLang === 'en') return s.lyrics || '';
  return iastToDev(s.lyrics || '');
}

// Apply translation language
function _songTrans(s) {
  if (songLang === 'hi' && s.trans_hi) return s.trans_hi;
  if (songLang === 'mr' && s.trans_mr) return s.trans_mr;
  return s.trans || '';
}

function defaultSongs() {
  return [];
}

// ---- Song sort state & font size ----
let songSortMode = 'cat';  // 'cat' | 'author'
const SONG_FONT_SIZES = [0.76, 0.82, 0.88, 0.96, 1.05, 1.16, 1.28, 1.42, 1.58];
const SONG_FONT_LABELS = ['XS','S','M','L','XL','2XL','3XL','4XL','5XL'];
let songFontIdx = 4; // default XL

function setSongSort(mode, btn) {
  songSortMode = mode;
  _openCatKey = null; // Reset category folder view
  document.querySelectorAll('.songs-sort-btn').forEach(b => b.classList.remove('active'));
  if (btn) btn.classList.add('active');
  renderSongs();
}

function changeSongFont(delta) {
  songFontIdx = Math.max(0, Math.min(SONG_FONT_SIZES.length - 1, songFontIdx + delta));
  const sz = SONG_FONT_SIZES[songFontIdx];
  // Update detail page lyrics (sd-lyrics / sd-trans)
  document.querySelectorAll('.sd-lyrics').forEach(el => el.style.fontSize = sz + 'rem');
  document.querySelectorAll('.sd-trans').forEach(el => el.style.fontSize = (sz * 0.92) + 'rem');
  document.querySelectorAll('.sd-trans-text').forEach(el => el.style.fontSize = (sz * 0.92) + 'rem');
  document.querySelectorAll('.sd-verse-text').forEach(el => el.style.fontSize = sz + 'rem');
  // Also update list page lyrics if open (legacy)
  document.querySelectorAll('.lyrics-text, .lyrics-trans').forEach(el => el.style.fontSize = sz + 'rem');
}

// ---- Show next hidden audio field in modal ----
let _audioFieldsShown = 1;
function showNextAudioField() {
  if (_audioFieldsShown >= 5) { showToast('Maximum 5 recordings'); return; }
  document.getElementById('aRow' + _audioFieldsShown).style.display = '';
  _audioFieldsShown++;
  if (_audioFieldsShown >= 5) document.getElementById('addAudioBtn').style.display = 'none';
}

function _catLabel(cat) {
  return {vbhajan:'ðŸŒ¸ Vaishnava Bhajans', hkkirtan:'ðŸŽ¶ Hare Krsna Kirtans',
          astakam:'ðŸ™ Astakams', stotram:'ðŸ“¿ Stotrams',
          gita:'ðŸ“— Bhagavad Gita Verses', bhagavatam:'ðŸŒŠ Srimad Bhagavatam Prayers', samhita:'ðŸ“œ Samhita'}[cat] || cat;
}

function _getAudioEmbed(url, singer) {
  const singerHtml = singer ? `<div class="audio-singer">${singer}</div>` : '';
  const u = (url || '').trim();
  if (!u) return '';

  // 1. YouTube
  const ytMatch = u.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([\w-]+)/);
  if (ytMatch) {
    return `<div class="audio-item">${singerHtml}
      <iframe src="https://www.youtube.com/embed/${ytMatch[1]}" style="width:100%;height:180px;border:none;border-radius:8px;" allow="autoplay;encrypted-media" allowfullscreen></iframe></div>`;
  }

  // 2. SoundCloud
  if (u.includes('soundcloud.com/')) {
    return `<div class="audio-item">${singerHtml}
      <iframe width="100%" height="120" scrolling="no" frameborder="no" style="border-radius:8px;"
        src="https://w.soundcloud.com/player/?url=${encodeURIComponent(u)}&color=%23a78bfa&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=false"></iframe></div>`;
  }

  // 3. pCloud â€” embed their audio player via iframe
  if (u.includes('pcloud.link') || u.includes('pcloud.com')) {
    // Convert publink/show to embed format, or use as-is in iframe
    const codeMatch = u.match(/code=([\w]+)/);
    if (codeMatch) {
      const embedUrl = `https://e1.pcloud.link/publink/show?code=${codeMatch[1]}`;
      return `<div class="audio-item">${singerHtml}
        <div style="display:flex;gap:8px;align-items:center;">
          <a href="${u}" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:6px;padding:8px 14px;background:var(--accent-blue);color:#fff;border-radius:8px;text-decoration:none;font-size:0.82rem;">
            â–¶ Play on pCloud
          </a>
          <span style="font-size:0.72rem;color:var(--text3);">Opens in new tab</span>
        </div></div>`;
    }
    return `<div class="audio-item">${singerHtml}
      <a href="${u}" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:6px;padding:8px 14px;background:var(--accent-blue);color:#fff;border-radius:8px;text-decoration:none;font-size:0.82rem;">
        â–¶ Play on pCloud
      </a></div>`;
  }

  // 4. Google Drive â€” convert sharing link to direct download
  if (u.includes('drive.google.com')) {
    const idMatch = u.match(/\/d\/([\w-]+)/) || u.match(/id=([\w-]+)/);
    if (idMatch) {
      const directUrl = `https://drive.google.com/uc?export=download&id=${idMatch[1]}`;
      return `<div class="audio-item${singer?'':' no-singer'}">${singerHtml}
        <audio controls src="${directUrl}" preload="none"></audio></div>`;
    }
  }

  // 5. Dropbox â€” convert to direct download
  if (u.includes('dropbox.com')) {
    const directUrl = u.replace('www.dropbox.com', 'dl.dropboxusercontent.com').replace('?dl=0', '').replace('?dl=1', '');
    return `<div class="audio-item${singer?'':' no-singer'}">${singerHtml}
      <audio controls src="${directUrl}" preload="none"></audio></div>`;
  }

  // 5b. OneDrive â€” convert sharing link to direct download
  if (u.includes('1drv.ms') || u.includes('onedrive.live.com') || u.includes('sharepoint.com')) {
    // Convert 1drv.ms or onedrive sharing links to direct download
    // Method: replace "redir" with "download" or use embed trick
    let directUrl = u;
    if (u.includes('1drv.ms')) {
      // Short link â€” encode to base64 API URL
      const encodedUrl = btoa(u).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'');
      directUrl = `https://api.onedrive.com/v1.0/shares/u!${encodedUrl}/root/content`;
    } else if (u.includes('onedrive.live.com') && u.includes('resid=')) {
      directUrl = u.replace('onedrive.live.com/redir', 'onedrive.live.com/download');
    }
    return `<div class="audio-item${singer?'':' no-singer'}">${singerHtml}
      <audio controls src="${directUrl}" preload="none" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';"></audio>
      <a href="${u}" target="_blank" rel="noopener" style="display:none;align-items:center;gap:6px;padding:8px 14px;background:var(--accent-blue);color:#fff;border-radius:8px;text-decoration:none;font-size:0.82rem;">
        â–¶ Play on OneDrive
      </a></div>`;
  }

  // 6. Direct audio file (.mp3, .ogg, .wav, .m4a, .flac, .aac, .wma)
  if (/\.(mp3|ogg|wav|m4a|flac|aac|wma|opus|webm)(\?.*)?$/i.test(u)) {
    return `<div class="audio-item${singer?'':' no-singer'}">${singerHtml}
      <audio controls src="${u}" preload="none"></audio></div>`;
  }

  // 7. Fallback: try as audio element with error fallback
  return `<div class="audio-item${singer?'':' no-singer'}">${singerHtml}
    <audio controls src="${u}" preload="none" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';"></audio>
    <a href="${u}" target="_blank" rel="noopener" style="display:none;align-items:center;gap:6px;padding:8px 14px;background:var(--accent-blue);color:#fff;border-radius:8px;text-decoration:none;font-size:0.82rem;">
      â–¶ Open Audio Link
    </a></div>`;
}

function _buildAudioHtml(s) {
  // Support both old `audio` string and new `audios` array
  const list = s.audios && s.audios.length ? s.audios
    : (s.audio ? [{url: s.audio, singer:''}] : []);
  if (!list.length) return '';
  return `<div class="audio-list">${list.map(a => _getAudioEmbed(a.url, a.singer)).join('')}</div>`;
}

// ===================================================================
// NOW PLAYING â€” Persistent audio & visual indicators
// ===================================================================
let _playingSongId = null;      // ID of currently-playing song
let _persistentAudio = null;    // The <audio> element kept alive across screens
let _playingSongTitle = '';      // Cached title for the mini bar
let _playingSongCat = '';        // Cached category for the mini bar subtitle
let _playingAudioSrc = '';      // src of the audio currently playing

function _nowPlayingBarsHtml() {
  return '<div class="now-playing-bars"><span></span><span></span><span></span><span></span></div>';
}

// Attach play/pause/ended listeners to every <audio> inside songDetailBody
function _hookSongDetailAudio(songId) {
  const body = document.getElementById('songDetailBody');
  if (!body) return;
  const audios = body.querySelectorAll('audio');
  audios.forEach(au => {
    au.addEventListener('play', () => _onAudioPlay(au, songId));
    au.addEventListener('pause', () => _onAudioPause(au, songId));
    au.addEventListener('ended', () => _onAudioEnded(songId));
  });
}

function _onAudioPlay(audioEl, songId) {
  // If a different song was playing, stop it
  if (_persistentAudio && _persistentAudio !== audioEl) {
    _persistentAudio.pause();
    _persistentAudio.currentTime = 0;
  }
  const s = songs.find(x => x.id === songId);
  _playingSongId = songId;
  _persistentAudio = audioEl;
  _playingAudioSrc = audioEl.src;
  _playingSongTitle = s ? _songTitle(s) : '';
  _playingSongCat = s ? (_catLabel(s.cat || '').replace(/^[^ ]+ /,'')) : '';
  _updateNowPlayingBar(true);
  _updateSongListIndicator();
}

function _onAudioPause(audioEl, songId) {
  // Only clear if this is the same audio (not replaced by another)
  if (_persistentAudio === audioEl && audioEl.ended !== true) {
    // Paused but not ended â€” keep the bar visible but could animate differently
    // For simplicity keep it visible so user can resume
  }
}

function _onAudioEnded(songId) {
  _clearNowPlaying();
}

function _clearNowPlaying() {
  if (_persistentAudio) {
    _persistentAudio.pause();
    _persistentAudio.currentTime = 0;
  }
  _playingSongId = null;
  _persistentAudio = null;
  _playingAudioSrc = '';
  _playingSongTitle = '';
  _playingSongCat = '';
  _updateNowPlayingBar(false);
  _updateSongListIndicator();
  // Remove from persistent container
  const wrap = document.getElementById('persistentAudioWrap');
  if (wrap) wrap.innerHTML = '';
  document.body.classList.remove('has-now-playing');
}

function _updateNowPlayingBar(show) {
  const bar = document.getElementById('nowPlayingBar');
  if (!bar) return;
  if (show && _playingSongId) {
    document.getElementById('npBarTitle').textContent = _playingSongTitle || 'Unknown';
    document.getElementById('npBarSubtitle').textContent = _playingSongCat ? ('â™« ' + _playingSongCat) : 'â™« Now Playing';
    bar.classList.add('visible');
    document.body.classList.add('has-now-playing');
  } else {
    bar.classList.remove('visible');
    document.body.classList.remove('has-now-playing');
  }
}

// Update song list cards to show/hide the ðŸŽµ icon
function _updateSongListIndicator() {
  // Remove all existing indicators
  document.querySelectorAll('.now-playing-icon').forEach(el => el.remove());
  document.querySelectorAll('.song-card.now-playing').forEach(el => el.classList.remove('now-playing'));
  if (!_playingSongId) return;
  const card = document.getElementById('sc-' + _playingSongId);
  if (!card) return;
  card.classList.add('now-playing');
  // Insert the animated bars icon before the arrow
  const arrow = card.querySelector('.song-row-arrow');
  if (arrow) {
    const icon = document.createElement('div');
    icon.className = 'now-playing-icon';
    icon.innerHTML = _nowPlayingBarsHtml();
    icon.onclick = function(e) {
      e.stopPropagation();
      openSongDetail(_playingSongId);
    };
    arrow.parentNode.insertBefore(icon, arrow);
  }
}

// Mini bar tap â†’ go to the playing song detail
function npBarTap(e) {
  if (!_playingSongId) return;
  openSongDetail(_playingSongId);
}

// Mini bar close â†’ stop playback
function npBarStop(e) {
  e.stopPropagation();
  _clearNowPlaying();
}

// Persist audio when leaving song detail
function _persistCurrentAudio() {
  if (!_persistentAudio || !_playingSongId) return;
  if (_persistentAudio.paused) return; // Not playing, nothing to persist
  // Move the audio element to the persistent container so it survives DOM changes
  const wrap = document.getElementById('persistentAudioWrap');
  if (wrap && _persistentAudio.parentNode !== wrap) {
    wrap.innerHTML = '';
    wrap.appendChild(_persistentAudio);
  }
}

// When re-opening the playing song's detail, reconnect the persistent audio
function _reconnectPersistentAudio(songId) {
  if (!_persistentAudio || _playingSongId !== songId) return false;
  if (_persistentAudio.paused && _persistentAudio.currentTime === 0) return false;
  // Find the matching audio slot in the detail body and replace it
  const body = document.getElementById('songDetailBody');
  if (!body) return false;
  const audioEls = body.querySelectorAll('audio');
  for (const au of audioEls) {
    if (au.src === _playingAudioSrc || _decodeUrlMatch(au.src, _playingAudioSrc)) {
      // Replace this fresh audio with our persistent one
      au.parentNode.replaceChild(_persistentAudio, au);
      return true;
    }
  }
  return false;
}

function _decodeUrlMatch(a, b) {
  try { return decodeURIComponent(a) === decodeURIComponent(b); } catch(e) { return false; }
}

function _buildSongCard(s) {
  const isPlaying = _playingSongId === s.id;
  const npIcon = isPlaying
    ? `<div class="now-playing-icon" onclick="event.stopPropagation();openSongDetail(${s.id})">${_nowPlayingBarsHtml()}</div>`
    : '';
  return `<div class="song-card${isPlaying ? ' now-playing' : ''}" id="sc-${s.id}" onclick="openSongDetail(${s.id})">
    <div class="song-title-text">${_songTitle(s)}</div>
    ${npIcon}
    <span class="song-row-arrow">â€º</span>
  </div>`;
}

let _openCatKey = null; // Track which category folder is open

const CAT_FOLDER_INFO = {
  vbhajan:    { icon:'ðŸŒ¸', name:'Vaishnava Bhajans', gradient:'linear-gradient(135deg, rgba(244,114,182,0.15), rgba(236,72,153,0.05))' },
  hkkirtan:   { icon:'ðŸŽ¶', name:'Hare Krsna Kirtans', gradient:'linear-gradient(135deg, rgba(129,140,248,0.15), rgba(99,102,241,0.05))' },
  astakam:    { icon:'ðŸ™', name:'Astakams', gradient:'linear-gradient(135deg, rgba(251,146,60,0.15), rgba(249,115,22,0.05))' },
  stotram:    { icon:'ðŸ“¿', name:'Stotrams', gradient:'linear-gradient(135deg, rgba(52,211,153,0.15), rgba(16,185,129,0.05))' },
  gita:       { icon:'ðŸ“—', name:'Bhagavad Gita Verses', gradient:'linear-gradient(135deg, rgba(163,230,53,0.15), rgba(132,204,22,0.05))' },
  bhagavatam: { icon:'ðŸŒŠ', name:'Srimad Bhagavatam Prayers', gradient:'linear-gradient(135deg, rgba(56,189,248,0.15), rgba(14,165,233,0.05))' },
  samhita:    { icon:'ðŸ“œ', name:'Samhita', gradient:'linear-gradient(135deg, rgba(232,121,249,0.15), rgba(168,85,247,0.05))' },
};

function openCatFolder(catKey) {
  _openCatKey = catKey;
  renderSongs();
}

function closeCatFolder() {
  _openCatKey = null;
  renderSongs();
}

function _naturalSongSort(a, b) {
  return a.title.localeCompare(b.title, undefined, { numeric: true, sensitivity: 'base' });
}

function renderSongs(filter) {
  // Update sort button states
  const sb = document.getElementById('ksort-cat');
  const ab = document.getElementById('ksort-author');
  if (sb) sb.classList.toggle('active', songSortMode==='cat');
  if (ab) ab.classList.toggle('active', songSortMode==='author');

  // Font label
  const fl = document.getElementById('songFontLabel');
  if (fl) fl.textContent = SONG_FONT_LABELS[songFontIdx];

  // Filter songs if search active
  const q = (filter !== undefined ? filter : document.getElementById('kirtanSearchInp')?.value || '').trim().toLowerCase();
  let pool = q ? songs.filter(s =>
    (s.title||'').toLowerCase().includes(q) ||
    (s.officialName||'').toLowerCase().includes(q) ||
    (s.author||'').toLowerCase().includes(q) ||
    (s.book||'').toLowerCase().includes(q) ||
    (s.lyrics||'').toLowerCase().includes(q) ||
    (s.trans||'').toLowerCase().includes(q) ||
    (songLang !== 'en' && _songTitle(s).includes(q))
  ) : songs;

  let cards = '';
  if (!pool.length) {
    cards = `<div style="padding:40px 16px;text-align:center;">
      <div style="font-size:2rem;margin-bottom:8px;">ðŸŽµ</div>
      <div style="font-size:0.85rem;color:var(--text3);">${q ? 'No songs match "'+q+'"' : 'No songs yet â€” tap ï¼‹ to add!'}</div>
    </div>`;
  } else if (songSortMode === 'author') {
    _openCatKey = null;
    const authors = [...new Set(pool.map(s => s.author))].sort((a,b) => a.localeCompare(b));
    authors.forEach(author => {
      pool.filter(s => s.author === author).forEach((s,i) => {
        if (i===0) cards += `<div class="cat-title">âœï¸ ${author}</div>`;
        cards += _buildSongCard(s);
      });
    });
    document.getElementById('songsContent').innerHTML = `<div style="padding:8px 12px 100px;">${cards}</div>`;
  } else if (q) {
    // When searching, show flat list grouped by cat (no folders)
    _openCatKey = null;
    const CAT_ORDER = ['vbhajan','hkkirtan','astakam','stotram','gita','bhagavatam','samhita'];
    const rendered = new Set();
    CAT_ORDER.forEach(key => {
      const cs = pool.filter(s => s.cat === key).sort(_naturalSongSort);
      if (!cs.length) return;
      cards += `<div class="cat-title">${_catLabel(key)}</div>`;
      cs.forEach(s => { cards += _buildSongCard(s); rendered.add(s.id); });
    });
    const rest = pool.filter(s => !rendered.has(s.id));
    if (rest.length) {
      cards += `<div class="cat-title">ðŸ“Œ Other</div>`;
      rest.forEach(s => { cards += _buildSongCard(s); });
    }
    document.getElementById('songsContent').innerHTML = `<div style="padding:8px 12px 100px;">${cards}</div>`;
  } else if (_openCatKey) {
    // Show songs inside the opened category folder
    const CAT_ORDER_KEYS = ['vbhajan','hkkirtan','astakam','stotram','gita','bhagavatam','samhita'];
    const info = CAT_FOLDER_INFO[_openCatKey] || { icon:'ðŸ“Œ', name:'Other' };
    const catSongs = _openCatKey === 'other'
      ? pool.filter(s => !CAT_ORDER_KEYS.includes(s.cat)).sort(_naturalSongSort)
      : pool.filter(s => s.cat === _openCatKey).sort(_naturalSongSort);
    let innerCards = '';
    catSongs.forEach(s => { innerCards += _buildSongCard(s); });
    if (!innerCards) innerCards = '<div style="padding:20px;text-align:center;color:var(--text3);font-size:0.85rem;">No songs in this category yet</div>';
    document.getElementById('songsContent').innerHTML = `
      <div class="cat-detail-header">
        <button class="cat-back-btn" onclick="closeCatFolder()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><polyline points="15 18 9 12 15 6"/></svg>
          Back
        </button>
        <span style="font-size:1.2rem;">${info.icon}</span>
        <span class="cat-detail-title">${info.name}</span>
        <span class="cat-detail-count">${catSongs.length} song${catSongs.length!==1?'s':''}</span>
      </div>
      <div style="padding:4px 12px 100px;">${innerCards}</div>`;
  } else {
    // Show category folder cards
    const CAT_ORDER = ['vbhajan','hkkirtan','astakam','stotram','gita','bhagavatam','samhita'];
    let folderCards = '';
    CAT_ORDER.forEach(key => {
      const count = pool.filter(s => s.cat === key).length;
      const info = CAT_FOLDER_INFO[key];
      folderCards += `<div class="cat-folder-card" data-cat="${key}" onclick="openCatFolder('${key}')" style="background:${info.gradient};">
        <div class="cat-folder-icon">${info.icon}</div>
        <div class="cat-folder-name">${info.name}</div>
        <div class="cat-folder-count">${count} song${count!==1?'s':''}</div>
      </div>`;
    });
    // Check for uncategorized
    const rest = pool.filter(s => !CAT_ORDER.includes(s.cat));
    if (rest.length) {
      folderCards += `<div class="cat-folder-card" data-cat="other" onclick="openCatFolder('other')" style="background:linear-gradient(135deg,rgba(255,255,255,0.06),rgba(255,255,255,0.02));">
        <div class="cat-folder-icon">ðŸ“Œ</div>
        <div class="cat-folder-name">Other</div>
        <div class="cat-folder-count">${rest.length} song${rest.length!==1?'s':''}</div>
      </div>`;
    }
    document.getElementById('songsContent').innerHTML = `<div class="cat-folders-grid">${folderCards}</div>`;
  }
  if (songSortMode === 'author' || q) {
    // Already rendered above
  }
}

let _currentSongId = null;
let _songDetailPrevScreen = 'songs';

function _buildVerseCards(lyrics, sz) {
  if (!lyrics) return '';
  // Split by verse markers (1), (2), (10) etc. â€” only when NOT preceded by a digit
  const parts = lyrics.split(/(?<!\d)(?=\(\d+\))/);
  const cards = [];
  for (const part of parts) {
    const trimmed = part.trim();
    if (!trimmed) continue;
    const m = trimmed.match(/^\((\d+)\)\s*([\s\S]*)/);
    if (m) {
      cards.push({ num: m[1], text: m[2].trim() });
    } else {
      cards.push({ num: null, text: trimmed });
    }
  }
  if (!cards.length) return `<div class="sd-lyrics" style="font-size:${sz}rem">${lyrics}</div>`;
  return `<div class="sd-verse-cards">${cards.map(c => `
    <div class="sd-verse-card">
      ${c.num ? `<div class="sd-verse-num">${c.num}</div>` : ''}
      <div class="sd-verse-text" style="font-size:${sz}rem">${c.text}</div>
    </div>`).join('')}</div>`;
}

function _buildTransCards(trans, sz) {
  if (!trans) return '';
  // Split translation by verse numbers like "1)", "10)" â€” only when NOT preceded by a digit
  const parts = trans.split(/(?<!\d)(?=\d+\)\s)/);
  const cards = [];
  for (const part of parts) {
    const trimmed = part.trim();
    if (!trimmed) continue;
    const m = trimmed.match(/^(\d+)\)\s*([\s\S]*)/);
    if (m) {
      cards.push({ num: m[1], text: m[2].trim() });
    } else {
      cards.push({ num: null, text: trimmed });
    }
  }
  if (!cards.length) return `<div class="sd-trans" style="font-size:${sz * 0.92}rem">${trans}</div>`;
  const fontSize = sz * 0.92;
  return `<div class="sd-trans-cards">${cards.map(c => `
    <div class="sd-trans-card">
      ${c.num ? `<div class="sd-trans-num">${c.num}</div>` : ''}
      <div class="sd-trans-text" style="font-size:${fontSize}rem">${c.text}</div>
    </div>`).join('')}</div>`;
}

function openSongDetail(id) {
  const s = songs.find(s => s.id === id);
  if (!s) return;
  _currentSongId = id;
  // Only update prev screen if we're NOT already on song-detail (i.e. not a refresh)
  const activeScreen = document.querySelector('.screen.active')?.id?.replace('screen-','') || 'songs';
  if (activeScreen !== 'song-detail') {
    _songDetailPrevScreen = activeScreen;
  }

  const sz = SONG_FONT_SIZES[songFontIdx];
  const audioHtml = _buildAudioHtml(s);
  const meta = [
    s.cat ? _catLabel(s.cat).replace(/^[^ ]+ /,'') : null,
    s.lang || null,
    s.book || null
  ].filter(Boolean);

  const catFull = s.cat ? _catLabel(s.cat) : '';
  const displayTitle = _songTitle(s);
  const lyrics = _songLyrics(s);
  const trans = _songTrans(s);
  const transLabel = songLang === 'hi' ? 'Translation (Hindi)' : songLang === 'mr' ? 'Translation (Marathi)' : 'Translation';

  const infoRows = [
    { label: 'Song Name',     value: displayTitle },
    { label: 'Official Name', value: s.officialName || null },
    { label: 'Author',        value: s.author || null },
    { label: 'Category',      value: catFull || null, editable: true },
    { label: 'Book',          value: s.book || null },
    { label: 'Language',      value: s.lang || null },
  ].filter(r => r.value);

  document.getElementById('songDetailBody').innerHTML = `
    <div class="sd-info-card">
      ${infoRows.map(r => `
        <div class="sd-info-row">
          <span class="sd-info-label">${r.label}</span>
          <span class="sd-info-value">${r.value}${r.editable && isAdmin() ? ` <button class="sd-cat-change-btn" onclick="showCatChanger(${id})">Change</button>` : ''}</span>
        </div>`).join('')}
    </div>
    <div class="sd-cat-changer" id="sdCatChanger" style="display:none;">
      <div class="sd-section-lbl">Move to Category</div>
      <div class="sd-cat-options" id="sdCatOptions"></div>
    </div>

    ${audioHtml}

    ${lyrics ? `
      <div class="sd-section-lbl">${songLang !== 'en' ? 'à¤ªà¤¦ (Lyrics)' : 'Lyrics'}</div>
      ${_buildVerseCards(lyrics, sz)}
    ` : ''}
    ${trans ? `
      <div class="sd-divider"></div>
      <div class="sd-section-lbl">${transLabel}</div>
      ${_buildTransCards(trans, sz)}
    ` : ''}
  `;

  // Sync language dropdown
  const langSel = document.getElementById('songLangSel');
  if (langSel) langSel.value = songLang;

  // Reconnect persistent audio if this is the playing song, then hook events
  if (_playingSongId === id) {
    _reconnectPersistentAudio(id);
  }
  _hookSongDetailAudio(id);

  // Switch to detail screen (no nav highlight change)
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-song-detail').classList.add('active');

  // Hide mini bar when we're looking at the playing song (avoid redundancy)
  const bar = document.getElementById('nowPlayingBar');
  if (bar && _playingSongId === id) bar.classList.remove('visible');
}

function refreshSongDetail() {
  if (_currentSongId) openSongDetail(_currentSongId);
}

function showCatChanger(songId) {
  const s = songs.find(x => x.id === songId);
  if (!s) return;
  const changer = document.getElementById('sdCatChanger');
  if (changer.style.display !== 'none') { changer.style.display = 'none'; return; }
  const cats = ['vbhajan','hkkirtan','astakam','stotram','gita','bhagavatam','samhita'];
  const html = cats.map(c => {
    const isCurrent = s.cat === c;
    return `<div class="sd-cat-opt${isCurrent ? ' current' : ''}" onclick="changeSongCat(${songId},'${c}')">${_catLabel(c)}</div>`;
  }).join('');
  document.getElementById('sdCatOptions').innerHTML = html;
  changer.style.display = '';
}

async function changeSongCat(songId, newCat) {
  const s = songs.find(x => x.id === songId);
  if (!s || s.cat === newCat) return;
  const oldCat = _catLabel(s.cat);
  s.cat = newCat;
  localStorage.setItem('songs', JSON.stringify(songs));
  showToast(`Moved to ${_catLabel(newCat)} âœ“`);
  // Sync to server
  try {
    const userEmail = (gUser && gUser.email) ? gUser.email : '';
    const resp = await fetch(SONGS_API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify({ action: 'update', email: userEmail, song: s })
    });
    const data = await resp.json();
    if (!data.success) showToast('âš ï¸ Sync failed: ' + (data.error || ''));
  } catch(e) { console.error('Cat change sync error:', e); }
  refreshSongDetail();
}

function closeSongDetail() {
  _persistCurrentAudio(); // Keep audio playing if active
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-' + _songDetailPrevScreen).classList.add('active');
  _currentSongId = null;
  // Re-show now-playing bar if audio is still playing
  if (_playingSongId && _persistentAudio && !_persistentAudio.paused) {
    _updateNowPlayingBar(true);
  }
  // Refresh song list to show/hide now-playing indicator
  if (_songDetailPrevScreen === 'songs') {
    setTimeout(() => _updateSongListIndicator(), 50);
  }
}

function openEditSongFromDetail() {
  if (!hasPermission('songs')) { showToast('Songs admin access required'); return; }
  if (_currentSongId) openEditSong(_currentSongId);
}

function deleteSongFromDetail() {
  if (!hasPermission('songs')) { showToast('Songs admin access required'); return; }
  if (!_currentSongId) return;
  const s = songs.find(x => x.id === _currentSongId);
  if (!s) return;
  if (!confirm('Delete "' + s.title + '"?')) return;
  const deletedId = _currentSongId;
  songs = songs.filter(x => x.id !== _currentSongId);
  localStorage.setItem('songs', JSON.stringify(songs));
  closeSongDetail();
  renderSongs();
  showToast('Deletingâ€¦');
  // Sync delete to Google Sheets
  const userEmail = (gUser && gUser.email) ? gUser.email : '';
  fetch(SONGS_API_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain' },
    body: JSON.stringify({ action: 'delete', email: userEmail, songId: deletedId })
  }).then(r => r.json()).then(data => {
    showToast(data.success ? 'Song deleted from shared library' : 'âš ï¸ ' + (data.error || 'Delete failed'));
  }).catch(e => { console.error('Sheet delete error:', e); });
}


// ---- Kirtan search ----
function kirtanSearch(q) {
  const clearBtn = document.getElementById('kirtanClearBtn');
  if (clearBtn) clearBtn.style.display = q ? '' : 'none';
  const dd = document.getElementById('kirtanDropdown');
  if (!q.trim()) { dd.classList.remove('open'); dd.innerHTML = ''; return; }
  const ql = q.trim().toLowerCase();
  const matches = songs.filter(s =>
    (s.title||'').toLowerCase().includes(ql) ||
    (s.officialName||'').toLowerCase().includes(ql) ||
    (s.author||'').toLowerCase().includes(ql) ||
    (s.book||'').toLowerCase().includes(ql) ||
    (s.lyrics||'').toLowerCase().includes(ql) ||
    (s.trans||'').toLowerCase().includes(ql) ||
    (songLang !== 'en' && _songTitle(s).includes(ql))
  ).slice(0, 12);

  if (!matches.length) {
    dd.innerHTML = `<div class="kd-empty">No songs found for "${q}"</div>`;
  } else {
    dd.innerHTML = matches.map(s => {
      const escaped = ql.replace(/[.*+?^${}()|\[\]\\]/g, '\\$&');
      const hl = t => (t||'').replace(new RegExp('(' + escaped + ')', 'gi'), '<mark>$1</mark>');
      const meta = [s.author, s.book].filter(Boolean).join(' Â· ');
      const displayTitle = _songTitle(s);
      return `<div class="kd-item" onmousedown="kirtanSelectFromDropdown(${s.id})">
        <div class="kd-icon">${s.i}</div>
        <div class="kd-info">
          <div class="kd-title">${hl(displayTitle)}</div>
          ${s.officialName ? `<div class="kd-meta" style="color:var(--accent-gold)">${hl(s.officialName)}</div>` : ''}
          <div class="kd-meta">${meta}</div>
        </div>
      </div>`;
    }).join('');
  }
  dd.classList.add('open');
}

function kirtanSelectFromDropdown(id) {
  kirtanHideDropdown();
  document.getElementById('kirtanSearchInp').value = '';
  document.getElementById('kirtanClearBtn').style.display = 'none';
  openSongDetail(id);
}

function kirtanHideDropdown() {
  const dd = document.getElementById('kirtanDropdown');
  if (dd) { dd.classList.remove('open'); }
}

function kirtanClear() {
  document.getElementById('kirtanSearchInp').value = '';
  document.getElementById('kirtanClearBtn').style.display = 'none';
  kirtanHideDropdown();
  renderSongs();
}

// ---- Edit song ----
function openEditSong(id) {
  const s = songs.find(s => s.id === id);
  if (!s) return;
  // Reuse admin modal, pre-fill all fields
  _audioFieldsShown = 1;
  for (let i = 1; i < 5; i++) document.getElementById('aRow'+i).style.display='none';
  document.getElementById('addAudioBtn').style.display = '';
  document.getElementById('adminSongModal').classList.add('open');
  document.querySelector('#adminSongModal .modal-title').textContent = 'âœï¸ Edit Song';
  document.getElementById('aSongTitle').value = s.title || '';
  document.getElementById('aSongOfficialName').value = s.officialName || '';
  document.getElementById('aSongAuthor').value = s.author || '';
  document.getElementById('aSongCat').value = s.cat || 'vbhajan';
  document.getElementById('aSongBook').value = s.book || '';
  document.getElementById('aSongLang').value = s.lang || 'Sanskrit';
  _setRteHtml('aSongLyrics', s.lyrics || '');
  _setRteHtml('aSongTrans', s.trans || '');
  // Fill audio fields
  const audios = s.audios || (s.audio ? [{url:s.audio,singer:''}] : []);
  audios.forEach((a, i) => {
    if (i > 0) { document.getElementById('aRow'+i).style.display=''; _audioFieldsShown = i+1; }
    const urlEl = document.querySelector('.a-url[data-idx="'+i+'"]');
    const singerEl = document.querySelector('.a-singer[data-idx="'+i+'"]');
    if (urlEl) urlEl.value = a.url || '';
    if (singerEl) singerEl.value = a.singer || '';
  });
  // Store editing id on modal
  document.getElementById('adminSongModal').dataset.editId = id;
}

function deleteSong(id) {
  const s = songs.find(s => s.id === id);
  if (!s) return;
  if (!confirm('Delete "' + s.title + '"?')) return;
  songs = songs.filter(s => s.id !== id);
  localStorage.setItem('songs', JSON.stringify(songs));
  renderSongs();
  showToast('Deletingâ€¦');
  // Sync delete to Google Sheets
  const userEmail = (gUser && gUser.email) ? gUser.email : '';
  fetch(SONGS_API_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain' },
    body: JSON.stringify({ action: 'delete', email: userEmail, songId: id })
  }).then(r => r.json()).then(data => {
    showToast(data.success ? 'Song deleted from shared library' : 'âš ï¸ ' + (data.error || 'Delete failed'));
  }).catch(e => { console.error('Sheet delete error:', e); });
}


function toggleEvtMore(uid) {
  const btn   = document.getElementById(uid);
  const lbl   = document.getElementById(uid + 'lbl');
  const rows  = btn.parentElement.querySelectorAll('.evt-extra');
  const open  = btn.classList.toggle('open');
  rows.forEach(r => r.classList.toggle('visible', open));
  const count = rows.length;
  lbl.textContent = open ? 'Show less' : `+ ${count} more`;
}
// ===================================================================
// EVENTS
// ===================================================================
function openAddEvt() {
  if (!isSignedIn()) { requireSignIn('My Events'); return; }
  const el = document.getElementById('evtDay');
  if (el.options.length<=1) for(let d=1;d<=31;d++) el.innerHTML+=`<option value="${d}">${d}</option>`;
  document.getElementById('addEvtModal').classList.add('open');
}

function saveEvt() {
  const name = document.getElementById('evtName').value.trim();
  const day = document.getElementById('evtDay').value;
  const month = document.getElementById('evtMonth').value;
  if (!name||!day||month==='') { showToast('Fill required fields'); return; }
  const evt = {
    id: Date.now(), name, day:parseInt(day), month:parseInt(month),
    year: document.getElementById('evtYear').value||null,
    type: document.getElementById('evtType').value,
    notes: document.getElementById('evtNotes').value.trim(),
    reminder: document.getElementById('evtReminder').checked
  };
  customEvts.push(evt);
  localStorage.setItem('customEvts', JSON.stringify(customEvts));
  closeModal('addEvtModal');
  renderEvts();
  renderCalendar();
  if (selDate) renderDayDetail(selDate);
  showToast('Event saved! âœ¨');
  ['evtName','evtYear','evtNotes'].forEach(id => document.getElementById(id).value='');
}

function renderEvts() {
  const c = document.getElementById('evtList');
  if (!customEvts.length) {
    c.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ðŸŒ¸</div>No events yet.<br>Add birthdays, ceremonies and more.</div>';
    return;
  }
  c.innerHTML = customEvts.map(e => `
    <div class="evt-card">
      <div class="evt-emoji">${evtIcon(e.type)}</div>
      <div class="evt-info">
        <div class="evt-name-text">${e.name}</div>
        <div class="evt-type-badge">${evtTypeLabel(e.type)}</div>
        <div class="evt-date">${MONTHS_SHORT[e.month]} ${e.day}${e.year?', '+e.year:''}</div>
        ${e.reminder?'<span style="font-size:0.65rem;color:#27ae60;">ðŸ”” Reminder</span>':''}
      </div>
      <button class="evt-del" onclick="delEvt(${e.id})">ðŸ—‘</button>
    </div>`).join('');
}

function delEvt(id) {
  customEvts = customEvts.filter(e => e.id!==id);
  localStorage.setItem('customEvts', JSON.stringify(customEvts));
  renderEvts();
  renderCalendar();
}

function exportEvts() {
  const blob = new Blob([JSON.stringify({events:customEvts,exported:new Date().toISOString()},null,2)],{type:'application/json'});
  const a = document.createElement('a'); a.href=URL.createObjectURL(blob);
  a.download='vaishnava-events.json'; a.click();
  showToast('Backup exported ðŸ“¤');
}

function importEvts() {
  const inp = document.createElement('input'); inp.type='file'; inp.accept='.json';
  inp.onchange = e => {
    const r = new FileReader();
    r.onload = x => {
      try {
        const data = JSON.parse(x.result);
        if (data.events) { customEvts=data.events; localStorage.setItem('customEvts',JSON.stringify(customEvts)); renderEvts(); showToast(`Imported ${data.events.length} events âœ…`); }
      } catch { showToast('Invalid file'); }
    };
    r.readAsText(e.target.files[0]);
  };
  inp.click();
}

// ===================================================================
// GOOGLE SIGN-IN & DRIVE SYNC
// ===================================================================
// IMPORTANT: Replace this with your actual Google OAuth Client ID
// from https://console.cloud.google.com
const G_CLIENT_ID = '627226616536-9l5776odpoa57mkoev2scqevqn15oq93.apps.googleusercontent.com';
const G_DRIVE_SCOPE = 'https://www.googleapis.com/auth/drive.appdata';
const G_DRIVE_FILE_NAME = 'iskcon-calendar-sync.json';

let gUser = null;         // current signed-in user
let gAccessToken = null;  // OAuth access token
let gDriveFileId = null;  // Drive file ID once found/created

// Called by Google Identity Services once library loads
function initGoogleSignIn() {
  if (!window.google || !G_CLIENT_ID || G_CLIENT_ID.includes('YOUR_GOOGLE')) {
    // Not configured yet â€” show placeholder
    const wrap = document.getElementById('g_signin_btn');
    if (wrap) wrap.innerHTML = '<div style="font-size:0.75rem;color:var(--text3);padding:8px;background:rgba(255,255,255,0.04);border-radius:8px;text-align:center;">âš™ï¸ Google Sign-In needs Client ID setup<br><span style="font-size:0.68rem;opacity:0.7">See the setup guide below</span></div>';
    return;
  }

  // Restore saved user immediately (show UI without waiting for token)
  const savedUser = localStorage.getItem('gUser');
  if (savedUser) {
    try {
      gUser = JSON.parse(savedUser);
      updateGoogleUI(true);
    } catch(e) { localStorage.removeItem('gUser'); }
  }

  google.accounts.id.initialize({
    client_id: G_CLIENT_ID,
    callback: onGoogleSignIn,
    auto_select: true
  });
  google.accounts.id.renderButton(
    document.getElementById('g_signin_btn'),
    { theme: 'filled_blue', size: 'large', shape: 'rectangular', text: 'signin_with', width: 280 }
  );

  // Only show One Tap prompt if user is NOT already signed in
  if (!savedUser) {
    google.accounts.id.prompt();
  }
  // For returning users, token is fetched on-demand when they sync (gSyncAll handles this)
}

// Silently get a fresh Drive access token without showing consent popup
function _silentTokenRefresh() {
  if (!gUser || !window.google || !google.accounts.oauth2) return;
  try {
    const client = google.accounts.oauth2.initTokenClient({
      client_id: G_CLIENT_ID,
      scope: G_DRIVE_SCOPE,
      callback: (tokenResp) => {
        if (tokenResp.error) {
          console.log('[Auth] Silent token refresh failed:', tokenResp.error);
          // Don't force re-auth â€” user can manually sync when needed
          return;
        }
        gAccessToken = tokenResp.access_token;
        console.log('[Auth] Token refreshed silently');
      }
    });
    // prompt: '' means try silent/automatic, no popup
    client.requestAccessToken({ prompt: '' });
  } catch(e) {
    console.log('[Auth] Silent refresh error:', e.message);
  }
}

function onGoogleSignIn(response) {
  // Decode JWT credential
  const parts = response.credential.split('.');
  const payload = JSON.parse(atob(parts[1].replace(/-/g,'+').replace(/_/g,'/')));
  gUser = { name: payload.name, email: payload.email, picture: payload.picture };
  localStorage.setItem('gUser', JSON.stringify(gUser));

  // Now get access token for Drive API
  const client = google.accounts.oauth2.initTokenClient({
    client_id: G_CLIENT_ID,
    scope: G_DRIVE_SCOPE,
    callback: (tokenResp) => {
      if (tokenResp.error) { showGoogleError('Drive access denied: ' + tokenResp.error); return; }
      gAccessToken = tokenResp.access_token;
      updateGoogleUI(true);
      // Auto-sync on first sign-in
      gSyncAll();
    }
  });
  client.requestAccessToken({ prompt: '' });
}

function updateGoogleUI(signedIn) {
  const out = document.getElementById('gSignedOut');
  const inn = document.getElementById('gSignedIn');
  if (!out || !inn) return;

  if (signedIn && gUser) {
    out.style.display = 'none';
    inn.style.display = '';
    document.getElementById('gUserName').textContent = gUser.name || '';
    document.getElementById('gUserEmail').textContent = gUser.email || '';
    const av = document.getElementById('gUserAvatar');
    if (av && gUser.picture) av.src = gUser.picture;

    // Update Events & Notes boxes
    const evtMsg = document.getElementById('evtBackupMsg');
    if (evtMsg) evtMsg.innerHTML = `<strong>Signed in as ${gUser.email}</strong> â€” events sync to Google Drive.`;
    const evtBtn = document.getElementById('evtGoogleBtn');
    if (evtBtn) { evtBtn.textContent = 'â†» Sync'; evtBtn.onclick = gSyncAll; }
    const notesMsg = document.getElementById('notesBackupMsg');
    if (notesMsg) notesMsg.innerHTML = `<strong>Signed in as ${gUser.email}</strong> â€” notes sync to Google Drive.`;
    const notesBtn = document.getElementById('notesGoogleBtn');
    if (notesBtn) { notesBtn.textContent = 'â†» Sync'; notesBtn.onclick = gSyncAll; }
  } else {
    out.style.display = '';
    inn.style.display = 'none';
  }
  // Update admin panel visibility and song button visibility
  updateAdminUI();
  // Also update home screen Google UI
  if (typeof updateHomeGoogleUI === 'function') updateHomeGoogleUI();
}

function gSignOut() {
  if (window.google) google.accounts.id.disableAutoSelect();
  gUser = null; gAccessToken = null; gDriveFileId = null;
  localStorage.removeItem('gUser');
  updateGoogleUI(false);
  updateAdminUI();
  showToast('Signed out');
}

function showGoogleError(msg) {
  const el = document.getElementById('gSignInError');
  if (el) { el.textContent = msg; el.style.display = ''; }
  console.error('Google error:', msg);
}

// ===== ADMIN MANAGEMENT =====
function updateAdminUI() {
  const panel = document.getElementById('adminPanelSection');
  if (!panel) return;
  // Only super admin sees admin panel
  if (isSuperAdmin()) {
    panel.style.display = '';
    renderAdminList();
  } else {
    panel.style.display = 'none';
  }
  // Show/hide song add button and edit/delete buttons based on songs permission
  const songAddBtn = document.querySelector('.kirtan-add-btn');
  if (songAddBtn) songAddBtn.style.display = hasPermission('songs') ? '' : 'none';
  const songEditBtn = document.querySelector('.song-edit-btn');
  if (songEditBtn) songEditBtn.style.display = hasPermission('songs') ? '' : 'none';
  const songDelBtns = document.querySelectorAll('.song-del-btn');
  songDelBtns.forEach(b => b.style.display = hasPermission('songs') ? '' : 'none');
  // Update dham admin UI
  updateDhamAdminUI();
}

function renderAdminList() {
  const list = _getAdminList();
  const perms = _getAdminPermissions();
  const el = document.getElementById('adminEmailList');
  if (!el) return;
  el.innerHTML = list.map(email => {
    const isSelf = email.toLowerCase() === SUPER_ADMIN_EMAIL.toLowerCase();
    const userPerms = perms[email.toLowerCase()];
    let permTags = '';
    if (!isSelf) {
      if (!userPerms || userPerms.includes('songs')) permTags += '<span class="admin-perm-tag perm-songs">Songs</span>';
      if (!userPerms || userPerms.includes('dhamas')) permTags += '<span class="admin-perm-tag perm-dhamas">Dhamas</span>';
      if (!userPerms || userPerms.includes('sevakart')) permTags += '<span class="admin-perm-tag perm-sevakart">SevaKart</span>';
      if (!userPerms || userPerms.includes('prayer')) permTags += '<span class="admin-perm-tag perm-prayer">Prayer</span>';
      if (userPerms && userPerms.includes('users')) permTags += '<span class="admin-perm-tag perm-users">Users</span>';
    }
    return `<div class="admin-email-row">
      <div style="flex:1;min-width:0;">
        <div style="display:flex;align-items:center;gap:4px;">
          <span style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${email}</span>
          ${isSelf ? '<span class="admin-super">SUPER ADMIN</span>' : ''}
        </div>
        ${!isSelf && permTags ? '<div class="admin-perm-tags">'+permTags+'</div>' : ''}
      </div>
      ${!isSelf ? `<button class="admin-remove-btn" onclick="removeAdmin('${email}')">Remove</button>` : ''}
    </div>`;
  }).join('');
}

function addAdmin() {
  if (!isSuperAdmin()) { showToast('Only super admin can manage admins'); return; }
  const input = document.getElementById('adminAddInput');
  const email = input.value.trim().toLowerCase();
  if (!email || !email.includes('@')) { showToast('Enter a valid email'); return; }
  const list = _getAdminList();
  if (list.map(e => e.toLowerCase()).includes(email)) { showToast('Already an admin'); return; }
  // Get selected permissions
  const selectedPerms = [];
  if (document.getElementById('permSongs').checked) selectedPerms.push('songs');
  if (document.getElementById('permDhamas').checked) selectedPerms.push('dhamas');
  if (document.getElementById('permSevakart').checked) selectedPerms.push('sevakart');
  if (document.getElementById('permPrayer').checked) selectedPerms.push('prayer');
  if (document.getElementById('permUsers').checked) selectedPerms.push('users');
  if (!selectedPerms.length) { showToast('Select at least one permission'); return; }
  // Save admin
  list.push(email);
  _saveAdminList(list);
  // Save permissions
  const allPerms = _getAdminPermissions();
  allPerms[email] = selectedPerms;
  _saveAdminPermissions(allPerms);
  input.value = '';
  renderAdminList();
  showToast('Admin added âœ“');
}

function removeAdmin(email) {
  if (!isSuperAdmin()) return;
  if (email.toLowerCase() === SUPER_ADMIN_EMAIL.toLowerCase()) { showToast('Cannot remove super admin'); return; }
  if (!confirm('Remove admin rights for ' + email + '?')) return;
  let list = _getAdminList().filter(e => e.toLowerCase() !== email.toLowerCase());
  _saveAdminList(list);
  // Also remove permissions
  const perms = _getAdminPermissions();
  delete perms[email.toLowerCase()];
  _saveAdminPermissions(perms);
  renderAdminList();
  showToast('Admin removed');
}

function exportSharedEvtInfo() {
  const data = {};
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key.startsWith('evtInfo:')) {
      data[key.replace('evtInfo:', '')] = localStorage.getItem(key);
    }
  }
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'event-info-export.json';
  a.click();
  URL.revokeObjectURL(a.href);
  showToast('Event info exported');
}

function importSharedEvtInfo() {
  const inp = document.createElement('input');
  inp.type = 'file'; inp.accept = '.json';
  inp.onchange = (e) => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (ev) => {
      try {
        const data = JSON.parse(ev.target.result);
        let count = 0;
        for (const [key, val] of Object.entries(data)) {
          if (val && typeof val === 'string') {
            localStorage.setItem('evtInfo:' + key, val);
            count++;
          }
        }
        showToast(`Imported info for ${count} events âœ“`);
      } catch(err) { showToast('Invalid file format'); }
    };
    reader.readAsText(file);
  };
  inp.click();
}

// ---- Drive Sync ----
async function gFindOrCreateFile() {
  if (gDriveFileId) return gDriveFileId;
  // Search for existing file
  const q = encodeURIComponent(`name='${G_DRIVE_FILE_NAME}' and spaces='appDataFolder'`);
  const r = await fetch(`https://www.googleapis.com/drive/v3/files?q=${q}&spaces=appDataFolder&fields=files(id,name)`, {
    headers: { Authorization: 'Bearer ' + gAccessToken }
  });
  const data = await r.json();
  if (data.files && data.files.length) {
    gDriveFileId = data.files[0].id;
  } else {
    // Create new file in appDataFolder (hidden, app-only)
    const meta = { name: G_DRIVE_FILE_NAME, parents: ['appDataFolder'] };
    const cr = await fetch('https://www.googleapis.com/drive/v3/files?fields=id', {
      method: 'POST',
      headers: { Authorization: 'Bearer ' + gAccessToken, 'Content-Type': 'application/json' },
      body: JSON.stringify(meta)
    });
    const cd = await cr.json();
    gDriveFileId = cd.id;
  }
  return gDriveFileId;
}

async function gSyncAll() {
  // If no token but user is signed in, try to get a fresh token first
  if (!gAccessToken && gUser && window.google && google.accounts.oauth2) {
    try {
      const statusEl = document.getElementById('gSyncStatus');
      if (statusEl) statusEl.textContent = 'âŸ³ Getting tokenâ€¦';
      await new Promise((resolve, reject) => {
        const client = google.accounts.oauth2.initTokenClient({
          client_id: G_CLIENT_ID,
          scope: G_DRIVE_SCOPE,
          callback: (tokenResp) => {
            if (tokenResp.error) { reject(new Error(tokenResp.error)); return; }
            gAccessToken = tokenResp.access_token;
            resolve();
          }
        });
        client.requestAccessToken({ prompt: '' });
        // Timeout after 8 seconds
        setTimeout(() => reject(new Error('timeout')), 8000);
      });
    } catch(e) {
      showToast('Session expired â€” please sign in again via the button below');
      return;
    }
  }
  if (!gAccessToken) { showToast('Please sign in first'); return; }
  const statusEl = document.getElementById('gSyncStatus');
  const detailEl = document.getElementById('gSyncDetails');
  if (statusEl) statusEl.textContent = 'âŸ³ Syncingâ€¦';

  try {
    const fileId = await gFindOrCreateFile();

    // Read remote data first
    const getR = await fetch(`https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`, {
      headers: { Authorization: 'Bearer ' + gAccessToken }
    });

    let remote = { notes: [], events: [], songs: [], lastSync: null };
    if (getR.ok) {
      try { remote = await getR.json(); } catch(e) {}
    }

    // Merge strategy: last-write wins by id, newest items survive
    const mergedNotes  = mergeById(notes,       remote.notes  || []);
    const mergedEvents = mergeById(customEvts,   remote.events || []);

    // Save merged back to local
    notes      = mergedNotes;
    customEvts = mergedEvents;
    localStorage.setItem('notes',      JSON.stringify(notes));
    localStorage.setItem('customEvts', JSON.stringify(customEvts));

    // Merge admin list from remote (so admins added on one device appear on others)
    if (remote.adminEmails && Array.isArray(remote.adminEmails)) {
      const currentAdmins = _getAdminList();
      const mergedAdmins = [...new Set([...currentAdmins, ...remote.adminEmails].map(e => e.toLowerCase()))];
      _saveAdminList(mergedAdmins);
    }
    // Merge admin permissions from remote
    if (remote.adminPermissions && typeof remote.adminPermissions === 'object') {
      const currentPerms = _getAdminPermissions();
      const mergedPerms = { ...currentPerms, ...remote.adminPermissions };
      _saveAdminPermissions(mergedPerms);
    }

    // Re-render whatever is visible
    renderNotes();
    renderEvts();
    // Songs are managed via Google Sheets â€” refresh them
    fetchSharedSongs();

    // Upload merged data to Drive (notes & events only)
    const payload = JSON.stringify({
      notes: mergedNotes, events: mergedEvents,
      adminEmails: _getAdminList(),
      adminPermissions: _getAdminPermissions(),
      lastSync: new Date().toISOString(), device: navigator.userAgent.split(' ').slice(-2).join(' ')
    });

    await fetch(`https://www.googleapis.com/upload/drive/v3/files/${fileId}?uploadType=media`, {
      method: 'PATCH',
      headers: { Authorization: 'Bearer ' + gAccessToken, 'Content-Type': 'application/json' },
      body: payload
    });

    const now = new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
    if (statusEl) statusEl.textContent = `âœ“ Synced at ${now}`;
    if (detailEl) detailEl.textContent = `${mergedNotes.length} notes Â· ${mergedEvents.length} events Â· ${songs.length} songs`;
    updateAdminUI();
    showToast('âœ“ Synced to Google Drive');

  } catch(e) {
    console.error('Sync error:', e);
    if (statusEl) statusEl.textContent = 'âœ— Sync failed';
    showToast('Sync failed â€” check connection');
  }
}

function mergeById(local, remote) {
  const map = new Map();
  // Remote first, then local overwrites (local = most recent edits)
  [...(remote||[]), ...(local||[])].forEach(item => {
    if (item && item.id) map.set(item.id, item);
  });
  return [...map.values()].sort((a,b) => (b.id||0) - (a.id||0));
}

// Restore user session on load
function restoreGoogleSession() {
  const saved = localStorage.getItem('gUser');
  if (saved) {
    try {
      gUser = JSON.parse(saved);
      updateGoogleUI(true);
      // Note: access token is not persisted (security), user needs to re-auth for sync
      // But UI shows them as signed in
      const statusEl = document.getElementById('gSyncStatus');
      if (statusEl) statusEl.textContent = 'Tap "Sync Now" to refresh token & sync';
    } catch(e) {}
  }
}

function signInG() {
  // Legacy - redirect to settings
  switchScreen('settings');
  showToast('Sign in via Settings â†’ Google Account');
}

// ===================================================================
// SETTINGS
// ===================================================================
const LOC_REGIONS = [
  { label: 'ðŸ‡®ðŸ‡³  India', filter: l => l.country === 'India' },
  { label: 'ðŸ‡ºðŸ‡¸  USA', filter: l => l.country === 'USA' },
  { label: 'ðŸ‡¬ðŸ‡§  UK & Europe', filter: l => ['UK','France','Netherlands','Germany','Spain','Switzerland','Russia','Sweden','Poland'].includes(l.country) },
  { label: 'ðŸŒ  Middle East & Africa', filter: l => ['UAE','Saudi Arabia','S. Africa','Kenya','Mauritius'].includes(l.country) },
  { label: 'ðŸŒ  Asia-Pacific', filter: l => ['Singapore','Malaysia','Indonesia','Thailand','Hong Kong','Japan','Australia','New Zealand'].includes(l.country) },
  { label: 'ðŸŒŽ  Americas', filter: l => ['Canada','Brazil','Argentina','Mexico'].includes(l.country) },
];

function _buildLocGroupedHtml(filtered) {
  if (!filtered.length) return '<div style="color:var(--text3);font-size:0.8rem;padding:12px;text-align:center;">No results</div>';
  let html = '';
  const isSearching = filtered.length < LOCS.length;
  LOC_REGIONS.forEach((region, ri) => {
    const cities = filtered.filter(region.filter);
    if (!cities.length) return;
    const openClass = isSearching ? 'open' : (ri === 0 ? 'open' : '');
    html += `<div class="loc-region-hdr ${openClass}" onclick="toggleLocRegion(this)">
      <span class="region-label">${region.label}</span>
      <span class="region-arrow">â€º</span>
    </div>
    <div class="loc-region-body ${openClass}">
      ${cities.map(l => `<div class="loc-opt ${l.key===curLoc.key?'sel':''}" onclick="setLoc('${l.key}')">
        <div><div class="loc-name">${l.name}</div><div class="loc-country">${l.country}</div></div>
        <span class="loc-check">âœ“</span>
      </div>`).join('')}
    </div>`;
  });
  return html;
}

function toggleLocRegion(hdr) {
  hdr.classList.toggle('open');
  const body = hdr.nextElementSibling;
  if (body) body.classList.toggle('open');
}

function renderLocGrid(filter) {
  const q = (filter||'').toLowerCase();
  const filtered = q ? LOCS.filter(l =>
    l.name.toLowerCase().includes(q) || l.country.toLowerCase().includes(q)
  ) : LOCS;
  const html = _buildLocGroupedHtml(filtered);
  const els = document.querySelectorAll('#locGridSettings, #modalLocGrid');
  els.forEach(el => { if(el) el.innerHTML = html; });
  const nameEl = document.getElementById('curLocName');
  if (nameEl) nameEl.textContent = curLoc.name;
}

function filterLocGrid(q, gridId) {
  const filtered = q ? LOCS.filter(l =>
    l.name.toLowerCase().includes(q.toLowerCase()) ||
    l.country.toLowerCase().includes(q.toLowerCase())
  ) : LOCS;
  const html = _buildLocGroupedHtml(filtered);
  const el = document.getElementById(gridId);
  if (el) el.innerHTML = html;
}

function setLoc(key) {
  curLoc = LOCS.find(l=>l.key===key)||LOCS[0];
  const calLocEl = document.getElementById('calLocName');
  if (calLocEl) calLocEl.textContent = curLoc.name + ', ' + curLoc.country;
  localStorage.setItem('loc', key);
  renderLocGrid();
  if (selDate) renderDayDetail(selDate);
  closeModal('locModal');
  const nameEl = document.getElementById('curLocName');
  if (nameEl) nameEl.textContent = curLoc.name;
  showToast(`ðŸ“ Location: ${curLoc.name}`);
}

async function geocodeCity() {
  const q = document.getElementById('customLocInput').value.trim();
  if (!q) { showGeoStatus('Please enter a city name', 'error'); return; }

  const btn = document.getElementById('geoBtn');
  const statusEl = document.getElementById('geoStatus');
  const resultsEl = document.getElementById('geoResults');

  btn.disabled = true;
  btn.textContent = 'â€¦';
  resultsEl.innerHTML = '';
  showGeoStatus('Searching...', 'loading');

  try {
    const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(q)}&format=json&limit=5&addressdetails=1`;
    const res = await fetch(url, { headers: { 'Accept-Language': 'en' } });
    if (!res.ok) throw new Error('Network error');
    const data = await res.json();

    if (!data.length) {
      showGeoStatus('No results found. Try a different spelling.', 'error');
    } else {
      showGeoStatus(`${data.length} result${data.length>1?'s':''} found â€” tap one to select:`, '');
      resultsEl.innerHTML = data.map((r,i) => {
        const a = r.address || {};
        const city = a.city || a.town || a.village || a.county || r.name;
        const state = a.state || '';
        const country = a.country || '';
        const label = [city, state, country].filter(Boolean).join(', ');
        const lat = parseFloat(r.lat).toFixed(4);
        const lon = parseFloat(r.lon).toFixed(4);
        return `<div class="geo-result-item" onclick="selectGeoResult(${r.lat},${r.lon},'${escGeo(city)}','${escGeo(country)}')">
          <div class="geo-result-name">${escGeo(label) || r.display_name.split(',').slice(0,2).join(',')}</div>
          <div class="geo-result-detail">${escGeo(r.display_name)}</div>
          <div class="geo-result-coords">Lat: ${lat} Â· Lon: ${lon} Â· Tap to select &amp; auto-detect timezone</div>
        </div>`;
      }).join('');
    }
  } catch(e) {
    showGeoStatus('Search failed. Check your internet connection.', 'error');
  }
  btn.disabled = false;
  btn.textContent = 'Search';
}

function escGeo(s) {
  return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/'/g,'&#39;');
}

function showGeoStatus(msg, cls) {
  const el = document.getElementById('geoStatus');
  if (!el) return;
  el.textContent = msg;
  el.className = 'geo-status' + (cls ? ' ' + cls : '');
}

async function selectGeoResult(lat, lon, cityName, country) {
  const flatLat = parseFloat(lat), flatLon = parseFloat(lon);

  showGeoStatus('Getting timezoneâ€¦', 'loading');
  document.querySelectorAll('.geo-result-item').forEach(el => el.style.pointerEvents='none');

  // Use timeapi.io to get the exact UTC offset including DST
  let tzOffset = getTzFromCoords(flatLat, flatLon); // fallback
  try {
    const tzRes = await fetch(
      `https://timeapi.io/api/timezone/coordinate?latitude=${flatLat}&longitude=${flatLon}`
    );
    if (tzRes.ok) {
      const tzData = await tzRes.json();
      // currentUtcOffset.seconds gives exact offset including DST
      if (tzData.currentUtcOffset && tzData.currentUtcOffset.seconds !== undefined) {
        tzOffset = tzData.currentUtcOffset.seconds / 3600;
      } else if (tzData.utcOffset) {
        // Parse "+10:30" or "-05:00" format
        const m = tzData.utcOffset.match(/([+-])(\d{2}):(\d{2})/);
        if (m) tzOffset = (m[1]==='-'?-1:1) * (parseInt(m[2]) + parseInt(m[3])/60);
      }
    }
  } catch(e) {
    // Silently fall back to longitude-based estimate
    console.warn('TZ lookup failed, using longitude estimate:', e);
  }

  curLoc = {
    key: 'custom',
    name: cityName || 'Custom',
    country: country || 'Custom',
    lat: flatLat,
    lon: flatLon,
    tz: tzOffset
  };
  localStorage.setItem('loc', 'custom');
  localStorage.setItem('customLocData', JSON.stringify(curLoc));

  // Update UI
  const nameEl = document.getElementById('curLocName');
  if (nameEl) nameEl.textContent = curLoc.name + (country ? ', ' + country : '');
  const calLocEl = document.getElementById('calLocName');
  if (calLocEl) calLocEl.textContent = curLoc.name + ', ' + curLoc.country;

  document.getElementById('geoResults').innerHTML = '';
  document.getElementById('customLocInput').value = '';
  showGeoStatus('', '');

  renderCalendar();
  if (selDate) renderDayDetail(selDate);
  showToast(`ðŸ“ ${curLoc.name} (UTC${tzOffset>=0?'+':''}${tzOffset})`);
}

function getTzFromCoords(lat, lon) {
  // Lookup table for major timezone offsets by longitude range
  // Covers all inhabited timezones; good enough for panchang calculations
  const zones = [
    { minLon:-180, maxLon:-157.5, tz:-11 }, // Pacific/Samoa
    { minLon:-157.5,maxLon:-127.5, tz:-10 }, // Hawaii
    { minLon:-127.5,maxLon:-112.5, tz:-8  }, // PST
    { minLon:-112.5,maxLon: -97.5, tz:-7  }, // MST
    { minLon: -97.5,maxLon: -82.5, tz:-6  }, // CST
    { minLon: -82.5,maxLon: -67.5, tz:-5  }, // EST
    { minLon: -67.5,maxLon: -52.5, tz:-4  }, // AST
    { minLon: -52.5,maxLon: -37.5, tz:-3  }, // BRT
    { minLon: -37.5,maxLon: -22.5, tz:-2  },
    { minLon: -22.5,maxLon:  -7.5, tz:-1  }, // CVT
    { minLon:  -7.5,maxLon:   7.5, tz: 0  }, // GMT/UTC
    { minLon:   7.5,maxLon:  22.5, tz: 1  }, // CET
    { minLon:  22.5,maxLon:  37.5, tz: 2  }, // EET
    { minLon:  37.5,maxLon:  52.5, tz: 3  }, // MSK/EAT
    { minLon:  52.5,maxLon:  60.0, tz: 3.5}, // Iran
    { minLon:  60.0,maxLon:  67.5, tz: 4  }, // GST
    { minLon:  67.5,maxLon:  75.0, tz: 4.5}, // AFT
    { minLon:  75.0,maxLon:  82.5, tz: 5  }, // PKT
    { minLon:  82.5,maxLon:  90.0, tz: 5.5}, // IST (India)
    { minLon:  90.0,maxLon:  97.5, tz: 6  }, // BST/BTT
    { minLon:  97.5,maxLon: 105.0, tz: 6.5}, // MMT (Myanmar)
    { minLon: 105.0,maxLon: 120.0, tz: 7  }, // ICT/WIB
    { minLon: 120.0,maxLon: 135.0, tz: 8  }, // CST/HKT
    { minLon: 135.0,maxLon: 142.5, tz: 9  }, // JST/KST
    { minLon: 142.5,maxLon: 157.5, tz:10  }, // AEST
    { minLon: 157.5,maxLon: 172.5, tz:11  }, // NCT
    { minLon: 172.5,maxLon: 180,   tz:12  }, // NZST
  ];
  const z = zones.find(z => lon >= z.minLon && lon < z.maxLon);
  return z ? z.tz : Math.round(lon / 15);
}

function setCustomLoc() { geocodeCity(); } // legacy alias

function loadNotifSettings() {
  try {
    const s = JSON.parse(localStorage.getItem('settings') || '{}');
    const adv = document.getElementById('n-advance');
    const tim = document.getElementById('n-time');
    if (adv && s['n-advance']) adv.value = s['n-advance'];
    if (tim && s['n-time']) tim.value = s['n-time'];
    syncTimeToSelects();
    ['n-ekadashi','n-festival','n-appearance','n-gayatri','n-rahu','n-custom','n-prayer'].forEach(id=>{
      const el=document.getElementById(id);
      if(el && s[id]!==undefined) el.checked=s[id];
    });
    updateNotifDescs();
  } catch(e) {}
}

function syncTimeToSelects() {
  const tim = document.getElementById('n-time');
  if (!tim) return;
  const val = tim.value || '07:00';
  const [h24, m] = val.split(':').map(Number);
  const ampm = h24 < 12 ? 'AM' : 'PM';
  let h12 = h24 === 0 ? 12 : h24 > 12 ? h24 - 12 : h24;
  const hSel = document.getElementById('n-time-hour');
  const mSel = document.getElementById('n-time-min');
  const apSel = document.getElementById('n-time-ampm');
  if (hSel) hSel.value = String(h12).padStart(2, '0');
  if (mSel) {
    // Find closest 5-min option
    const rounded = Math.round(m / 5) * 5;
    mSel.value = String(rounded === 60 ? 0 : rounded).padStart(2, '0');
  }
  if (apSel) apSel.value = ampm;
}

function syncTimeFromSelects() {
  const hSel = document.getElementById('n-time-hour');
  const mSel = document.getElementById('n-time-min');
  const apSel = document.getElementById('n-time-ampm');
  if (!hSel || !mSel || !apSel) return;
  let h12 = parseInt(hSel.value);
  const min = mSel.value;
  const ampm = apSel.value;
  let h24 = h12;
  if (ampm === 'AM') { if (h12 === 12) h24 = 0; }
  else { if (h12 !== 12) h24 = h12 + 12; }
  const tim = document.getElementById('n-time');
  if (tim) tim.value = String(h24).padStart(2, '0') + ':' + min;
  saveS();
}

function saveS() {
  const s={};
  ['n-ekadashi','n-festival','n-appearance','n-gayatri','n-rahu','n-custom','n-prayer'].forEach(id=>{
    const el=document.getElementById(id); if(el)s[id]=el.checked;
  });
  const adv = document.getElementById('n-advance');
  const tim = document.getElementById('n-time');
  if(adv) s['n-advance'] = adv.value;
  if(tim) s['n-time'] = tim.value;
  localStorage.setItem('settings',JSON.stringify(s));
  updateNotifDescs();
}

function fmtNotifTime(t) {
  if (!t) return '7:00 am';
  const [h,m] = t.split(':').map(Number);
  const ampm = h < 12 ? 'am' : 'pm';
  const h12 = h === 0 ? 12 : h > 12 ? h-12 : h;
  return `${h12}:${String(m).padStart(2,'0')} ${ampm}`;
}

function updateNotifDescs() {
  const adv = parseInt(document.getElementById('n-advance')?.value || '1');
  const tim = document.getElementById('n-time')?.value || '07:00';
  const tStr = fmtNotifTime(tim);
  const dayStr = adv === 1 ? '1 day' : `${adv} days`;
  const desc = `Alert ${dayStr} before, at ${tStr}`;
  ['ekadashi','festival','appearance','custom'].forEach(k => {
    const el = document.getElementById('desc-'+k);
    if (el) el.textContent = desc;
  });
  const gayEl = document.getElementById('desc-gayatri');
  if (gayEl) gayEl.textContent = `Remind 10 min before sunrise Â· noon Â· sunset`;
  const rahuEl = document.getElementById('desc-rahu');
  if (rahuEl) rahuEl.textContent = `Alert on the day, at start of Rahu Kalam`;
}

function openAdminSong() {
  if (!hasPermission('songs')) { showToast('Songs admin access required'); return; }
  _audioFieldsShown = 1;
  // Reset all audio rows
  for (let i = 1; i < 5; i++) document.getElementById('aRow' + i).style.display = 'none';
  document.getElementById('addAudioBtn').style.display = '';
  document.getElementById('adminSongModal').classList.add('open');
}

// ---- Rich Text Editor helpers ----
function rteCmd(cmd) {
  document.execCommand(cmd, false, null);
}
function rteColor(color) {
  document.execCommand('foreColor', false, color);
}
function rteRemoveFormat() {
  document.execCommand('removeFormat', false, null);
}
function _getRteHtml(id) {
  const el = document.getElementById(id);
  if (!el) return '';
  // Convert contenteditable HTML to storable format
  let html = el.innerHTML || '';
  // Convert <div> and <br> to newlines for storage
  html = html.replace(/<div><br\s*\/?><\/div>/gi, '\n');
  html = html.replace(/<div>/gi, '\n').replace(/<\/div>/gi, '');
  html = html.replace(/<br\s*\/?>/gi, '\n');
  // Clean up leading newline
  if (html.startsWith('\n')) html = html.substring(1);
  return html.trim();
}
function _setRteHtml(id, content) {
  const el = document.getElementById(id);
  if (!el) return;
  if (!content) { el.innerHTML = ''; return; }
  // Convert newlines to <br> for display in contenteditable
  // But preserve existing HTML tags
  el.innerHTML = content.replace(/\n/g, '<br>');
}

function adminAddSong() {
  const t = document.getElementById('aSongTitle').value.trim();
  if (!t) { showToast('Enter song title'); return; }
  // Collect up to 5 audio entries
  const audios = [];
  document.querySelectorAll('.a-url').forEach((urlEl, i) => {
    const url = urlEl.value.trim();
    if (!url) return;
    const singerEl = document.querySelector(`.a-singer[data-idx="${i}"]`);
    audios.push({ url, singer: singerEl ? singerEl.value.trim() : '' });
  });
  const catVal = document.getElementById('aSongCat').value;
  const CAT_ICONS = {vbhajan:'ðŸŒ¸',hkkirtan:'ðŸŽ¶',astakam:'ðŸ™',stotram:'ðŸ“¿',gita:'ðŸ“—',bhagavatam:'ðŸŒŠ',samhita:'ðŸ“œ'};
  const s = {
    id: Date.now(),
    title: t,
    officialName: document.getElementById('aSongOfficialName').value.trim(),
    author: document.getElementById('aSongAuthor').value.trim() || 'Traditional',
    cat: catVal, i: CAT_ICONS[catVal] || 'ðŸŽµ',
    book: document.getElementById('aSongBook').value.trim(),
    lang: document.getElementById('aSongLang').value,
    lyrics: _cleanLyrics(_getRteHtml('aSongLyrics')),
    trans: _cleanLyrics(_getRteHtml('aSongTrans')),
    audios
  };
  const editId = document.getElementById('adminSongModal').dataset.editId;
  if (editId) {
    const idx = songs.findIndex(x => x.id === parseInt(editId));
    if (idx > -1) { songs[idx] = {...songs[idx], ...s, id: songs[idx].id}; s.id = songs[idx].id; }
    delete document.getElementById('adminSongModal').dataset.editId;
    document.querySelector('#adminSongModal .modal-title').textContent = 'ðŸŽµ Add Song / Kirtan';
  } else {
    songs.push(s);
  }
  localStorage.setItem('songs', JSON.stringify(songs));
  localStorage.setItem('songsUserAdded', '1');
  closeModal('adminSongModal');
  renderSongs();
  showToast(editId ? `"${t}" updatingâ€¦ â³` : `"${t}" savingâ€¦ â³`);

  // Sync to Google Sheets
  const userEmail = (gUser && gUser.email) ? gUser.email : '';
  fetch(SONGS_API_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain' },
    body: JSON.stringify({
      action: editId ? 'update' : 'add',
      email: userEmail,
      song: s
    })
  }).then(r => r.json()).then(data => {
    if (data.success) {
      showToast(editId ? `"${t}" updated! âœï¸` : `"${t}" saved to shared library! ðŸŽµ`);
    } else {
      showToast('âš ï¸ ' + (data.error || 'Sync failed'));
    }
  }).catch(e => {
    console.error('Sheet sync error:', e);
    showToast('Saved locally â€” will sync when online');
  });

  // Clear all fields
  ['aSongTitle','aSongOfficialName','aSongAuthor','aSongBook'].forEach(id => document.getElementById(id).value = '');
  document.getElementById('aSongLyrics').innerHTML = '';
  document.getElementById('aSongTrans').innerHTML = '';
  document.getElementById('aSongLang').value = 'Sanskrit';
  document.querySelectorAll('.a-singer, .a-url').forEach(el => el.value = '');
}



// ===================================================================
// ===================================================================
// PUSH NOTIFICATIONS (Firebase Cloud Messaging)
// ===================================================================
const FIREBASE_CONFIG = {
  apiKey: "AIzaSyDEgka4rqL6_HNMWERzzggcmv0YlVVoUT8",
  authDomain: "bhaktisakhaapp1.firebaseapp.com",
  projectId: "bhaktisakhaapp1",
  storageBucket: "bhaktisakhaapp1.firebasestorage.app",
  messagingSenderId: "246206438622",
  appId: "1:246206438622:web:cbf20d06941eb82b87364f"
};
const VAPID_KEY = 'BITE4jynQCQ-wgKZ5jPWi7dgbr6Ms61Kx2llidYuNIT0EtbRtTEaGGAHtkL4-h4N_8vXnmgohwEmjt-ff5NPfQQ';

let _fcmToken = null;
let _firebaseApp = null;
let _firebaseMessaging = null;

function initFirebase() {
  try {
    if (typeof firebase === 'undefined' || !firebase.initializeApp) return;
    _firebaseApp = firebase.initializeApp(FIREBASE_CONFIG);
    _firebaseMessaging = firebase.messaging();

    // Handle foreground messages
    _firebaseMessaging.onMessage((payload) => {
      console.log('[FCM] Foreground message:', payload);
      const title = payload.notification?.title || payload.data?.title || 'ðŸ™ Bhakti Sakha';
      const body = payload.notification?.body || payload.data?.body || '';
      const sandhyaType = payload.data?.sandhyaType || '';
      const icon = sandhyaType && _sandhyaIcons[sandhyaType] ? _sandhyaIcons[sandhyaType] : null;
      // Pick color based on sandhya type
      const colorMap = {pratah:'#ff9940', madhya:'#e8c800', sayam:'#d04830'};
      const color = colorMap[sandhyaType] || '#a78bfa';
      showAlertBanner(title, body, color, icon);
    });

    // Check if already subscribed
    const savedToken = localStorage.getItem('fcmToken');
    if (savedToken) {
      _fcmToken = savedToken;
      updatePushUI(true);
      // Re-register upcoming events silently
      setTimeout(() => registerUpcomingEvents(), 3000);
    }
  } catch(e) {
    // Firebase only works on deployed site with proper scripts loaded
  }
}

async function togglePushNotifications() {
  if (_fcmToken) {
    // Already enabled â€” disable
    const tokenToUnregister = _fcmToken;  // Save before clearing
    _fcmToken = null;
    localStorage.removeItem('fcmToken');
    updatePushUI(false);
    // Unregister from server
    try {
      if (tokenToUnregister) {
        await fetch(SONGS_API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'text/plain' },
          body: JSON.stringify({ action: 'unregisterToken', token: tokenToUnregister })
        });
      }
    } catch(e) {}
    showToast('Push notifications disabled');
    return;
  }

  // Request permission
  try {
    const permission = await Notification.requestPermission();
    if (permission !== 'granted') {
      showToast('Notification permission denied. Please enable in browser settings.');
      return;
    }

    updatePushUI('loading');

    // Register Firebase messaging service worker
    const swReg = await navigator.serviceWorker.register('./firebase-messaging-sw.js');
    
    // Get FCM token
    if (!_firebaseMessaging) initFirebase();
    const token = await _firebaseMessaging.getToken({
      vapidKey: VAPID_KEY,
      serviceWorkerRegistration: swReg
    });

    if (token) {
      _fcmToken = token;
      localStorage.setItem('fcmToken', token);
      updatePushUI(true);

      // Register token + preferences with server
      await registerTokenWithServer(token);
      // Register upcoming events
      await registerUpcomingEvents();

      showToast('âœ… Push notifications enabled!');
    } else {
      showToast('Could not get notification token. Try again.');
      updatePushUI(false);
    }
  } catch(e) {
    console.error('Push notification error:', e);
    showToast('Error enabling notifications: ' + e.message);
    updatePushUI(false);
  }
}

function updatePushUI(state) {
  const btn = document.getElementById('pushNotifBtn');
  const status = document.getElementById('pushNotifStatus');
  if (!btn || !status) return;

  if (state === 'loading') {
    btn.textContent = 'â³';
    btn.disabled = true;
    status.textContent = 'Setting upâ€¦';
  } else if (state === true) {
    btn.textContent = 'Disable';
    btn.disabled = false;
    btn.style.background = 'rgba(231,76,60,0.2)';
    btn.style.color = '#e74c3c';
    status.textContent = 'âœ… Active â€” you\'ll receive phone notifications';
  } else {
    btn.textContent = 'Enable';
    btn.disabled = false;
    btn.style.background = '';
    btn.style.color = '';
    status.textContent = 'Tap to enable real phone notifications';
  }
}

async function registerTokenWithServer(token) {
  try {
    const s = JSON.parse(localStorage.getItem('settings') || '{}');
    const prefs = {
      ekadashi: document.getElementById('n-ekadashi')?.checked ?? true,
      festival: document.getElementById('n-festival')?.checked ?? true,
      appearance: document.getElementById('n-appearance')?.checked ?? true,
      custom: document.getElementById('n-custom')?.checked ?? true,
      gayatri: document.getElementById('n-gayatri')?.checked ?? false,
      rahu: document.getElementById('n-rahu')?.checked ?? false,
      prayer: document.getElementById('n-prayer')?.checked ?? true,
      alertTime: document.getElementById('n-time')?.value || '07:00',
      advance: document.getElementById('n-advance')?.value || '1'
    };
    const email = (gUser && gUser.email) ? gUser.email : 'anonymous';
    const name = (gUser && gUser.name) ? gUser.name : '';

    await fetch(SONGS_API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify({
        action: 'registerToken',
        token: token,
        email: email,
        name: name,
        prefs: prefs
      })
    });
  } catch(e) {
    console.warn('Token registration error:', e);
  }
}

async function registerUpcomingEvents() {
  if (!_fcmToken) return;
  try {
    // Compute next 14 days of events
    const upcoming = [];
    const today = new Date();
    const s = JSON.parse(localStorage.getItem('settings') || '{}');
    const gayatriOn = document.getElementById('n-gayatri')?.checked || s['n-gayatri'] || false;
    const rahuOn = document.getElementById('n-rahu')?.checked || s['n-rahu'] || false;

    for (let d = 0; d < 14; d++) {
      const dt = new Date(today);
      dt.setDate(dt.getDate() + d);
      const dateStr = `${dt.getFullYear()}-${String(dt.getMonth()+1).padStart(2,'0')}-${String(dt.getDate()).padStart(2,'0')}`;
      
      // Calendar events (ekadashi, festivals, etc.)
      const evts = getEventsForDate(dateStr);
      evts.forEach(e => {
        upcoming.push({
          date: dateStr,
          name: e.n || e.name || '',
          type: e.t || 'event',
          icon: e.i || 'ðŸ“…',
          time: '' // no specific time â€” uses user's alertTime
        });
      });

      // Gayatri / Sandhya times (precise times based on location)
      if (gayatriOn) {
        const st = getSunTimes(dt, curLoc.lat, curLoc.lon, curLoc.tz);
        if (st) {
          // 10 min before sunrise
          const srParts = st.sunrise.split(':');
          const srMins = parseInt(srParts[0]) * 60 + parseInt(srParts[1]) - 10;
          const pratahTime = `${String(Math.floor(srMins/60)).padStart(2,'0')}:${String(srMins%60).padStart(2,'0')}`;
          upcoming.push({
            date: dateStr, name: `PrÄtaá¸¥ SandhyÄ (sunrise ${st.sunrise})`,
            type: 'gayatri', sandhyaType: 'pratah', icon: 'ðŸŒ…', time: pratahTime
          });

          // 10 min before noon
          const nParts = st.noon.split(':');
          const nMins = parseInt(nParts[0]) * 60 + parseInt(nParts[1]) - 10;
          const madhyaTime = `${String(Math.floor(nMins/60)).padStart(2,'0')}:${String(nMins%60).padStart(2,'0')}`;
          upcoming.push({
            date: dateStr, name: `MÄdhyÄhnika SandhyÄ (noon ${st.noon})`,
            type: 'gayatri', sandhyaType: 'madhya', icon: 'â˜€ï¸', time: madhyaTime
          });

          // 10 min before sunset
          const ssParts = st.sunset.split(':');
          const ssMins = parseInt(ssParts[0]) * 60 + parseInt(ssParts[1]) - 10;
          const sayamTime = `${String(Math.floor(ssMins/60)).padStart(2,'0')}:${String(ssMins%60).padStart(2,'0')}`;
          upcoming.push({
            date: dateStr, name: `SÄyam SandhyÄ (sunset ${st.sunset})`,
            type: 'gayatri', sandhyaType: 'sayam', icon: 'ðŸŒ‡', time: sayamTime
          });
        }
      }

      // Rahu Kalam (notify at start)
      if (rahuOn) {
        const stR = getSunTimes(dt, curLoc.lat, curLoc.lon, curLoc.tz);
        if (stR) {
          const rahu = getRahuKalam(dt, stR.srMins, stR.ssMins);
          if (rahu && rahu.start) {
            upcoming.push({
              date: dateStr, name: `Rahu Kalam (${rahu.start} â€“ ${rahu.end})`,
              type: 'rahu', icon: 'ðŸš«', time: rahu.start
            });
          }
        }
      }
    }

    if (upcoming.length === 0) return;

    await fetch(SONGS_API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify({
        action: 'registerEvents',
        token: _fcmToken,
        events: upcoming
      })
    });
  } catch(e) {
    console.warn('Event registration error:', e);
  }
}

// Re-register when notification settings change
function onNotifSettingsChanged() {
  saveS();
  if (_fcmToken) {
    registerTokenWithServer(_fcmToken);
    registerUpcomingEvents();
  }
}

// Initialize Firebase when page loads
setTimeout(initFirebase, 1500);

// Hook notification toggles to re-register preferences
setTimeout(() => {
  ['n-ekadashi','n-festival','n-appearance','n-custom','n-gayatri','n-rahu','n-prayer','n-time','n-advance'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.addEventListener('change', () => {
      if (_fcmToken) { registerTokenWithServer(_fcmToken); registerUpcomingEvents(); }
    });
  });
}, 2000);

// DATE PICKER
// ===================================================================
const DP_MONTHS = ['January','February','March','April','May','June',
                   'July','August','September','October','November','December'];
const DP_MONTHS_SHORT = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
const DP_DAYS = ['Su','Mo','Tu','We','Th','Fr','Sa'];

let dpYear, dpMonth, dpDay;

function openDatePicker() {
  const today = selDate || new Date();
  dpYear  = today.getFullYear();
  dpMonth = today.getMonth();
  dpDay   = today.getDate();
  dpRenderAll();
  document.getElementById('dpModal').classList.add('open');
  // Scroll selected year into view after render
  setTimeout(() => {
    const selYr = document.querySelector('.dp-year-btn.sel');
    if (selYr) selYr.scrollIntoView({block:'center', behavior:'smooth'});
  }, 100);
}

function dpOverlayClick(e) {
  if (e.target === document.getElementById('dpModal')) closeModal('dpModal');
}

function dpRenderAll() {
  dpRenderYears();
  dpRenderMonths();
  dpRenderDays();
  dpUpdateHeader();
}

function dpRenderYears() {
  const grid = document.getElementById('dpYearGrid');
  const today = new Date();
  let html = '';
  for (let y = 1975; y <= 2075; y++) {
    const isSel = y === dpYear;
    const isToday = y === today.getFullYear();
    html += `<button class="dp-year-btn${isSel?' sel':''}${isToday&&!isSel?' today-dot':''}" onclick="dpSetYear(${y})">${y}</button>`;
  }
  grid.innerHTML = html;
}

function dpRenderMonths() {
  const grid = document.getElementById('dpMonthGrid');
  grid.innerHTML = DP_MONTHS_SHORT.map((m,i) =>
    `<button class="dp-month-btn${i===dpMonth?' sel':''}" onclick="dpSetMonth(${i})">${m}</button>`
  ).join('');
}

function dpRenderDays() {
  const grid = document.getElementById('dpDayGrid');
  const today = new Date();
  const firstDay = new Date(dpYear, dpMonth, 1).getDay();
  const daysInMonth = new Date(dpYear, dpMonth+1, 0).getDate();

  // Day headers
  let html = DP_DAYS.map(d => `<div class="dp-day-hdr">${d}</div>`).join('');

  // Empty cells before first day
  for (let i = 0; i < firstDay; i++) html += `<button class="dp-day-btn empty"></button>`;

  // Day cells
  for (let d = 1; d <= daysInMonth; d++) {
    const isSel = d === dpDay;
    const isToday = d === today.getDate() && dpMonth === today.getMonth() && dpYear === today.getFullYear();
    html += `<button class="dp-day-btn${isSel?' sel':''}${isToday&&!isSel?' today-dot':''}" onclick="dpSetDay(${d})">${d}</button>`;
  }
  grid.innerHTML = html;
}

function dpUpdateHeader() {
  const maxDay = new Date(dpYear, dpMonth+1, 0).getDate();
  if (dpDay > maxDay) dpDay = maxDay;
  const d = new Date(dpYear, dpMonth, dpDay);
  const dayName = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'][d.getDay()];
  document.getElementById('dpHeaderDate').textContent = `${dayName}, ${dpDay} ${DP_MONTHS[dpMonth]} ${dpYear}`;
  // Vaishnava masa
  try {
    const masa = getVaishnavaMasa(d);
    const tithi = getTithi(d, curLoc.lat, curLoc.lon, curLoc.tz);
    document.getElementById('dpHeaderVaishnava').textContent =
      `${tithi.tithi} Â· ${masa.masa} Â· Gaurabda ${getGaurabda(d)}`;
  } catch(e) {
    document.getElementById('dpHeaderVaishnava').textContent = '';
  }
}

function dpSetYear(y) {
  dpYear = y;
  // Re-render year buttons
  document.querySelectorAll('.dp-year-btn').forEach((b,i) => {
    b.classList.toggle('sel', 1975+i === y);
  });
  dpRenderDays();
  dpUpdateHeader();
}

function dpSetMonth(m) {
  dpMonth = m;
  document.querySelectorAll('.dp-month-btn').forEach((b,i) => {
    b.classList.toggle('sel', i === m);
  });
  dpRenderDays();
  dpUpdateHeader();
}

function dpSetDay(d) {
  dpDay = d;
  document.querySelectorAll('.dp-day-btn').forEach(b => {
    b.classList.toggle('sel', parseInt(b.textContent) === d && !b.classList.contains('empty'));
  });
  dpUpdateHeader();
}

function dpGo() {
  closeModal('dpModal');
  gotoDate(dpYear, dpMonth, dpDay);
}

// ===================================================================
// NOTES
// ===================================================================
// ===================================================================
// NOTES - COMPREHENSIVE FEATURE SET
// ===================================================================
let _noteSortMode = 'date';
let _noteAutoSaveTimer = null;
let _currentEditNoteId = null;
let _pinBuffer = '';
let _pinMode = null; // 'setup', 'confirm-setup', 'unlock', 'lock-toggle'
let _pinSetupFirst = '';
let _pendingPinNoteId = null;

// --- NOTE FONT SIZE ---
const NOTE_FONT_SIZES = [0.82, 0.88, 0.96, 1.04, 1.14, 1.26, 1.4, 1.56, 1.74];
const NOTE_FONT_LABELS = ['XS','S','M','L','XL','2XL','3XL','4XL','5XL'];
let noteFontIdx = parseInt(localStorage.getItem('noteFontIdx')) || 5; // default 2XL (1.26rem)

function changeNoteFont(delta) {
  noteFontIdx = Math.max(0, Math.min(NOTE_FONT_SIZES.length - 1, noteFontIdx + delta));
  localStorage.setItem('noteFontIdx', noteFontIdx);
  applyNoteFont();
  showToast('Font: ' + NOTE_FONT_LABELS[noteFontIdx]);
}

function applyNoteFont() {
  const sz = NOTE_FONT_SIZES[noteFontIdx];
  const bodyEl = document.getElementById('neBody');
  const titleEl = document.getElementById('neTitle');
  if (bodyEl) {
    bodyEl.style.fontSize = sz + 'rem';
    bodyEl.querySelectorAll('h1').forEach(h => h.style.fontSize = (sz * 1.35) + 'rem');
    bodyEl.querySelectorAll('h2').forEach(h => h.style.fontSize = (sz * 1.2) + 'rem');
  }
  if (titleEl) titleEl.style.fontSize = (sz * 1.2) + 'rem';
}

// --- PIN SECURITY ---
async function hashPin(pin) {
  const enc = new TextEncoder().encode(pin + '_bhaktisakha_salt_v1');
  const buf = await crypto.subtle.digest('SHA-256', enc);
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

function isPinSetup() { return !!localStorage.getItem('notesPinHash'); }

async function verifyPin(pin) {
  const stored = localStorage.getItem('notesPinHash');
  if (!stored) return false;
  return (await hashPin(pin)) === stored;
}

function openPinOverlay(mode, noteId) {
  _pinMode = mode; _pinBuffer = ''; _pendingPinNoteId = noteId || null;
  const dots = document.querySelectorAll('#pinDots .pin-dot');
  dots.forEach(d=>{ d.classList.remove('filled','error'); });
  document.getElementById('pinErrorMsg').textContent = '';
  const forgot = document.getElementById('pinForgotLink');
  if (mode === 'setup') {
    document.getElementById('pinTitle').textContent = 'ðŸ” Set Master PIN';
    document.getElementById('pinSubtitle').textContent = 'Choose a 4-digit PIN to lock your notes';
    forgot.style.display = 'none';
  } else if (mode === 'confirm-setup') {
    document.getElementById('pinTitle').textContent = 'ðŸ” Confirm PIN';
    document.getElementById('pinSubtitle').textContent = 'Enter the same PIN again to confirm';
    forgot.style.display = 'none';
  } else {
    document.getElementById('pinTitle').textContent = 'ðŸ” Enter PIN';
    document.getElementById('pinSubtitle').textContent = 'Enter your 4-digit PIN to continue';
    forgot.style.display = 'block';
  }
  document.getElementById('pinOverlay').classList.add('open');
}

function closePinOverlay() {
  document.getElementById('pinOverlay').classList.remove('open');
  _pinMode = null; _pinBuffer = ''; _pendingPinNoteId = null; _pinSetupFirst = '';
}

function pinInput(digit) {
  if (_pinBuffer.length >= 4) return;
  _pinBuffer += digit;
  const dots = document.querySelectorAll('#pinDots .pin-dot');
  dots.forEach((d,i)=>{ d.classList.toggle('filled', i < _pinBuffer.length); d.classList.remove('error'); });
  document.getElementById('pinErrorMsg').textContent = '';
  if (_pinBuffer.length === 4) setTimeout(()=>processPinEntry(), 200);
}

function pinDelete() {
  if (_pinBuffer.length === 0) return;
  _pinBuffer = _pinBuffer.slice(0,-1);
  const dots = document.querySelectorAll('#pinDots .pin-dot');
  dots.forEach((d,i)=>{ d.classList.toggle('filled', i < _pinBuffer.length); d.classList.remove('error'); });
  document.getElementById('pinErrorMsg').textContent = '';
}

async function processPinEntry() {
  const noteId = _pendingPinNoteId; // Save before closePinOverlay resets it
  if (_pinMode === 'setup') {
    _pinSetupFirst = _pinBuffer;
    openPinOverlay('confirm-setup', noteId);
  } else if (_pinMode === 'confirm-setup') {
    if (_pinBuffer === _pinSetupFirst) {
      const hash = await hashPin(_pinBuffer);
      localStorage.setItem('notesPinHash', hash);
      showToast('PIN set successfully ðŸ”');
      closePinOverlay();
      if (noteId) { actualToggleLock(noteId); }
    } else {
      showPinError('PINs do not match. Try again.');
      _pinSetupFirst = '';
      setTimeout(()=>openPinOverlay('setup', noteId), 800);
    }
  } else if (_pinMode === 'unlock') {
    if (await verifyPin(_pinBuffer)) {
      closePinOverlay();
      if (noteId) openEditNote(noteId, true);
    } else { showPinError('Incorrect PIN'); }
  } else if (_pinMode === 'lock-toggle') {
    if (await verifyPin(_pinBuffer)) {
      closePinOverlay();
      if (noteId) actualToggleLock(noteId);
    } else { showPinError('Incorrect PIN'); }
  }
}

function showPinError(msg) {
  document.getElementById('pinErrorMsg').textContent = msg;
  const dots = document.querySelectorAll('#pinDots .pin-dot');
  dots.forEach(d=>d.classList.add('error'));
  setTimeout(()=>{
    _pinBuffer = '';
    dots.forEach(d=>{ d.classList.remove('filled','error'); });
  }, 600);
}

function forgotPin() {
  if (confirm('Reset your PIN?\n\nThis will UNLOCK all locked notes and remove the PIN. You will need to set a new one.\n\nTo verify your identity, you must be signed in with Google.')) {
    if (!isSignedIn()) { showToast('Please sign in with Google first to reset PIN'); return; }
    localStorage.removeItem('notesPinHash');
    notes.forEach(n => { n.locked = false; });
    localStorage.setItem('notes', JSON.stringify(notes));
    closePinOverlay();
    renderNotes();
    showToast('PIN removed. All notes unlocked.');
  }
}

// --- SORT ---
function setNoteSort(mode, btn) {
  _noteSortMode = mode;
  document.querySelectorAll('.notes-sort-btn').forEach(b=>b.classList.remove('active'));
  if (btn) btn.classList.add('active');
  renderNotes();
}

// --- RENDER NOTES LIST ---
function renderNotes() {
  const c = document.getElementById('notesList');
  const searchVal = (document.getElementById('notesSearchInp')?.value || '').toLowerCase().trim();
  let filtered = [...notes];
  if (searchVal) {
    filtered = filtered.filter(n =>
      (n.title||'').toLowerCase().includes(searchVal) ||
      (n.body||'').toLowerCase().replace(/<[^>]*>/g,'').includes(searchVal) ||
      (n.cat||'').toLowerCase().includes(searchVal)
    );
  }
  // Sort: pinned always first
  filtered.sort((a,b) => {
    if (a.pinned && !b.pinned) return -1;
    if (!a.pinned && b.pinned) return 1;
    if (_noteSortMode === 'title') return (a.title||'').localeCompare(b.title||'');
    if (_noteSortMode === 'cat') return (a.cat||'').localeCompare(b.cat||'');
    return (b.updatedAt||0) - (a.updatedAt||0);
  });
  const countEl = document.getElementById('notesCount');
  if (countEl) countEl.textContent = `${filtered.length} note${filtered.length!==1?'s':''}`;
  if (!filtered.length) {
    c.innerHTML = `<div class="empty-state"><div class="empty-state-icon">ðŸ“</div>${searchVal ? 'No notes matching your search.' : 'No notes yet.<br>Tap the + button to begin.'}</div>`;
    return;
  }
  c.innerHTML = filtered.map(n => {
    const tagClass = 'note-tag-' + (n.cat||'other');
    const tagLabels = {spiritual:'Spiritual', personal:'Personal', prayer:'Prayer', reminder:'Reminder', other:'Other'};
    const tagLabel = tagLabels[n.cat] || n.cat || 'Other';
    const d = new Date(n.updatedAt||n.createdAt);
    const date = d.toLocaleDateString('en-IN',{day:'numeric',month:'short',year:'numeric'});
    const time = d.toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit',hour12:true});
    const linked = n.linkedDate ? ` Â· ðŸ“… ${n.linkedDate}` : '';
    const pinIcon = n.pinned ? '<span class="note-pin-icon">ðŸ“Œ</span>' : '';
    const lockIcon = n.locked ? '<span class="note-lock-icon">ðŸ”’</span>' : '';
    const preview = n.locked ? '<div class="note-preview" style="font-style:italic;color:var(--text3)">This note is locked</div>' :
      (n.body ? `<div class="note-preview">${escHtml(stripHtml(n.body))}</div>` : '');
    const pinnedCls = n.pinned ? ' pinned' : '';
    const lockedCls = n.locked ? ' locked' : '';
    return `<div class="note-card${pinnedCls}${lockedCls}" onclick="onNoteCardClick(${n.id})">
      <div class="note-card-top">
        ${pinIcon}${lockIcon}
        <span class="note-tag ${tagClass}">${tagLabel}</span>
        <div class="note-title">${escHtml(n.title||'Untitled')}</div>
      </div>
      ${preview}
      <div class="note-footer">
        <span class="note-date">${date} ${time}${linked}</span>
        <div class="note-actions">
          <button class="note-act-btn" onclick="event.stopPropagation();toggleNotePin_list(${n.id})" title="${n.pinned?'Unpin':'Pin'}">${n.pinned?'ðŸ“Œ':'ðŸ“'}</button>
          <button class="note-act-btn" onclick="event.stopPropagation();delNote(${n.id})" title="Delete">ðŸ—‘</button>
        </div>
      </div>
    </div>`;
  }).join('');
}

function stripHtml(s) { return (s||'').replace(/<[^>]*>/g,' ').replace(/\s+/g,' ').trim(); }

function escHtml(s) {
  return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function onNoteCardClick(id) {
  const n = notes.find(x=>x.id===id);
  if (!n) return;
  if (n.locked) {
    openPinOverlay('unlock', id);
  } else {
    openEditNote(id);
  }
}

// --- NOTE EDITOR ---
function openAddNote() {
  if (!isSignedIn()) { requireSignIn('My Notes'); return; }
  _currentEditNoteId = null;
  document.getElementById('neTitle').value = '';
  document.getElementById('neCat').value = 'spiritual';
  document.getElementById('neLinkedDate').value = '';
  document.getElementById('neBody').innerHTML = '';
  document.getElementById('neAutosaveMsg').textContent = 'New note';
  updateEditorPinLockUI(false, false);
  document.getElementById('noteEditorOverlay').classList.add('open');
  applyNoteFont();
  document.getElementById('neTitle').focus();
}

function openEditNote(id, bypassLock) {
  const n = notes.find(x=>x.id===id);
  if (!n) return;
  if (n.locked && !bypassLock) { openPinOverlay('unlock', id); return; }
  _currentEditNoteId = id;
  document.getElementById('neTitle').value = n.title || '';
  document.getElementById('neCat').value = n.cat || 'spiritual';
  document.getElementById('neLinkedDate').value = n.linkedDate || '';
  document.getElementById('neBody').innerHTML = n.body || '';
  const d = new Date(n.updatedAt||n.createdAt);
  document.getElementById('neAutosaveMsg').textContent = 'Last saved ' + d.toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit'});
  updateEditorPinLockUI(!!n.pinned, !!n.locked);
  document.getElementById('noteEditorOverlay').classList.add('open');
  applyNoteFont();
}

function updateEditorPinLockUI(pinned, locked) {
  document.getElementById('nePinBtn').style.opacity = pinned ? 1 : 0.4;
  document.getElementById('neLockBtn').style.opacity = locked ? 1 : 0.4;
}

function closeNoteEditor() {
  // Auto-save on close if there's content
  const title = document.getElementById('neTitle').value.trim();
  const body = document.getElementById('neBody').innerHTML.trim();
  if (title || (body && body !== '<br>')) {
    saveNote(true); // silent save
  }
  document.getElementById('noteEditorOverlay').classList.remove('open');
  _currentEditNoteId = null;
  if (_noteAutoSaveTimer) { clearTimeout(_noteAutoSaveTimer); _noteAutoSaveTimer = null; }
  renderNotes();
}

function saveNote(silent) {
  const title = document.getElementById('neTitle').value.trim();
  const body = document.getElementById('neBody').innerHTML.trim();
  if (!title && (!body || body === '<br>')) {
    if (!silent) showToast('Please enter a title or content');
    return;
  }
  const now = Date.now();
  const cat = document.getElementById('neCat').value;
  const linkedDate = document.getElementById('neLinkedDate').value || '';
  if (_currentEditNoteId) {
    const idx = notes.findIndex(n=>n.id===_currentEditNoteId);
    if (idx > -1) {
      notes[idx] = { ...notes[idx], title: title||'Untitled', cat, body, linkedDate, updatedAt: now };
    }
  } else {
    const newNote = { id: now, title: title||'Untitled', cat, body, linkedDate, createdAt: now, updatedAt: now, pinned:false, locked:false };
    notes.push(newNote);
    _currentEditNoteId = now;
  }
  localStorage.setItem('notes', JSON.stringify(notes));
  document.getElementById('neAutosaveMsg').textContent = 'âœ“ Saved at ' + new Date().toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit'});
  if (!silent) showToast('Note saved ðŸ“');
  // Trigger Drive sync if signed in
  if (typeof gAccessToken !== 'undefined' && gAccessToken) {
    clearTimeout(window._noteSyncDebounce);
    window._noteSyncDebounce = setTimeout(()=>{ try { gSyncAll(); } catch(e){} }, 5000);
  }
}

// Auto-save on typing
document.addEventListener('DOMContentLoaded', function() {
  // Initialize Google Sign-In after GSI library loads
  function tryInitGoogle() {
    if (window.google && window.google.accounts) {
      restoreGoogleSession();
      initGoogleSignIn();
    } else {
      setTimeout(tryInitGoogle, 300);
    }
  }
  setTimeout(tryInitGoogle, 500);

  const bodyEl = document.getElementById('neBody');
  if (bodyEl) {
    bodyEl.addEventListener('input', function() {
      document.getElementById('neAutosaveMsg').textContent = 'Editingâ€¦';
      if (_noteAutoSaveTimer) clearTimeout(_noteAutoSaveTimer);
      _noteAutoSaveTimer = setTimeout(()=>{
        const t = document.getElementById('neTitle').value.trim();
        const b = document.getElementById('neBody').innerHTML.trim();
        if (t || (b && b !== '<br>')) saveNote(true);
      }, 3000);
    });
  }
  const titleEl = document.getElementById('neTitle');
  if (titleEl) {
    titleEl.addEventListener('input', function() {
      if (_noteAutoSaveTimer) clearTimeout(_noteAutoSaveTimer);
      _noteAutoSaveTimer = setTimeout(()=>{
        const t = document.getElementById('neTitle').value.trim();
        const b = document.getElementById('neBody').innerHTML.trim();
        if (t || (b && b !== '<br>')) saveNote(true);
      }, 3000);
    });
  }
});

function deleteCurrentNote() {
  if (!_currentEditNoteId) { closeNoteEditor(); return; }
  if (!confirm('Delete this note?')) return;
  notes = notes.filter(n=>n.id!==_currentEditNoteId);
  localStorage.setItem('notes', JSON.stringify(notes));
  showToast('Note deleted');
  document.getElementById('noteEditorOverlay').classList.remove('open');
  _currentEditNoteId = null;
  renderNotes();
}

function delNote(id) {
  if (!confirm('Delete this note?')) return;
  notes = notes.filter(n=>n.id!==id);
  localStorage.setItem('notes', JSON.stringify(notes));
  renderNotes();
  showToast('Note deleted');
}

// --- PIN / LOCK from editor ---
function toggleNotePin() {
  if (!_currentEditNoteId) return;
  const idx = notes.findIndex(n=>n.id===_currentEditNoteId);
  if (idx<0) return;
  notes[idx].pinned = !notes[idx].pinned;
  localStorage.setItem('notes', JSON.stringify(notes));
  updateEditorPinLockUI(notes[idx].pinned, notes[idx].locked);
  showToast(notes[idx].pinned ? 'Note pinned ðŸ“Œ' : 'Note unpinned');
}

function toggleNotePin_list(id) {
  const idx = notes.findIndex(n=>n.id===id);
  if (idx<0) return;
  notes[idx].pinned = !notes[idx].pinned;
  localStorage.setItem('notes', JSON.stringify(notes));
  renderNotes();
  showToast(notes[idx].pinned ? 'Pinned ðŸ“Œ' : 'Unpinned');
}

function toggleNoteLock() {
  if (!_currentEditNoteId) return;
  // First save current edits
  saveNote(true);
  if (!isPinSetup()) {
    openPinOverlay('setup', _currentEditNoteId);
  } else {
    openPinOverlay('lock-toggle', _currentEditNoteId);
  }
}

function actualToggleLock(id) {
  const idx = notes.findIndex(n=>n.id===id);
  if (idx<0) return;
  notes[idx].locked = !notes[idx].locked;
  localStorage.setItem('notes', JSON.stringify(notes));
  if (notes[idx].locked) {
    // Close editor so content is hidden immediately
    document.getElementById('noteEditorOverlay').classList.remove('open');
    _currentEditNoteId = null;
  }
  if (_currentEditNoteId === id) updateEditorPinLockUI(notes[idx].pinned, notes[idx].locked);
  renderNotes();
  showToast(notes[idx].locked ? 'Note locked ðŸ”’' : 'Note unlocked ðŸ”“');
}

// --- FORMATTING TOOLBAR ---
function neExec(cmd) {
  document.execCommand(cmd, false, null);
  document.getElementById('neBody').focus();
}

function neExecHeading(tag) {
  document.execCommand('formatBlock', false, tag);
  document.getElementById('neBody').focus();
}

function neExecHighlight() {
  const sel = window.getSelection();
  if (!sel.rangeCount || sel.isCollapsed) return;
  const range = sel.getRangeAt(0);
  // Check if already highlighted
  let parent = sel.anchorNode.parentElement;
  if (parent && parent.tagName === 'MARK') {
    // Remove highlight
    const text = document.createTextNode(parent.textContent);
    parent.parentNode.replaceChild(text, parent);
  } else {
    const mark = document.createElement('mark');
    try {
      range.surroundContents(mark);
    } catch(e) {
      // Fallback for complex selections
      document.execCommand('hiliteColor', false, 'rgba(241,196,15,0.3)');
    }
  }
  document.getElementById('neBody').focus();
}

// --- EXPORT / IMPORT ---
function exportNotes() {
  const blob = new Blob([JSON.stringify({notes, exported: new Date().toISOString()}, null, 2)], {type:'application/json'});
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
  a.download = 'bhakti-sakha-notes.json'; a.click();
  showToast('Notes exported ðŸ“¤');
}

function importNotes() {
  const inp = document.createElement('input'); inp.type = 'file'; inp.accept = '.json';
  inp.onchange = e => {
    const r = new FileReader();
    r.onload = x => {
      try {
        const data = JSON.parse(x.result);
        if (data.notes && Array.isArray(data.notes)) {
          // Migrate old notes to new format
          data.notes.forEach(n => {
            if (n.pinned === undefined) n.pinned = false;
            if (n.locked === undefined) n.locked = false;
          });
          notes = data.notes;
          localStorage.setItem('notes', JSON.stringify(notes));
          renderNotes();
          showToast('Imported ' + data.notes.length + ' notes âœ…');
        } else { showToast('Invalid file format'); }
      } catch { showToast('Could not read file'); }
    };
    r.readAsText(e.target.files[0]);
  };
  inp.click();
}

// Legacy compat - keep old function names working
function openAddNote_legacy() { openAddNote(); }
function updateNoteCharCount() {}

// ===================================================================
// NAVIGATION
// ===================================================================
let _navHistory = ['home'];
let _currentScreen = 'home';

function switchScreen(name, btn) {
  // Persist playing audio if leaving song detail
  if (_playingSongId && _persistentAudio && !_persistentAudio.paused) {
    _persistCurrentAudio();
    // Re-show mini bar since we're leaving song detail
    setTimeout(() => _updateNowPlayingBar(true), 50);
  }
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(`screen-${name}`).classList.add('active');
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
  if (btn) {
    btn.classList.add('active');
    // Auto-scroll nav to show active button
    if (btn.closest('.nav-scroll-area')) {
      btn.scrollIntoView({behavior:'smooth', block:'nearest', inline:'center'});
      setTimeout(()=>{ if(typeof updateNavArrow==='function') updateNavArrow(); }, 350);
    }
  }

  // Push history state for back button (only if navigating forward, not going back)
  if (name !== _currentScreen) {
    if (_currentScreen !== 'home' && name === 'home') {
      // Going back to home - don't push, we'll handle via popstate
    } else if (name !== 'home') {
      history.pushState({screen: name}, '', '');
    }
    _currentScreen = name;
  }

  // Show/hide brand bar and header based on screen
  const brandBar = document.querySelector('.app-brand');
  const header = document.querySelector('.header');
  if (name === 'home') {
    if (brandBar) brandBar.style.display = 'flex';
    if (header) header.style.display = 'none';
    updateHomeScreen();
    // Highlight home nav button
    const homeBtn = document.querySelectorAll('.nav-btn')[0];
    if (homeBtn) homeBtn.classList.add('active');
  } else {
    if (brandBar) brandBar.style.display = 'none';
    if (header) header.style.display = '';

    // Update header: show date on calendar, screen title on others; hide icons except on calendar
    const headerDate = document.getElementById('headerDate');
    const headerMasa = document.getElementById('headerMasa');
    const headerIcons = document.getElementById('headerIcons');
    const TITLES = {calendar:null, search:'Search Calendar', songs:'Transcendental Vibrations', events:'My Events', notes:'My Notes', settings:'Settings', dhamas:'Holy Dhamas', info:'About Bhakti Sakha', sevakart:'SevaKart', 'sevakart-detail':'SevaKart', 'sevakart-mylistings':'My Listings', prayer:'Prayer Circle', 'prayer-detail':'Prayer Request', 'prayer-my':'My Prayer Requests', admin:'Admin Dashboard', userlist:'App Users'};
    if (name === 'calendar') {
      updateHeaderDate();
      headerIcons.style.display = '';
      headerMasa.style.display = '';
      headerDate.classList.remove('songs-title');
      document.querySelector('.header').classList.remove('header-songs');
    } else {
      headerDate.textContent = TITLES[name] || name;
      headerIcons.style.display = 'none';
      headerMasa.style.display = 'none';
      if (name === 'songs') {
        headerDate.classList.add('songs-title');
        document.querySelector('.header').classList.add('header-songs');
      } else {
        headerDate.classList.remove('songs-title');
        document.querySelector('.header').classList.remove('header-songs');
      }
    }
  }

  if (name==='songs') { renderSongs(); setTimeout(() => _updateSongListIndicator(), 50); }
  if (name==='events') renderEvts();
  if (name==='notes') renderNotes();
  if (name==='dhamas') renderDhamas();
  if (name==='sevakart') skRenderHome();
  if (name==='prayer') pcRenderFeed();
  if (name==='admin') renderAdminDashboard();
  if (name==='userlist') ulFetchAndRender();
  if (name==='search') { initJumpSelects(); doSearch(); }
  if (name==='settings') { renderLocGrid(); const n=document.getElementById('curLocName'); if(n)n.textContent=curLoc.name; loadNotifSettings(); }
}

// Back button handler - navigate to home instead of exiting
window.addEventListener('popstate', function(e) {
  if (_currentScreen !== 'home') {
    switchScreen('home', document.querySelectorAll('.nav-btn')[0]);
  }
});
// Push initial state
history.replaceState({screen: 'home'}, '', '');

// Update home screen content
function updateHomeScreen() {
  // Greeting based on time of day with user name if available
  const hr = new Date().getHours();
  const userName = gUser ? gUser.name.split(' ')[0] : '';
  let greet = '';
  if (hr >= 3 && hr < 12) greet = 'Hare Krishna' + (userName ? ', ' + userName : '') + '!';
  else if (hr >= 12 && hr < 17) greet = 'Hare Krishna' + (userName ? ', ' + userName : '') + '!';
  else if (hr >= 17 && hr < 21) greet = 'Hare Krishna' + (userName ? ', ' + userName : '') + '!';
  else greet = 'Hare Krishna' + (userName ? ', ' + userName : '') + '!';
  const greetEl = document.getElementById('homeGreeting');
  if (greetEl) greetEl.textContent = greet;

  // Date
  const now = new Date();
  const MONTHS = ['January','February','March','April','May','June','July','August','September','October','November','December'];
  const DAYS = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  const dateEl = document.getElementById('homeDate');
  if (dateEl) dateEl.textContent = `${DAYS[now.getDay()]}, ${now.getDate()} ${MONTHS[now.getMonth()]} ${now.getFullYear()}`;

  // Vaishnava date â€” use header masa if available
  const vdEl = document.getElementById('homeVDate');
  const headerMasa = document.getElementById('headerMasa');
  if (vdEl && headerMasa && headerMasa.textContent) {
    vdEl.textContent = headerMasa.textContent;
  }

  // Update Google account UI on home
  updateHomeGoogleUI();

  // Today's events
  updateHomeTodayCard();
}

function updateHomeGoogleUI() {
  const signedIn = document.getElementById('homeGSignedIn');
  const signedOut = document.getElementById('homeGSignedOut');
  if (!signedIn || !signedOut) return;

  if (gUser) {
    signedIn.style.display = '';
    signedOut.style.display = 'none';
    const av = document.getElementById('homeGAvatar');
    if (av && gUser.picture) av.src = gUser.picture;
    const nm = document.getElementById('homeGName');
    if (nm) nm.textContent = gUser.name || 'Devotee';
    const em = document.getElementById('homeGEmail');
    if (em) em.textContent = gUser.email || '';
    // Show admin icon for admins
    const admBtn = document.getElementById('homeAdminBtn');
    if (admBtn) admBtn.style.display = isAdmin() ? 'flex' : 'none';
  } else {
    signedIn.style.display = 'none';
    signedOut.style.display = '';
  }
}

function updateHomeTodayCard() {
  try {
    const card = document.getElementById('homeTodayCard');
    const text = document.getElementById('homeTodayText');
    if (!card || !text) return;

    const now = new Date();
    const key = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}`;
    const todayEvents = [];

    // Check calendarData for today
    if (typeof calendarData !== 'undefined' && calendarData[key]) {
      const d = calendarData[key];
      if (d.tithi) todayEvents.push(d.tithi);
      if (d.events && d.events.length) {
        d.events.forEach(e => {
          if (e.name) todayEvents.push(e.name);
        });
      }
      if (d.ekadashi) todayEvents.push(d.ekadashi);
    }

    // Also check custom events
    if (typeof events !== 'undefined' && events.length) {
      events.forEach(e => {
        if (e.date === key) todayEvents.push(e.title || e.name);
      });
    }

    if (todayEvents.length > 0) {
      card.style.display = '';
      const evStr = todayEvents.slice(0,3).map(e => `<span class="ht-event">${e}</span>`).join(' Â· ');
      text.innerHTML = evStr;
    } else {
      card.style.display = 'none';
    }
  } catch(e) {
    // Silently handle if calendar data not ready
  }
}

// ===================================================================
// SCROLLABLE NAV ARROW
// ===================================================================
function scrollNavForward() {
  const area = document.getElementById('navScrollArea');
  const hint = document.getElementById('navArrowHint');
  if (!area) return;
  const maxScroll = area.scrollWidth - area.clientWidth;
  const atEnd = area.scrollLeft >= maxScroll - 5;
  if (atEnd) {
    area.scrollTo({left: 0, behavior: 'smooth'});
  } else {
    area.scrollBy({left: 140, behavior: 'smooth'});
  }
}

function updateNavArrow() {
  const area = document.getElementById('navScrollArea');
  const hint = document.getElementById('navArrowHint');
  if (!area || !hint) return;
  const maxScroll = area.scrollWidth - area.clientWidth;
  if (maxScroll <= 2) {
    hint.classList.add('hidden');
    return;
  }
  hint.classList.remove('hidden');
  if (area.scrollLeft >= maxScroll - 5) {
    hint.classList.add('at-end');
  } else {
    hint.classList.remove('at-end');
  }
}

// Attach scroll listener
setTimeout(() => {
  const area = document.getElementById('navScrollArea');
  if (area) {
    area.addEventListener('scroll', updateNavArrow, {passive: true});
    updateNavArrow();
    // Also update on resize
    window.addEventListener('resize', updateNavArrow);
  }
}, 100);

function closeModal(id) { document.getElementById(id).classList.remove('open'); }

document.querySelectorAll('.modal-overlay').forEach(m => {
  m.addEventListener('click', e => { if(e.target===m) m.classList.remove('open'); });
});

// ===================================================================
// TOAST
// ===================================================================
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 2800);
}

// ===================================================================
// INIT
// ===================================================================

// ===================================================================
// REAL-TIME GAYATRI / RAHU ALERT ENGINE
// ===================================================================
let _alertDismissed = {};   // track which alerts were dismissed today

function fmt12(totalMins) {
  const h = Math.floor(totalMins / 60), m = totalMins % 60;
  const ampm = h < 12 ? 'am' : 'pm';
  const h12 = h === 0 ? 12 : h > 12 ? h-12 : h;
  return `${h12}:${String(m).padStart(2,'0')} ${ampm}`;
}

function parseTimeTo24Mins(timeStr) {
  // Parse "6:59 am" or "12:52 pm" â†’ total minutes since midnight
  if (!timeStr) return null;
  const m = timeStr.match(/(\d+):(\d+)\s*(am|pm)/i);
  if (!m) return null;
  let h = parseInt(m[1]), min = parseInt(m[2]);
  const ap = m[3].toLowerCase();
  if (ap === 'pm' && h !== 12) h += 12;
  if (ap === 'am' && h === 12) h = 0;
  return h * 60 + min;
}

function dismissAlertBanner() {
  document.getElementById('alertBanner').style.display = 'none';
}

function showAlertBanner(title, body, color, iconHtml) {
  const banner = document.getElementById('alertBanner');
  const tc = color || '#4ddb6e';
  banner.style.borderBottomColor = tc;
  // Pick background gradient based on color
  if (tc === '#ff9940') banner.style.background = 'linear-gradient(135deg,#2a1808,#1a0e00)';       // pratah - warm dawn
  else if (tc === '#e8c800') banner.style.background = 'linear-gradient(135deg,#2a2008,#1a1400)';  // madhya - golden
  else if (tc === '#d04830') banner.style.background = 'linear-gradient(135deg,#2a0c10,#1a0508)';  // sayam - dusk red
  else if (tc === '#ffe94d') banner.style.background = 'linear-gradient(135deg,#2a2008,#1a1400)';  // generic gayatri
  else if (tc === '#f08c1a') banner.style.background = 'linear-gradient(135deg,#2a1a0a,#1a0d00)';
  else if (tc === '#e74c3c') banner.style.background = 'linear-gradient(135deg,#2a0a0a,#1a0000)';
  else banner.style.background = 'linear-gradient(135deg,#1a1a30,#0d0d20)';
  document.getElementById('alertBannerTitle').style.color = tc;
  document.getElementById('alertBannerTitle').textContent = title;
  document.getElementById('alertBannerBody').textContent = body;
  // Icon
  const iconEl = document.getElementById('alertBannerIcon');
  if (iconHtml) {
    iconEl.innerHTML = iconHtml;
    iconEl.style.display = '';
  } else {
    iconEl.style.display = 'none';
  }
  banner.style.display = '';
  banner.style.animation = 'none';
  banner.offsetHeight; // reflow
  banner.style.animation = 'slideDown 0.35s ease';
  // Auto-dismiss after 30 seconds
  setTimeout(() => { if (banner.style.display !== 'none') dismissAlertBanner(); }, 30000);
}

// â”€â”€ Sandhya notification icons (inline SVGs) â”€â”€
const _sandhyaIcons = {
  pratah: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96" width="42" height="42"><defs><linearGradient id="psky" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#1a1a3e"/><stop offset="60%" stop-color="#3a2060"/><stop offset="100%" stop-color="#f08040"/></linearGradient><linearGradient id="psun" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#ffe066"/><stop offset="100%" stop-color="#ff8c30"/></linearGradient><radialGradient id="pgl" cx="50%" cy="70%" r="40%"><stop offset="0%" stop-color="#ff9940" stop-opacity="0.6"/><stop offset="100%" stop-color="#ff9940" stop-opacity="0"/></radialGradient></defs><circle cx="48" cy="48" r="46" fill="url(#psky)"/><ellipse cx="48" cy="62" rx="40" ry="20" fill="url(#pgl)"/><line x1="48" y1="42" x2="48" y2="32" stroke="#ffe066" stroke-width="2" stroke-linecap="round" opacity="0.7"/><line x1="58" y1="46" x2="65" y2="38" stroke="#ffe066" stroke-width="2" stroke-linecap="round" opacity="0.6"/><line x1="38" y1="46" x2="31" y2="38" stroke="#ffe066" stroke-width="2" stroke-linecap="round" opacity="0.6"/><line x1="63" y1="54" x2="72" y2="50" stroke="#ffe066" stroke-width="1.5" stroke-linecap="round" opacity="0.4"/><line x1="33" y1="54" x2="24" y2="50" stroke="#ffe066" stroke-width="1.5" stroke-linecap="round" opacity="0.4"/><clipPath id="ph"><rect x="0" y="0" width="96" height="60"/></clipPath><circle cx="48" cy="60" r="14" fill="url(#psun)" clip-path="url(#ph)"/><line x1="10" y1="60" x2="86" y2="60" stroke="#f0c070" stroke-width="1.5" opacity="0.5"/><rect x="0" y="60" width="96" height="36" fill="#1a1020" opacity="0.7"/><path d="M0 64 Q24 56,48 62 Q72 56,96 64 L96 96 L0 96Z" fill="#1a1020" opacity="0.5"/></svg>`,

  madhya: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96" width="42" height="42"><defs><linearGradient id="msky" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#c89020"/><stop offset="40%" stop-color="#e8b830"/><stop offset="70%" stop-color="#f0d050"/><stop offset="100%" stop-color="#fff0a0"/></linearGradient><linearGradient id="msun" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#ffffff"/><stop offset="50%" stop-color="#fff8c0"/><stop offset="100%" stop-color="#ffe040"/></linearGradient><radialGradient id="mgl" cx="50%" cy="38%" r="40%"><stop offset="0%" stop-color="#ffffff" stop-opacity="0.5"/><stop offset="40%" stop-color="#fff8c0" stop-opacity="0.3"/><stop offset="100%" stop-color="#f0d050" stop-opacity="0"/></radialGradient></defs><circle cx="48" cy="48" r="46" fill="url(#msky)"/><circle cx="48" cy="36" r="30" fill="url(#mgl)"/><line x1="48" y1="12" x2="48" y2="4" stroke="#fff0a0" stroke-width="3" stroke-linecap="round" opacity="0.9"/><line x1="48" y1="60" x2="48" y2="68" stroke="#e8b830" stroke-width="2.5" stroke-linecap="round" opacity="0.5"/><line x1="24" y1="36" x2="16" y2="36" stroke="#fff0a0" stroke-width="3" stroke-linecap="round" opacity="0.9"/><line x1="72" y1="36" x2="80" y2="36" stroke="#fff0a0" stroke-width="3" stroke-linecap="round" opacity="0.9"/><line x1="32" y1="20" x2="26" y2="14" stroke="#fff0a0" stroke-width="2.5" stroke-linecap="round" opacity="0.7"/><line x1="64" y1="20" x2="70" y2="14" stroke="#fff0a0" stroke-width="2.5" stroke-linecap="round" opacity="0.7"/><line x1="32" y1="52" x2="26" y2="58" stroke="#e8b830" stroke-width="2" stroke-linecap="round" opacity="0.4"/><line x1="64" y1="52" x2="70" y2="58" stroke="#e8b830" stroke-width="2" stroke-linecap="round" opacity="0.4"/><circle cx="48" cy="36" r="15" fill="url(#msun)"/><circle cx="43" cy="31" r="5" fill="white" opacity="0.4"/><rect x="0" y="74" width="96" height="22" fill="#a07818" opacity="0.2"/></svg>`,

  sayam: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96" width="42" height="42"><defs><linearGradient id="ssky" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#1a1040"/><stop offset="30%" stop-color="#602060"/><stop offset="60%" stop-color="#d04830"/><stop offset="100%" stop-color="#f08830"/></linearGradient><linearGradient id="ssun" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#ff6030"/><stop offset="100%" stop-color="#d03020"/></linearGradient><radialGradient id="sgl" cx="50%" cy="68%" r="40%"><stop offset="0%" stop-color="#ff6830" stop-opacity="0.7"/><stop offset="50%" stop-color="#ff4020" stop-opacity="0.3"/><stop offset="100%" stop-color="#ff4020" stop-opacity="0"/></radialGradient></defs><circle cx="48" cy="48" r="46" fill="url(#ssky)"/><ellipse cx="48" cy="62" rx="42" ry="22" fill="url(#sgl)"/><line x1="48" y1="48" x2="48" y2="38" stroke="#ff8040" stroke-width="2" stroke-linecap="round" opacity="0.5"/><line x1="58" y1="52" x2="66" y2="44" stroke="#ff8040" stroke-width="1.5" stroke-linecap="round" opacity="0.4"/><line x1="38" y1="52" x2="30" y2="44" stroke="#ff8040" stroke-width="1.5" stroke-linecap="round" opacity="0.4"/><clipPath id="sh"><rect x="0" y="0" width="96" height="64"/></clipPath><circle cx="48" cy="64" r="14" fill="url(#ssun)" clip-path="url(#sh)"/><line x1="8" y1="64" x2="88" y2="64" stroke="#f08040" stroke-width="1.5" opacity="0.4"/><rect x="0" y="64" width="96" height="32" fill="#1a0c20" opacity="0.7"/><ellipse cx="48" cy="70" rx="18" ry="3" fill="#ff6030" opacity="0.15"/><circle cx="20" cy="18" r="1" fill="white" opacity="0.5"/><circle cx="72" cy="14" r="1.2" fill="white" opacity="0.6"/><circle cx="78" cy="28" r="0.8" fill="white" opacity="0.4"/></svg>`
};

function checkGayatriAlerts() {
  const s = JSON.parse(localStorage.getItem('settings') || '{}');
  if (!s['n-gayatri']) return;

  const now = new Date();
  const todayKey = now.toISOString().slice(0, 10);
  const nowMins = now.getHours() * 60 + now.getMinutes();

  // Get today's sun times for current location
  const st = getSunTimes(now, curLoc.lat, curLoc.lon, curLoc.tz);
  if (!st) return;

  const targets = [
    { key:'pratah',  time: st.sunrise, label:'PrÄtaá¸¥ SandhyÄ',   msg:'Sunrise in 10 minutes â€” time to prepare for PrÄtaá¸¥ GÄyatrÄ«.', icon: _sandhyaIcons.pratah, color:'#ff9940' },
    { key:'madhya',  time: st.noon,    label:'MÄdhyÄhnika SandhyÄ', msg:'Noon in 10 minutes â€” time to prepare for MÄdhyÄhnika GÄyatrÄ«.', icon: _sandhyaIcons.madhya, color:'#e8c800' },
    { key:'sayam',   time: st.sunset,  label:'SÄyaá¹ƒ SandhyÄ',     msg:'Sunset in 10 minutes â€” time to prepare for SÄyaá¹ƒ GÄyatrÄ«.', icon: _sandhyaIcons.sayam, color:'#d04830' },
  ];

  for (const t of targets) {
    const alertMins = parseTimeTo24Mins(t.time) - 10;
    if (alertMins === null) continue;
    const alertKey = `${todayKey}-${t.key}`;
    // Fire if we're within the same minute as the alert time
    if (nowMins === alertMins && !_alertDismissed[alertKey]) {
      _alertDismissed[alertKey] = true;
      showAlertBanner(t.label, t.msg, t.color, t.icon);
    }
  }
}

function checkRahuAlert() {
  const s = JSON.parse(localStorage.getItem('settings') || '{}');
  if (!s['n-rahu']) return;

  const now = new Date();
  const todayKey = now.toISOString().slice(0, 10);
  const nowMins = now.getHours() * 60 + now.getMinutes();
  const alertKey = `${todayKey}-rahu`;
  if (_alertDismissed[alertKey]) return;

  const st = getSunTimes(now, curLoc.lat, curLoc.lon, curLoc.tz);
  if (!st || !st.rahuStart) return;

  const rahuMins = parseTimeTo24Mins(st.rahuStart);
  if (rahuMins !== null && nowMins === rahuMins) {
    _alertDismissed[alertKey] = true;
    showAlertBanner('ðŸš« Rahu Kalam', `Rahu Kalam begins now (${st.rahuStart} â€“ ${st.rahuEnd}). Avoid new ventures.`, '#e74c3c');
  }
}

// Tick every minute
function startAlertTicker() {
  checkGayatriAlerts();
  checkRahuAlert();
  // Align to next full minute
  const now = new Date();
  const msToNextMin = (60 - now.getSeconds()) * 1000 - now.getMilliseconds();
  setTimeout(() => {
    checkGayatriAlerts();
    checkRahuAlert();
    setInterval(() => {
      checkGayatriAlerts();
      checkRahuAlert();
    }, 60000);
  }, msToNextMin);
}

// ===================================================================
// HOLY DHAMAS
// ===================================================================
const DHAMAS = [
{
  id:'vrindavan', name:'Sri Vrindavan Dham', icon:'ðŸ¦š',
  location:'Mathura, Uttar Pradesh, India', tag:'iskcon', tagLabel:'ISKCON HQ',
  overview: `Vrindavan is the most sacred land where Lord Sri Krishna performed His childhood pastimes (lilas) 5,000 years ago. It is considered non-different from Goloka Vrindavan, the eternal spiritual abode of the Lord.

The main deity at ISKCON's Krishna-Balaram Mandir is Sri Sri Krishna-Balaram, along with Sri Sri Radha-Shyamasundara and Sri Sri Gaura-Nitai.

Vrindavan is one of the most important pilgrimage destinations for all Vaishnavas. The entire land is considered sacred â€” every dust particle is worshippable.`,
  scriptural: `â€¢ Srimad Bhagavatam (10th Canto) extensively describes Krishna's Vrindavan pastimes â€” the Rasa Lila, lifting Govardhan Hill, killing of demons like Putana, Aghasura, and more.
â€¢ Chaitanya Charitamrita describes how Sri Chaitanya Mahaprabhu visited Vrindavan and rediscovered the lost holy places.
â€¢ The Six Goswamis of Vrindavan â€” Rupa, Sanatana, Jiva, Raghunatha Das, Raghunatha Bhatta, and Gopala Bhatta â€” established temples and wrote foundational Gaudiya Vaishnava literature here.
â€¢ Srila Prabhupada established the Krishna-Balaram Mandir in 1975, fulfilling his spiritual master's vision.`,
  howToReach: `City: Vrindavan, District Mathura, Uttar Pradesh, India
Nearest Airport: Agra (Kheria) â€” ~70 km; Delhi IGI â€” ~150 km
Nearest Railway: Mathura Junction â€” ~12 km
From Delhi: 3â€“4 hours by road (NH-44), frequent buses and trains
Local Transport: Auto-rickshaws, e-rickshaws, cycle rickshaws available everywhere
Tip: Pre-book a cab from Delhi for comfort. Within Vrindavan, e-rickshaws are the most convenient.`,
  darshan: `ISKCON Krishna-Balaram Mandir:
â€¢ Mangala Aarti: 4:30 AM
â€¢ Darshan: 4:30 AM â€“ 1:00 PM, 4:30 PM â€“ 8:30 PM
â€¢ Rajbhog Aarti: 12:25 PM
â€¢ Sandhya Aarti: 7:15 PM
â€¢ Shayana Aarti: 8:30 PM

Best time for peaceful darshan: Early morning (4:30â€“6:00 AM) or late evening.
Special: Janmashtami has 24-hour darshan.

Other major temples: Banke Bihari (opens ~7:45 AM), Radha Raman, Radha Damodar, Radha Vallabh â€” each has its own schedule.`,
  festivals: `â€¢ Janmashtami (Aug/Sep) â€” Grand celebration, 24hr darshan, massive crowds
â€¢ Radhashtami (Sep) â€” Appearance of Srimati Radharani
â€¢ Holi (Mar) â€” Famous Vrindavan/Barsana Holi celebrations, Lathmar Holi
â€¢ Kartik Month (Oct/Nov) â€” Damodar month, Govardhan Puja, Diwali
â€¢ Rasa Purnima â€” Full moon of Kartik, commemorating Rasa Lila
â€¢ Jhulan Yatra (Jul/Aug) â€” Swing festival
Best time to visit: Octâ€“Mar (pleasant weather, Kartik month is ideal)`,
  accommodation: `ISKCON Guesthouse: Book at krishnabalaram.com or call temple office. Clean rooms, prasadam included.
MVT (Mayapur Vrindavan Trust) Guesthouse: Popular with devotees, advance booking essential during festivals.
Budget Hotels: Numerous options on Bhaktivedanta Swami Marg and Parikrama Marg (â‚¹500â€“2000/night).
OYO/Hotels: Many available on booking apps.
Tip: Book 2â€“3 months ahead for Janmashtami and Kartik.`,
  prasadam: `ISKCON Temple: Breakfast (8:30 AM), Lunch Prasadam (1:00 PM), Dinner (7:30 PM) â€” donation basis
MVT Restaurant: Excellent sattvik food, no onion/garlic
Govinda's Restaurant: Near ISKCON temple, pure veg
Brajwasi Mithai: Famous for sweets and pedas
Tip: Most restaurants in Vrindavan are pure vegetarian. Ask specifically for "no onion, no garlic" at non-temple restaurants.
Annadan: ISKCON temple serves free meals daily.`,
  seva: `Available Sevas at ISKCON:
â€¢ Abhishek Seva
â€¢ Go Seva (cow service)
â€¢ Annadan (food distribution)
â€¢ Deity dress sponsorship
â€¢ Bhoga offering
Book at the temple office or online at iskconvrindavan.com`,
  keyPlaces: [
    {name:'ISKCON Krishna-Balaram Mandir', desc:'Founded by Srila Prabhupada. Sri Sri Krishna-Balaram, Radha-Shyamasundara, Gaura-Nitai.'},
    {name:'Banke Bihari Temple', desc:'Most popular temple. Deity appeared from Nidhivan. Unique â€” no aarti bell, curtain darshan.'},
    {name:'Radha Damodar Temple', desc:'Established by Jiva Goswami. Srila Prabhupada\'s rooms and bhajan kutir are preserved here.'},
    {name:'Radha Raman Temple', desc:'Self-manifested deity of Lord Krishna. Established by Gopala Bhatta Goswami.'},
    {name:'Govardhan Hill', desc:'~25 km. Krishna lifted this hill for 7 days. Govardhan Parikrama is 21 km.'},
    {name:'Seva Kunj & Nidhivan', desc:'Groves where Radha-Krishna perform eternal pastimes. Closes at sunset â€” no one stays overnight.'},
    {name:'Keshi Ghat', desc:'Where Krishna killed the demon Keshi. Beautiful sunset spot on Yamuna.'},
    {name:'Prem Mandir', desc:'Modern marble temple by Jagadguru Kripalu Maharaj. Stunning light show at night.'},
    {name:'Radha Vallabh Temple', desc:'One of the ancient temples. Only Radharani\'s deity â€” Krishna is represented by a flute.'},
    {name:'Barsana', desc:'~45 km. Radharani\'s birthplace. Famous Lathmar Holi. Ladli Ji temple.'},
  ],
  itinerary: `Day 1 â€” Vrindavan:
4:15 AM â€” Mangala Aarti at ISKCON Krishna-Balaram Mandir
7:30 AM â€” Breakfast prasadam
8:30 AM â€” Banke Bihari Temple, Radha Damodar Temple
11:00 AM â€” Radha Raman Temple, Radha Vallabh Temple
1:00 PM â€” Lunch prasadam at ISKCON
4:00 PM â€” Seva Kunj, Nidhivan
5:30 PM â€” Keshi Ghat (sunset on Yamuna)
7:15 PM â€” Sandhya Aarti at ISKCON
8:00 PM â€” Prem Mandir light show

Day 2 â€” Govardhan & Mathura:
5:00 AM â€” Start Govardhan Parikrama (21 km, 5-6 hours)
12:00 PM â€” Lunch at Govardhan
2:00 PM â€” Krishna Janmabhoomi, Mathura
4:00 PM â€” Dwarkadhish Temple, Vishram Ghat, Mathura
6:00 PM â€” Return to Vrindavan, evening aarti`,
  dos: `Do's:
â€¢ Dress modestly â€” cover shoulders and knees
â€¢ Remove shoes before entering temples
â€¢ Carry water and sun protection (summers are harsh)
â€¢ Respect Yamuna river â€” don't pollute

Don'ts:
â€¢ No non-vegetarian food, alcohol, or tobacco in Vrindavan
â€¢ Don't touch deities or temple items without permission
â€¢ Don't photograph where prohibited (Banke Bihari bans phones)
â€¢ Avoid visiting Nidhivan/Seva Kunj after sunset`,
  bestTime: `Octâ€“Mar: Best weather (15â€“28Â°C). Kartik month (Oct/Nov) is spiritually the best.
Aprâ€“Jun: Very hot (40â€“47Â°C). Avoid unless for specific festivals.
Julâ€“Sep: Monsoon. Janmashtami falls in this period â€” crowded but ecstatic.
Weekdays are far less crowded than weekends.`,
  contacts: `ISKCON Krishna-Balaram Mandir: +91-565-254-0021
ISKCON Guesthouse: +91-565-254-0022
Website: iskconvrindavan.com
Mathura Railway Enquiry: 139`,
  devoteeTips: `â€¢ Start early â€” 4:15 AM Mangala Aarti sets the tone for the day
â€¢ Carry a small bag with water, prasadam snacks, and a hand fan (summers)
â€¢ Keep valuables safe â€” crowded temples attract pickpockets
â€¢ Vrindavan is best experienced barefoot on Parikrama â€” many devotees walk barefoot
â€¢ If visiting Govardhan, start very early to avoid midday heat
â€¢ The dust of Vrindavan is sacred â€” offer obeisances to the Dham upon arrival
â€¢ Buy Tulsi mala and japa beads from shops near ISKCON temple`
},
{
  id:'mayapur', name:'Sri Mayapur Dham', icon:'ðŸŒ•',
  location:'Nadia, West Bengal, India', tag:'iskcon', tagLabel:'ISKCON World HQ',
  overview: `Sri Mayapur Dham is the birthplace of Sri Chaitanya Mahaprabhu (1486 CE), the Supreme Lord appearing in the mood of His greatest devotee. It is the spiritual headquarters of ISKCON worldwide.

The main deity is Sri Sri Radha-Madhava with the Ashta-Sakhis, along with Sri Sri Pancha-Tattva. The magnificent Temple of the Vedic Planetarium (TOVP), nearing completion, will be one of the largest religious structures in the world.

Mayapur is located on the sacred confluence of the Ganga and Jalangi rivers in the Navadvipa area of West Bengal.`,
  scriptural: `â€¢ Chaitanya Charitamrita (Adi Lila) describes the appearance of Lord Chaitanya on Phalguna Purnima, 1486 CE.
â€¢ Chaitanya Bhagavata by Vrindavan Das Thakura details the early pastimes in Navadvipa.
â€¢ Navadvipa Dham Mahatmya by Bhaktivinoda Thakura describes the nine islands of Navadvipa and their spiritual significance.
â€¢ Srila Prabhupada declared Mayapur as ISKCON's world headquarters. He envisioned the TOVP as a beacon for spiritual education.
â€¢ Bhaktivinoda Thakura rediscovered the exact birthplace of Lord Chaitanya in the 1890s.`,
  howToReach: `City: Mayapur, District Nadia, West Bengal, India
Nearest Airport: Netaji Subhash Chandra Bose International Airport, Kolkata â€” ~130 km
Nearest Railway: Krishnanagar City Junction â€” ~25 km; Nabadwip Dham Station â€” ~8 km (across the river)
From Kolkata: 3.5â€“4 hours by road (NH-12). ISKCON runs buses from Kolkata.
Local Transport: Auto-rickshaws, toto (e-rickshaws), cycle rickshaws
Tip: Take the ISKCON bus from Kolkata Yatri Niwas for a comfortable direct ride.`,
  darshan: `ISKCON Sri Chandrodaya Mandir:
â€¢ Mangala Aarti: 4:30 AM
â€¢ Darshan: 4:30 AM â€“ 1:00 PM, 4:00 PM â€“ 8:30 PM
â€¢ Guru Puja: 7:15 AM
â€¢ Rajbhog Aarti: 12:30 PM
â€¢ Sandhya Aarti: 6:30 PM (varies by season)
â€¢ Shayana Aarti: 8:15 PM

Pancha Tattva darshan is particularly mesmerizing.
Best time for peaceful darshan: 4:30â€“6:00 AM and 4:00â€“5:00 PM on weekdays.`,
  festivals: `â€¢ Sri Gaura Purnima (Feb/Mar) â€” Grand appearance festival of Lord Chaitanya. Devotees worldwide gather.
â€¢ Jagannath Rath Yatra (Jun/Jul) â€” Massive chariot procession
â€¢ Janmashtami (Aug/Sep) â€” Sri Krishna's appearance
â€¢ Kartik Month (Oct/Nov) â€” Damodar vrata, special aartis
â€¢ Nabadwip Mandal Parikrama (Mar) â€” 9-day circumambulation of Navadvipa's 9 islands
Best time to visit: Octâ€“Mar (pleasant weather). Gaura Purnima is the ultimate experience.`,
  accommodation: `ISKCON Mayapur Guest House (Gada Bhavan): Multiple categories, book online at mayapur.com
Lotus Building Guesthouse: Budget option within campus
Chakra Building: Premium rooms
Outside options: Limited. Temple campus accommodation is strongly recommended.
Tip: Book well in advance for Gaura Purnima â€” rooms sell out months ahead.`,
  prasadam: `ISKCON Prasadam Hall: Serves breakfast, lunch, and dinner â€” world-class pure Vaishnava food.
Govinda's Restaurant: On campus, excellent variety
Various food stalls: Near the market area
All food on campus is sattvik â€” no onion, no garlic.
Annadan: Free prasadam distribution daily.`,
  seva: `â€¢ Deity worship sponsorship
â€¢ Annadan (feeds thousands daily)
â€¢ TOVP construction donation
â€¢ Go-Seva (Goshala)
â€¢ Gurukul/education sponsorship
Book at the temple office or online at mayapur.com`,
  keyPlaces: [
    {name:'Sri Chandrodaya Mandir', desc:'Main ISKCON temple with Sri Sri Radha-Madhava and Pancha-Tattva deities.'},
    {name:'Temple of the Vedic Planetarium (TOVP)', desc:'Magnificent structure nearing completion. Will house a Vedic cosmology exhibition.'},
    {name:'Srila Prabhupada\'s Pushpa Samadhi', desc:'Beautiful memorial and museum dedicated to Srila Prabhupada.'},
    {name:'Yogapitha', desc:'Exact birthplace of Sri Chaitanya Mahaprabhu. Small but extremely sacred.'},
    {name:'Chand Kazi\'s Samadhi', desc:'Tomb of the magistrate who tried to stop the Sankirtan movement but became a devotee.'},
    {name:'Srivas Angan', desc:'Courtyard of Srivas Thakur where the first Sankirtan was performed.'},
    {name:'Jagannath Mandir', desc:'Within campus. Beautiful Jagannath, Baladeva, Subhadra deities.'},
    {name:'Goshala', desc:'ISKCON cow shelter. Devotees can do Go-Seva here.'},
  ],
  itinerary: `Day 1 â€” ISKCON Campus:
4:15 AM â€” Mangala Aarti
7:15 AM â€” Guru Puja, breakfast prasadam
9:00 AM â€” Srila Prabhupada Pushpa Samadhi & Museum
10:30 AM â€” TOVP visit
12:30 PM â€” Rajbhog Aarti, lunch prasadam
4:00 PM â€” Afternoon darshan, Goshala
6:30 PM â€” Sandhya Aarti, evening walk along Ganga
8:15 PM â€” Shayana Aarti, dinner

Day 2 â€” Navadvipa Holy Places:
6:00 AM â€” Mangala Aarti, breakfast
8:00 AM â€” Yogapitha (Lord Chaitanya's birthplace)
9:30 AM â€” Srivas Angan
10:30 AM â€” Chand Kazi's Samadhi & Neem tree
12:00 PM â€” Lunch prasadam
3:00 PM â€” Visit Navadvipa town, Dhameswar Mahaprabhu temple
6:00 PM â€” Return for evening programme`,
  dos: `Do's:
â€¢ Dress in devotional attire â€” dhoti/kurta for men, sari/salwar for women is appreciated
â€¢ Attend Mangala Aarti at least once â€” it's transformative
â€¢ Offer obeisances upon entering the Dham

Don'ts:
â€¢ No non-veg, intoxicants, or tobacco on campus
â€¢ Don't swim in the Ganga without guidance â€” currents can be strong
â€¢ Don't miss the Pancha-Tattva darshan
â€¢ Avoid rainy season (Junâ€“Aug) â€” flooding is common`,
  bestTime: `Octâ€“Mar: Ideal weather (15â€“28Â°C). Gaura Purnima (Feb/Mar) is peak spiritual season.
Aprâ€“May: Hot and humid.
Junâ€“Sep: Monsoon â€” heavy rains, possible flooding. Avoid unless for Rath Yatra.
Weekdays are much more peaceful than weekends.`,
  contacts: `ISKCON Mayapur: +91-3472-245-400
Guesthouse Booking: mayapur.com
ISKCON Kolkata (for bus): +91-33-2287-3757`,
  devoteeTips: `â€¢ Bring mosquito repellent â€” essential especially during monsoon
â€¢ Carry light cotton clothes â€” Bengal is humid
â€¢ The campus is huge â€” comfortable walking shoes are a must
â€¢ Attend the morning and evening programmes for the full experience
â€¢ Buy books and devotional items from the campus bookstore â€” best prices
â€¢ The Ganga here is called Bhagirathi â€” take a dip if possible (ghat near campus)`
},
{
  id:'puri', name:'Jagannath Puri Dham', icon:'ðŸ›•',
  location:'Puri, Odisha, India', tag:'char-dham', tagLabel:'Char Dham',
  overview: `Sri Jagannath Puri is one of the four sacred Char Dhams and one of the most important pilgrimage sites in India. The main deity is Lord Jagannath (Krishna), along with Baladeva and Subhadra Devi.

The Jagannath Temple, built in the 12th century by King Anantavarman Chodaganga Deva, is one of the most magnificent temple structures in India.

Sri Chaitanya Mahaprabhu spent the last 18 years of His manifest pastimes in Puri, making it supremely sacred for Gaudiya Vaishnavas.`,
  scriptural: `â€¢ Skanda Purana extensively glorifies Purushottama Kshetra (Puri) as the abode of Lord Vishnu.
â€¢ Chaitanya Charitamrita (Madhya & Antya Lila) describes Mahaprabhu's ecstatic pastimes in Puri â€” His Ratha Yatra celebrations, meetings with Raya Ramananda and Sarvabhauma Bhattacharya.
â€¢ The Ratha Yatra festival has been celebrated for centuries and was a key event in Mahaprabhu's life.
â€¢ Srila Prabhupada was inspired by the Puri Ratha Yatra and introduced it worldwide through ISKCON.`,
  howToReach: `City: Puri, Odisha, India
Nearest Airport: Biju Patnaik International Airport, Bhubaneswar â€” ~60 km
Nearest Railway: Puri Railway Station â€” ~3 km from Jagannath Temple
From Bhubaneswar: 1.5 hours by road or train
Local Transport: Auto-rickshaws, cycle rickshaws, taxis
Tip: Puri is well connected by train. Book Bhubaneswar-Puri trains in advance.`,
  darshan: `Jagannath Temple:
â€¢ Mangala Aarti: 5:00 AM
â€¢ Abakasha: 6:00 AM (morning meal offering)
â€¢ Madhyanha Dhupa: 11:00 AMâ€“12:00 PM (main offering)
â€¢ Sandhya Dhupa: 7:00 PM
â€¢ Chandana Lagi: 8:00 PM

Note: Non-Hindu visitors may face entry restrictions at the main Jagannath Temple. ISKCON temple in Puri welcomes everyone.
Best darshan: Early morning 5:30â€“7:00 AM. Avoid weekends and festivals for crowd-free darshan.`,
  festivals: `â€¢ Rath Yatra (Jun/Jul) â€” The most famous festival. Massive chariots pulled through Grand Road. Millions attend.
â€¢ Return Rath Yatra (Bahuda Yatra) â€” 9 days after Rath Yatra
â€¢ Snana Yatra (May/Jun) â€” Deities' bathing ceremony before Rath Yatra
â€¢ Chandan Yatra â€” 42-day summer festival
â€¢ Kartik celebrations
Best time to visit: Octâ€“Mar for weather. Rath Yatra for the ultimate experience (but extremely crowded).`,
  accommodation: `ISKCON Puri Guesthouse: On the beachfront, clean rooms
Nilachala Hotel (Temple Trust): Near the temple
Numerous hotels: Along the beach road (CT Road) â€” â‚¹500â€“3000/night
Tip: Book early for Rath Yatra â€” the entire city fills up.`,
  prasadam: `Jagannath Temple Mahaprasad: Famous worldwide. Available at Ananda Bazar inside the temple. Called "Abadha" â€” rice, dal, vegetables cooked in earthen pots.
ISKCON Temple Prasadam: Available for all visitors
Wildcraft/Chappan Bhog: Restaurants on CT Road serve pure veg
Tip: Mahaprasad from Jagannath temple is considered supremely sacred â€” even prasadam from the ground is worshippable.`,
  seva: `At Jagannath Temple:
â€¢ Various sevas available through temple administration
At ISKCON Puri:
â€¢ Deity sponsorship, Annadan, book distribution
Contact the respective temple offices.`,
  keyPlaces: [
    {name:'Jagannath Temple', desc:'Main temple â€” 12th century, 65m tall. One of the Char Dhams. Jagannath, Baladeva, Subhadra.'},
    {name:'Gambhira (Tota Gopinath Temple)', desc:'Where Sri Chaitanya Mahaprabhu spent His last years in ecstatic devotion.'},
    {name:'Gundicha Temple', desc:'Destination of Rath Yatra. Lord Jagannath stays here for 7 days.'},
    {name:'Siddha Bakul', desc:'Where Haridas Thakur chanted 300,000 names daily. His samadhi is nearby.'},
    {name:'Tota Gopinath Temple', desc:'Deity of Gopinath associated with Gadadhara Pandit.'},
    {name:'ISKCON Puri', desc:'Beautiful temple on the beachfront. Welcomes all visitors.'},
    {name:'Puri Beach', desc:'Sacred beach. Mahaprabhu bathed here. Sunrise is spectacular.'},
    {name:'Narendra Sarovar', desc:'Sacred lake where Chandan Yatra takes place.'},
    {name:'Sakshi Gopal Temple', desc:'~20 km. Famous deity who walked as a witness. Fascinating pastime.'},
    {name:'Konark Sun Temple', desc:'~35 km. UNESCO World Heritage site. 13th century architectural marvel.'},
  ],
  itinerary: `Day 1 â€” Puri:
5:00 AM â€” Early morning Jagannath Temple darshan
7:30 AM â€” Breakfast
8:30 AM â€” Gambhira, Siddha Bakul, Haridas Thakur Samadhi
10:30 AM â€” Tota Gopinath Temple
12:00 PM â€” Mahaprasad at Ananda Bazar
3:00 PM â€” ISKCON Puri temple
4:30 PM â€” Narendra Sarovar
6:00 PM â€” Sunset at Puri Beach
7:00 PM â€” Sandhya Aarti

Day 2 â€” Surroundings:
6:00 AM â€” Sunrise at beach, Gundicha Temple
9:00 AM â€” Sakshi Gopal Temple
11:00 AM â€” Konark Sun Temple
2:00 PM â€” Return to Puri, lunch
4:00 PM â€” Revisit Jagannath Temple or explore local markets`,
  dos: `Do's:
â€¢ Dress conservatively for temple visits
â€¢ Accept Mahaprasad with respect â€” it is non-different from Lord Jagannath
â€¢ Visit Gambhira with a devotional mood

Don'ts:
â€¢ Non-Hindu entry restrictions apply at the main Jagannath Temple â€” plan accordingly
â€¢ Don't take photos inside Jagannath Temple
â€¢ Avoid beach swimming during monsoon â€” strong undertows
â€¢ Don't bargain aggressively at Mahaprasad stalls â€” these are offerings`,
  bestTime: `Octâ€“Mar: Pleasant (20â€“30Â°C), ideal for visiting
Jun/Jul: Rath Yatra season â€” hot and crowded but spiritually ecstatic
Aprâ€“May: Hot and humid (35â€“40Â°C)
Julâ€“Sep: Heavy monsoon rains`,
  contacts: `Jagannath Temple Office: +91-6752-222-002
ISKCON Puri: +91-6752-231-440
Puri Railway Station: 139`,
  devoteeTips: `â€¢ If you're not allowed in the main temple, the rooftop of Raghunandan Library opposite the temple offers a view of the Chakra on the shikhara
â€¢ Carry cash â€” many temple area shops don't accept cards
â€¢ The Mahaprasad from Ananda Bazar is a must-experience â€” buy extra to bring home
â€¢ Puri pandas (priests) may approach â€” politely decline if you don't need their services
â€¢ Walk on the Grand Road (Bada Danda) â€” it's the Rath Yatra route`
},
{
  id:'dwarka', name:'Sri Dwarka Dham', icon:'ðŸ›ï¸',
  location:'Dwarka, Gujarat, India', tag:'char-dham', tagLabel:'Char Dham',
  overview: `Dwarka is the legendary kingdom of Lord Krishna, one of the four Char Dhams of India. It is believed that Krishna established this city after leaving Mathura, and it was submerged in the sea after His departure from the world.

The main deity at the Dwarkadhish Temple is Lord Dwarkadhish (Krishna as the King of Dwarka). The temple is an architectural masterpiece, believed to be originally established by Krishna's grandson Vajranabha.

Dwarka sits on the western tip of Gujarat, where the Gomti River meets the Arabian Sea.`,
  scriptural: `â€¢ Srimad Bhagavatam (10th & 11th Canto) describes Krishna's pastimes in Dwarka â€” His 16,108 queens, Rukmini Swayamvar, Sudama's visit, and the Yadava dynasty's final days.
â€¢ Mahabharata references Dwarka extensively as Krishna's kingdom.
â€¢ Harivamsha Purana describes the construction of Dwarka by Vishwakarma.
â€¢ Marine archaeological surveys have found submerged structures off the Dwarka coast, supporting the ancient descriptions.`,
  howToReach: `City: Dwarka, Gujarat, India
Nearest Airport: Jamnagar Airport â€” ~130 km; Rajkot Airport â€” ~220 km
Nearest Railway: Dwarka Railway Station â€” ~2 km from main temple
From Ahmedabad: ~8 hours by road or overnight train
Local Transport: Auto-rickshaws, taxis
Tip: Overnight trains from Ahmedabad/Rajkot are convenient. Book in advance.`,
  darshan: `Dwarkadhish Temple:
â€¢ Mangala Aarti: 6:30 AM
â€¢ Darshan: 7:00 AM â€“ 12:30 PM, 5:00 PM â€“ 9:00 PM
â€¢ Sandhya Aarti: 7:30 PM

ISKCON Dwarka Temple also has regular darshan.
Best time: Early morning right after opening.
Special: Janmashtami celebrations are grand.`,
  festivals: `â€¢ Janmashtami (Aug/Sep) â€” Grand celebration
â€¢ Holi â€” Colorful celebrations
â€¢ Diwali â€” Festival of lights
â€¢ Shivratri at Nageshwar
Best time to visit: Octâ€“Mar (pleasant weather, 20â€“32Â°C)`,
  accommodation: `Temple Trust Guest Houses: Basic, affordable
ISKCON Dwarka: Guesthouse available
Hotels: Several options in town (â‚¹500â€“2500/night)
Tip: Limited luxury options â€” Dwarka is a small town. Book ahead in peak season.`,
  prasadam: `Temple Prasadam: Available at Dwarkadhish temple
ISKCON Prasadam: Pure sattvik meals
Local Restaurants: Gujarati thali restaurants are abundant â€” naturally vegetarian
Tip: Gujarati food is generally no onion/garlic in traditional preparation.`,
  seva: `â€¢ Dwarkadhish Temple: Various abhishek and archana sevas
â€¢ ISKCON Dwarka: Deity sponsorship, annadan
Contact temple offices for details.`,
  keyPlaces: [
    {name:'Dwarkadhish Temple', desc:'Main temple. Ancient 5-storey structure. Lord Dwarkadhish deity.'},
    {name:'Bet Dwarka', desc:'Island ~30 km. Believed to be Krishna\'s personal residence. Boat ride from Okha.'},
    {name:'Rukmini Temple', desc:'~2 km from main temple. Dedicated to Krishna\'s principal queen.'},
    {name:'Nageshwar Jyotirlinga', desc:'~16 km. One of 12 Jyotirlingas. Important Shiva temple.'},
    {name:'Gopi Talav', desc:'Sacred lake where the Gopis are said to have come searching for Krishna.'},
    {name:'Sudama Setu', desc:'Bridge over Gomti river. Named after Krishna\'s friend Sudama.'},
    {name:'Gomti Ghat', desc:'Where Gomti meets the sea. Sacred bathing spot. Sunset views.'},
    {name:'ISKCON Dwarka', desc:'Beautiful temple with daily programs.'},
  ],
  itinerary: `Day 1 â€” Dwarka:
6:30 AM â€” Mangala Aarti at Dwarkadhish Temple
8:00 AM â€” Breakfast, Gomti Ghat bath
9:30 AM â€” Rukmini Temple, Gopi Talav
11:00 AM â€” ISKCON Dwarka darshan
12:30 PM â€” Lunch
4:00 PM â€” Sudama Setu, Sunset at Gomti Ghat
7:30 PM â€” Sandhya Aarti at Dwarkadhish

Day 2 â€” Bet Dwarka & Nageshwar:
6:00 AM â€” Early start to Okha (~30 km)
7:00 AM â€” Boat to Bet Dwarka, temple darshan
10:00 AM â€” Return, visit Nageshwar Jyotirlinga
12:30 PM â€” Return to Dwarka, lunch
Afternoon â€” Free / revisit favourite spots`,
  dos: `Do's:
â€¢ Dress modestly for all temple visits
â€¢ Take a dip at Gomti Ghat â€” considered sacred
â€¢ Carry ID for Bet Dwarka boat

Don'ts:
â€¢ Don't litter at the ghats or beaches
â€¢ Don't swim in the sea without local guidance â€” strong currents
â€¢ Photography restrictions inside main temple`,
  bestTime: `Octâ€“Mar: Best weather (20â€“32Â°C), clear skies
Aprâ€“Jun: Very hot (35â€“42Â°C), harsh sun
Julâ€“Sep: Monsoon â€” some areas may be inaccessible
Janmashtami (Aug/Sep) is the best festival to experience here.`,
  contacts: `Dwarkadhish Temple Trust: +91-2892-234-032
ISKCON Dwarka: Contact through ISKCON website
Dwarka Railway Station: 139`,
  devoteeTips: `â€¢ Bet Dwarka boat timing depends on tides â€” check locally before going
â€¢ Carry sunscreen and a hat â€” the western coast sun is intense
â€¢ Combine with Somnath (~230 km) if doing a Gujarat pilgrimage
â€¢ Dwarka is small â€” 2 full days is sufficient
â€¢ The evening aarti at Dwarkadhish with the sea breeze is magical`
},
{
  id:'tirupati', name:'Tirumala Tirupati', icon:'â›°ï¸',
  location:'Tirupati, Andhra Pradesh, India', tag:'divya-desam', tagLabel:'Divya Desam',
  overview: `Tirumala Tirupati is the most visited religious site in the world. The presiding deity is Lord Sri Venkateswara (Balaji), a form of Lord Vishnu, standing on the seven hills of Tirumala in the Seshachalam range.

The temple is one of the 108 Divya Desams (holy abodes of Vishnu) praised by the Alvar saints. It attracts 60,000â€“100,000 pilgrims daily, making it the richest and most visited temple on earth.

The deity is self-manifested (Swayambhu) and is considered extraordinarily merciful â€” devotees from all traditions visit seeking blessings.`,
  scriptural: `â€¢ Varaha Purana and Brahma Purana describe the glories of Venkatachala (Tirumala hills).
â€¢ The Alvars (Tamil Vaishnava saints) composed hymns glorifying Lord Venkateswara, compiled in the Divya Prabandham.
â€¢ According to tradition, Lord Vishnu took a loan from Kubera to marry Padmavati, and devotees "repay" this by donating â€” hence the immense wealth.
â€¢ Ramanujacharya, the great Vaishnava acharya, established many worship practices still followed at this temple.
â€¢ Srila Prabhupada visited Tirupati and acknowledged Lord Venkateswara as Lord Vishnu Himself.`,
  howToReach: `City: Tirupati, Andhra Pradesh, India
Nearest Airport: Tirupati Airport (Renigunta) â€” ~15 km from Tirupati city
Nearest Railway: Tirupati Railway Station â€” well connected to Chennai, Bangalore, Hyderabad
From Chennai: ~3 hours by road (NH-48), frequent trains
From Bangalore: ~5 hours by road
Tirupati to Tirumala: Free bus service by TTD (~22 km ghat road), or walk up via foot path (~14 km, 3-4 hours)
Tip: Book darshan online at ttdevasthanams.ap.gov.in well in advance.`,
  darshan: `Sri Venkateswara Temple:
â€¢ Suprabhatam: 3:00 AM (wake-up hymns)
â€¢ Thomala Seva: 3:30 AM
â€¢ Archana: 4:00 AM onwards
â€¢ General darshan: Throughout the day (queue times vary: 2â€“12+ hours)
â€¢ Special Entry Darshan (â‚¹300): ~2-3 hour wait
â€¢ VIP Break Darshan: Through TTD advance booking
â€¢ Temple closes briefly: 1:00â€“2:00 PM (Ekanta Seva)

Best approach: Book â‚¹300 Special Entry online, arrive early morning.
Tip: Sarva Darshan (free) can mean 8â€“15 hour waits on weekends/festivals.`,
  festivals: `â€¢ Brahmotsavam (Sep/Oct) â€” 9-day grand festival, celestial vahana processions. Most important.
â€¢ Vaikunta Ekadashi (Dec/Jan) â€” Vaikunta Dwaram opens. Lakhs of devotees. Extremely crowded.
â€¢ Rathasapthami (Jan/Feb) â€” Surya Jayanti celebrated with great fervor
â€¢ Annual Teppotsavam â€” Float festival on Swami Pushkarini
â€¢ Ugadi â€” Telugu New Year
Best time to visit: Weekdays outside festival season for shorter queues. Brahmotsavam for the ultimate experience.`,
  accommodation: `TTD Guest Houses: Multiple options on Tirumala hill (book at ttdevasthanams.ap.gov.in)
TTD Cottages: AC/Non-AC categories available
Tirupati city hotels: Abundant options near railway station (â‚¹500â€“3000/night)
ISKCON Tirupati: Guesthouse available
Tip: Stay on Tirumala hill if possible. Book TTD accommodation online 2-3 weeks ahead.`,
  prasadam: `TTD Laddu Prasadam: World-famous! Available after darshan. Additional laddus can be purchased.
TTD Annaprasadam: Free meals served 24/7 at Matrusri Tarigonda Vengamamba Annaprasadam complex â€” feeds thousands daily.
Meals on Tirumala: Several TTD canteens and the Annaprasadam hall
Tip: The TTD free meal system is extraordinary â€” no pilgrim goes hungry on Tirumala.`,
  seva: `TTD offers numerous sevas (book online):
â€¢ Suprabhatam Seva (3:00 AM â€” most premium)
â€¢ Thomala Seva
â€¢ Archana (various types)
â€¢ Kalyanotsavam (celestial wedding enactment)
â€¢ Unjal Seva (swing festival)
â€¢ Sahasra Deepalankara Seva
Book at ttdevasthanams.ap.gov.in â€” slots open 2 weeks to 3 months in advance depending on the seva.`,
  keyPlaces: [
    {name:'Sri Venkateswara Temple', desc:'Main temple on Tirumala hill. Self-manifested Lord Venkateswara (Balaji). Dravidian architecture.'},
    {name:'Swami Pushkarini', desc:'Sacred tank in front of the temple. Bath here before darshan is recommended.'},
    {name:'Sri Padmavathi Temple (Tiruchanur)', desc:'~5 km from Tirupati. Temple of Lord Venkateswara\'s consort. Visit before going to Tirumala.'},
    {name:'ISKCON Tirupati', desc:'Beautiful temple with Radha-Govinda deities. Excellent prasadam.'},
    {name:'Akasha Ganga', desc:'Natural waterfall on Tirumala hills. Considered sacred â€” water from Lord\'s feet.'},
    {name:'Japali Teertham', desc:'Cave and water body associated with Ramayana. Peaceful spot on the hills.'},
    {name:'Silathoranam', desc:'Natural rock arch formation â€” geological wonder on Tirumala hills.'},
    {name:'Sri Kalyana Venkateswara Temple (Srinivasa Mangapuram)', desc:'~12 km. Beautiful temple depicting the wedding of the Lord.'},
    {name:'Kanipakam Vinayaka Temple', desc:'~70 km. Famous self-growing Ganesha idol.'},
  ],
  itinerary: `Day 1 â€” Tirumala:
3:00 AM â€” If you have Suprabhatam Seva, report at Supadham
OR 5:00 AM â€” Join Special Entry Darshan queue
After darshan â€” Collect Laddu Prasadam
9:00 AM â€” Breakfast at Annaprasadam hall
10:00 AM â€” Swami Pushkarini, Silathoranam walk
12:00 PM â€” Lunch at TTD canteen
3:00 PM â€” Akasha Ganga, Japali Teertham
6:00 PM â€” Evening rest / revisit temple area

Day 2 â€” Tirupati & Surroundings:
7:00 AM â€” Sri Padmavathi Temple, Tiruchanur
9:00 AM â€” ISKCON Tirupati
11:00 AM â€” Srinivasa Mangapuram
1:00 PM â€” Lunch, depart`,
  dos: `Do's:
â€¢ Book darshan online well in advance â€” walk-in queues are very long
â€¢ Dress conservatively â€” men often wear dhoti, women wear sari/churidar
â€¢ Tonsure (head shaving) is a common offering â€” dedicated kalyanakatta available
â€¢ Keep phones/cameras in lockers â€” not allowed inside main temple

Don'ts:
â€¢ Don't carry electronics, bags, or food into the temple
â€¢ Don't wear leather items (belts, wallets) inside the temple
â€¢ Don't try to rush through the queue â€” it's an exercise in patience and devotion
â€¢ Don't skip meals â€” the free food infrastructure is excellent`,
  bestTime: `Octâ€“Feb: Best weather on the hills (15â€“28Â°C), pleasant darshan experience
Marâ€“May: Hot in Tirupati city but cooler on the hill
Junâ€“Sep: Monsoon â€” hills are green and beautiful but can be slippery
Weekdays (Tueâ€“Thu): Shortest queues. Avoid Saturdays, Sundays, and public holidays.
Brahmotsavam (Sep/Oct): Spectacular but extremely crowded.`,
  contacts: `TTD Information: +91-877-2277-777
TTD Online Booking: ttdevasthanams.ap.gov.in
Tirupati Railway: 139
ISKCON Tirupati: +91-877-2230-009`,
  devoteeTips: `â€¢ The most important tip: BOOK ONLINE. Don't arrive hoping for walk-in darshan.
â€¢ If doing Sarva Darshan (free), come on a weekday, arrive by 2:00 AM
â€¢ The walk up to Tirumala via foot path is a beautiful spiritual experience â€” carry water
â€¢ Ladies with small children can use the special line
â€¢ Lockers (free) are available at multiple points before the temple entrance
â€¢ Buy laddus at the counter after darshan â€” you can buy additional boxes
â€¢ The hill breeze in the evening is divine â€” take a walk around the temple campus`
},
{
  id:'ayodhya', name:'Sri Ayodhya Dham', icon:'ðŸ¹',
  location:'Ayodhya, Uttar Pradesh, India', tag:'iskcon', tagLabel:'Sapta Puri',
  overview: `Ayodhya is the sacred birthplace of Lord Sri Ramachandra, the seventh avatara of Lord Vishnu. It is one of the seven holiest cities (Sapta Puri) in Hinduism that grant liberation.

The newly constructed Sri Ram Janmabhoomi Temple (consecrated January 2024) marks the exact birthplace of Lord Rama and is now the centerpiece of Ayodhya pilgrimage.

ISKCON has a beautiful temple in Ayodhya dedicated to Sita-Rama-Lakshmana-Hanuman. Ayodhya sits on the banks of the sacred Sarayu River.`,
  scriptural: `â€¢ Valmiki Ramayana describes Ayodhya as the capital of the Ikshvaku dynasty, ruled by Maharaja Dasharatha, where Lord Rama appeared.
â€¢ Srimad Bhagavatam (9th Canto) narrates the dynasty of Lord Rama and glorifies Ayodhya.
â€¢ Skanda Purana describes Ayodhya as one of the Moksha-puris â€” cities that grant liberation.
â€¢ Sri Chaitanya Mahaprabhu visited Ayodhya during His travels.
â€¢ Tulsidas composed Ramcharitmanas in nearby Varanasi, immortalizing Rama's Ayodhya pastimes in Hindi.
â€¢ The site has been a center of devotion for thousands of years with multiple ancient temples.`,
  howToReach: `City: Ayodhya, Uttar Pradesh, India
Nearest Airport: Maharishi Valmiki International Airport, Ayodhya â€” newly opened, domestic flights
Nearest Railway: Ayodhya Junction & Ayodhya Dham Junction â€” well connected
From Lucknow: ~130 km, ~3 hours by road, frequent trains
From Varanasi: ~200 km, ~5 hours by road
Local Transport: Auto-rickshaws, e-rickshaws, cycle rickshaws
Tip: New airport has made Ayodhya much more accessible. Direct flights from Delhi, Mumbai, and other cities.`,
  darshan: `Sri Ram Janmabhoomi Temple:
â€¢ Morning darshan: 7:00 AM â€“ 11:30 AM
â€¢ Afternoon: 12:00 PM â€“ 4:00 PM (may vary)
â€¢ Evening: 4:00 PM â€“ 9:00 PM
(Timings are subject to change â€” check before visiting)

Hanuman Garhi:
â€¢ Open: 5:00 AM â€“ 10:00 PM

ISKCON Ayodhya:
â€¢ Standard ISKCON darshan timings

Best time: Arrive early morning for peaceful darshan at Ram Janmabhoomi. Expect queues on weekends.`,
  festivals: `â€¢ Ram Navami (Mar/Apr) â€” Grand celebration of Lord Rama's appearance. Massive gathering.
â€¢ Diwali (Oct/Nov) â€” Ayodhya's Deepotsav is world-famous â€” millions of diyas lit along the Sarayu
â€¢ Vivah Panchami (Nov/Dec) â€” Celebration of Sita-Rama's wedding
â€¢ Parikrama on Purnima days â€” Circumambulation of Ayodhya
â€¢ Kartik month celebrations
Best time to visit: Octâ€“Mar. Diwali Deepotsav is a once-in-a-lifetime experience.`,
  accommodation: `Temple Trust Dharamshalas: Multiple options at affordable rates
ISKCON Ayodhya Guesthouse: Clean, prasadam included
Hotels: Growing number of new hotels (â‚¹500â€“5000/night)
Srijanm Bhumi Trust Accommodation: Near the main temple
Tip: Ayodhya's infrastructure is rapidly improving. New hotels opening regularly. Book ahead for Ram Navami and Diwali.`,
  prasadam: `Ram Janmabhoomi Prasadam: Available after darshan
ISKCON Temple: Excellent sattvik meals, no onion/garlic
Local Restaurants: Many pure vegetarian options along the main roads
Ayodhya Chaat: Famous street food (pure veg)
Tip: Most of Ayodhya is vegetarian. The city respects the sanctity of Ram's birthplace.`,
  seva: `Ram Janmabhoomi Trust:
â€¢ Various seva options â€” check sriramjanmbhoomi.org
ISKCON Ayodhya:
â€¢ Deity worship sponsorship, Annadan, book distribution
â€¢ Contact temple for details`,
  keyPlaces: [
    {name:'Sri Ram Janmabhoomi Temple', desc:'Newly built grand temple at Lord Rama\'s exact birthplace. Magnificent Nagara-style architecture.'},
    {name:'Hanuman Garhi', desc:'Fortress-like temple atop a hill. Most visited temple in Ayodhya. Believed Hanuman guards Ayodhya from here.'},
    {name:'Kanak Bhawan', desc:'Temple gifted to Sita by Kaikeyi. Beautiful Sita-Rama deities adorned with gold ornaments.'},
    {name:'ISKCON Ayodhya', desc:'Beautiful temple with Sita-Rama-Lakshmana-Hanuman deities.'},
    {name:'Dashrath Mahal', desc:'Palace of King Dasharatha, Rama\'s father. Ancient temple with historical significance.'},
    {name:'Sarayu Ghat', desc:'Sacred river. Ram Paidi ghat is the main bathing spot. Beautiful evening aarti.'},
    {name:'Nageshwarnath Temple', desc:'One of the oldest temples, believed established by Kush (Rama\'s son). Shiva temple.'},
    {name:'Treta Ke Thakur', desc:'Temple marking the spot where Rama performed Ashwamedha Yajna.'},
    {name:'Gulab Bari', desc:'Mughal-era garden with beautiful rose gardens and tombs. Historical interest.'},
  ],
  itinerary: `Day 1 â€” Ayodhya:
6:00 AM â€” Morning bath at Sarayu Ghat (Ram Paidi)
7:00 AM â€” Sri Ram Janmabhoomi Temple darshan
10:00 AM â€” Hanuman Garhi
11:30 AM â€” Kanak Bhawan, Dashrath Mahal
1:00 PM â€” Lunch
3:00 PM â€” ISKCON Ayodhya
5:00 PM â€” Nageshwarnath Temple, Treta Ke Thakur
6:30 PM â€” Evening Sarayu Aarti at the ghat
8:00 PM â€” Dinner, rest

Day 2 (Optional):
7:00 AM â€” Ayodhya Parikrama (~14 km circumambulation)
OR visit Naimisharanya (~90 km) â€” sacred forest where 60,000 sages heard the Puranas`,
  dos: `Do's:
â€¢ Take a dip in the Sarayu River â€” considered purifying
â€¢ Visit Ram Janmabhoomi with a devotional mood
â€¢ Dress modestly and respectfully
â€¢ Walk barefoot in the temple area if possible

Don'ts:
â€¢ No non-vegetarian food â€” most of Ayodhya is strictly vegetarian
â€¢ Don't carry large bags to Ram Janmabhoomi â€” security is strict
â€¢ Photography may be restricted inside the main temple
â€¢ Don't litter at the ghats`,
  bestTime: `Octâ€“Mar: Ideal weather (10â€“28Â°C). Diwali (Oct/Nov) is extraordinary.
Ram Navami (Mar/Apr): Hot but the festival experience is unparalleled.
Aprâ€“Jun: Very hot (40â€“45Â°C). Avoid unless necessary.
Julâ€“Sep: Monsoon â€” Sarayu can flood. Avoid.`,
  contacts: `Ram Janmabhoomi Trust: sriramjanmbhoomi.org
ISKCON Ayodhya: Contact through ISKCON website
Ayodhya Railway Station: 139
Airport: Maharishi Valmiki International Airport`,
  devoteeTips: `â€¢ The new Ram Mandir is magnificent â€” allow at least 2 hours for the full experience
â€¢ Ayodhya infrastructure is rapidly developing â€” expect changes in facilities and roads
â€¢ Carry cash â€” digital payments still limited in some areas
â€¢ The Deepotsav during Diwali is now a state-organized mega event â€” book accommodation months ahead
â€¢ Walking between temples is feasible â€” most are within 3 km radius
â€¢ Evening Sarayu Aarti is not to be missed â€” similar to Varanasi's Ganga Aarti but more intimate`
},
{
  id:'badrinath', name:'Sri Badrinath Dham', icon:'ðŸ”ï¸',
  location:'Chamoli, Uttarakhand, India', tag:'char-dham', tagLabel:'Char Dham',
  overview: `Badrinath is one of the four sacred Char Dhams, situated at an altitude of 3,133 meters in the Himalayas. The presiding deity is Lord Badrinarayana (Vishnu) in a meditative posture, along with Nara-Narayana.

The temple is nestled between the Nar and Narayana mountain ranges, on the banks of the Alaknanda River. It is believed that Lord Vishnu meditated here under a Badri (jujube) tree for the welfare of mankind.

The temple is one of the 108 Divya Desams and is open only for approximately 6 months (Mayâ€“November) due to extreme Himalayan winter conditions.`,
  scriptural: `â€¢ Srimad Bhagavatam describes Nara-Narayana Rishi performing austerities at Badrikashram.
â€¢ Mahabharata mentions Badrinath as a sacred pilgrimage site visited by the Pandavas.
â€¢ Vishnu Purana describes it as the holiest of all pilgrimage sites.
â€¢ Adi Shankaracharya is credited with establishing the present temple structure in the 8th century.
â€¢ The Alvars and Ramanujacharya recognized Badrinath as a primary Divya Desam.
â€¢ According to tradition, Lord Vishnu will eventually be worshipped at Badrinath as the only surviving temple in Kali Yuga.`,
  howToReach: `City: Badrinath, District Chamoli, Uttarakhand, India
Nearest Airport: Jolly Grant Airport, Dehradun â€” ~315 km
Nearest Railway: Rishikesh Railway Station â€” ~295 km; Haridwar â€” ~320 km
From Rishikesh: ~10-12 hours by road via Devprayag, Joshimath
Helicopter: Available from Dehradun/Phata (seasonal)
Route: Rishikesh â†’ Devprayag â†’ Rudraprayag â†’ Joshimath â†’ Badrinath
Tip: The road journey through the Himalayas is beautiful but challenging. Start very early. Landslides are common in monsoon.`,
  darshan: `Badrinath Temple:
â€¢ Mahabhishek Puja: 4:30 AM
â€¢ General Darshan: 7:00 AM â€“ 1:00 PM, 4:00 PM â€“ 9:00 PM
â€¢ Gita Path: 6:15 AM
â€¢ Sandhya Aarti: 7:30 PM (with beautiful lamps)

Opening ceremony: Akshaya Tritiya (Apr/May) â€” Kapaat (doors) open with grand celebration
Closing ceremony: Vijayadashami to Diwali period (Oct/Nov) â€” Kapaat close for winter

Best darshan: Early morning immediately after doors open.`,
  festivals: `â€¢ Kapaat Opening (Apr/May) â€” Grand ceremony when temple reopens for the season
â€¢ Mata Murti Ka Mela (Sep) â€” Celebrates the mother of Nara-Narayana
â€¢ Badri-Kedar Utsav (Jun) â€” Cultural festival
â€¢ Kapaat Closing (Oct/Nov) â€” Emotional ceremony, deity is shifted to Joshimath for winter
Best time to visit: Mayâ€“Jun and Sepâ€“Oct (pleasant weather, fewer landslides than monsoon).`,
  accommodation: `GMVN Guest House: Government run, reliable
Temple Committee Rest Houses: Basic, affordable
Hotels in Badrinath: Multiple options (â‚¹500â€“3000/night) â€” limited compared to city hotels
Joshimath: More options, 45 km before Badrinath, can be a base
Tip: Book in advance during peak season (Mayâ€“Jun). Options are limited in this small Himalayan town.`,
  prasadam: `Temple Prasadam: Available after darshan
Free community kitchens (Bhandaras): Operated by various trusts during season
Local Restaurants: Simple North Indian vegetarian fare
Note: At 3,133m altitude, food options are basic but adequate. Most serve pure veg.
Tip: Carry some snacks and dry fruits from lower altitudes â€” variety is limited in Badrinath.`,
  seva: `â€¢ Mahabhishek Puja (early morning)
â€¢ Abhishek with milk, curd, honey
â€¢ Various archana options
â€¢ Temple trust donations
Contact Badrinath Temple Committee for details.`,
  keyPlaces: [
    {name:'Badrinath Temple', desc:'Main temple. Lord Badrinarayana (Vishnu) in padmasana. One of the Char Dhams.'},
    {name:'Tapt Kund', desc:'Natural hot water spring right next to the temple. Bathe here before darshan â€” believed to be medicinal.'},
    {name:'Neelkanth Peak', desc:'Stunning 6,597m peak visible from Badrinath. Considered the abode of Lord Shiva.'},
    {name:'Mana Village', desc:'Last Indian village before the Tibet border (~3 km). Vyasa Cave where Mahabharata was written.'},
    {name:'Vasudhara Falls', desc:'~9 km trek from Mana. Magnificent 122m waterfall. Legend says water doesn\'t fall on sinners.'},
    {name:'Bheem Pul', desc:'Natural rock bridge in Mana. Legend says Bhima placed it for Draupadi to cross.'},
    {name:'Charan Paduka', desc:'~3 km trek. Rock bearing Lord Vishnu\'s footprints. Beautiful viewpoint.'},
    {name:'Joshimath', desc:'~45 km. Winter seat of Lord Badrinath. Adi Shankaracharya\'s math. Gateway to Badrinath.'},
  ],
  itinerary: `Day 1 â€” Badrinath:
5:00 AM â€” Tapt Kund hot spring bath
6:30 AM â€” Queue for morning darshan
8:30 AM â€” Breakfast
9:30 AM â€” Mana Village, Vyasa Cave, Bheem Pul
12:00 PM â€” Lunch
2:00 PM â€” Charan Paduka trek
4:30 PM â€” Return, evening darshan
7:30 PM â€” Sandhya Aarti (mesmerizing with lamp ceremony)
8:30 PM â€” Dinner, rest

Day 2 â€” Extended (if time permits):
6:00 AM â€” Vasudhara Falls trek (full day, ~18 km return)
OR drive to Joshimath â€” visit Shankaracharya Math, Narasimha Temple`,
  dos: `Do's:
â€¢ Bathe at Tapt Kund before darshan â€” it's tradition and the hot water is wonderful in the cold
â€¢ Carry warm clothing â€” temperatures drop sharply, especially evenings (5â€“15Â°C even in summer)
â€¢ Acclimatize properly â€” altitude sickness is possible
â€¢ Visit Mana Village â€” the last village of India, fascinating experience

Don'ts:
â€¢ Don't attempt the journey during heavy monsoon (Julâ€“Aug) â€” landslide risk
â€¢ Don't trek alone to remote spots without informing someone
â€¢ Don't underestimate the altitude and cold
â€¢ Don't litter â€” this is a fragile Himalayan ecosystem`,
  bestTime: `Temple open only Mayâ€“Nov (approximately).
Mayâ€“Jun: Best period. Roads clear, weather pleasant (10â€“18Â°C), wildflowers.
Julâ€“Aug: Monsoon â€” landslides, road closures common. Risky.
Sepâ€“Oct: Excellent. Clear skies, stunning views, fewer crowds.
Nov: Temple closing period â€” cold setting in.`,
  contacts: `Badrinath Temple Committee: +91-1381-222-024
GMVN Badrinath: +91-1381-222-012
Joshimath GMVN: +91-1389-222-118
Uttarakhand Tourism: 1364`,
  devoteeTips: `â€¢ Carry Diamox or consult a doctor about altitude sickness medication
â€¢ The Tapt Kund bath at dawn with snow peaks visible is a transcendent experience
â€¢ Road conditions change daily â€” check with locals before starting the drive
â€¢ If prone to motion sickness, take medication â€” the road has countless hairpin bends
â€¢ Carry a rain jacket even in summer â€” mountain weather is unpredictable
â€¢ The evening aarti with oil lamps against the Himalayan backdrop is unforgettable
â€¢ If doing the full Char Dham Yatra (Yamunotri, Gangotri, Kedarnath, Badrinath), allow 10-12 days minimum`
},
{
  id:'rameswaram', name:'Sri Rameswaram Dham', icon:'ðŸŒŠ',
  location:'Ramanathapuram, Tamil Nadu, India', tag:'char-dham', tagLabel:'Char Dham',
  overview: `Rameswaram is one of the four sacred Char Dhams, located on Pamban Island in the Gulf of Mannar. It is where Lord Ramachandra established and worshipped a Shiva Linga before crossing to Lanka to rescue Sita Devi.

The Ramanathaswamy Temple houses the longest corridor among all Hindu temples in India. The island is connected to mainland India by the Pamban Bridge.

Though primarily a Shiva Kshetra, it is deeply connected to Lord Rama's pastimes and is therefore supremely sacred for Vaishnavas as well â€” Lord Rama Himself established worship here.`,
  scriptural: `â€¢ Valmiki Ramayana describes Lord Rama worshipping Lord Shiva here before building the bridge (Setu) to Lanka.
â€¢ Srimad Bhagavatam references Setubandha Rameswaram as a sacred tirtha.
â€¢ Skanda Purana extensively glorifies Rameswaram.
â€¢ The Ramayana states that Rama installed two lingas â€” one brought by Sita (Ramalingam) and one made by Hanuman.
â€¢ It is said that visiting Rameswaram and bathing in its 22 sacred wells (theerthams) inside the temple absolves all sins.
â€¢ Adi Shankaracharya established a Shankara math here.`,
  howToReach: `City: Rameswaram, District Ramanathapuram, Tamil Nadu, India
Nearest Airport: Madurai Airport â€” ~175 km
Nearest Railway: Rameswaram Railway Station â€” ~1 km from main temple
From Madurai: ~4 hours by road, direct trains available
From Chennai: ~10 hours by road, overnight train
The Pamban Bridge (road + rail) connecting the island to mainland is an engineering marvel.
Tip: The train ride across Pamban Bridge is spectacular â€” sit by the window!`,
  darshan: `Ramanathaswamy Temple:
â€¢ Opens: 5:00 AM
â€¢ Morning Darshan: 5:00 AM â€“ 1:00 PM
â€¢ Evening Darshan: 3:00 PM â€“ 9:00 PM
â€¢ Special pujas and abhishekams throughout the day

22 Theerthams (sacred wells): Devotees bathe in all 22 wells inside the temple corridor for purification. Temple workers draw water from each well and pour it on devotees.

Best darshan: Early morning (5:00â€“7:00 AM), after completing the theertham bath.`,
  festivals: `â€¢ Maha Shivaratri (Feb/Mar) â€” Grand celebrations
â€¢ Ram Navami (Mar/Apr) â€” Lord Rama's appearance celebrated with great devotion
â€¢ Arudra Darshan (Dec/Jan) â€” Special Shiva worship
â€¢ Thirukalyanam (Jul) â€” Celestial wedding ceremony
â€¢ Navarathri (Sep/Oct) â€” Nine nights of celebration
Best time to visit: Octâ€“Apr (pleasant coastal weather).`,
  accommodation: `Temple Trust Guest Houses: Basic, affordable, near the temple
Hotels: Multiple options on the island (â‚¹400â€“2500/night)
TTDC Hotel Tamil Nadu: Government hotel, decent
Tip: Rameswaram is a small island â€” most accommodation is within walking distance of the temple. Book ahead during Shivaratri and Ram Navami.`,
  prasadam: `Temple Prasadam: Available at Ramanathaswamy Temple
Annadanam: Free meals served at various mandapams near the temple
Local Restaurants: South Indian vegetarian fare â€” idli, dosa, rice meals
Fresh seafood is available but not recommended for devotees seeking sattvik food.
Tip: Stick to the pure veg restaurants near the temple area.`,
  seva: `â€¢ Abhishekam to the main deity
â€¢ Archana (various types)
â€¢ Special pujas on auspicious days
â€¢ Anna danam (food distribution)
Contact the temple trust office near the main entrance.`,
  keyPlaces: [
    {name:'Ramanathaswamy Temple', desc:'Main temple with the longest corridor in India (1,220m). 22 sacred wells. Ancient Dravidian architecture.'},
    {name:'22 Theerthams', desc:'Sacred wells inside the temple. Bathing in all 22 grants complete purification.'},
    {name:'Gandhamadhana Parvatham', desc:'Small hillock â€” highest point on the island. Believed to have Rama\'s footprints. Panoramic views.'},
    {name:'Dhanushkodi', desc:'~18 km. Ghost town at the tip of the island, destroyed by 1964 cyclone. Where Adam\'s Bridge starts.'},
    {name:'Adam\'s Bridge (Ram Setu)', desc:'Chain of limestone shoals connecting India to Sri Lanka. Visible from Dhanushkodi. Believed to be Rama\'s bridge.'},
    {name:'Agni Theertham', desc:'Sacred beach next to the temple. Devotees bathe here before temple darshan.'},
    {name:'Pamban Bridge', desc:'Cantilever bridge connecting island to mainland. Engineering marvel. Beautiful views.'},
    {name:'Kothandaramaswamy Temple', desc:'~12 km. Temple where Vibhishana surrendered to Lord Rama. Survived the 1964 cyclone.'},
    {name:'Five-faced Hanuman Temple (Panchmukhi)', desc:'Floating stone from Ram Setu is worshipped here alongside five-faced Hanuman.'},
  ],
  itinerary: `Day 1 â€” Rameswaram:
5:00 AM â€” Agni Theertham bath (sea bath at dawn)
5:30 AM â€” 22 Theerthams bath inside temple
7:30 AM â€” Main deity darshan at Ramanathaswamy Temple
9:00 AM â€” Breakfast
10:00 AM â€” Gandhamadhana Parvatham
11:00 AM â€” Panchmukhi Hanuman Temple
12:30 PM â€” Lunch
3:00 PM â€” Drive to Dhanushkodi, see Adam\'s Bridge point
5:30 PM â€” Kothandaramaswamy Temple
7:00 PM â€” Evening darshan at main temple
8:30 PM â€” Dinner

Day 2 (If time):
6:00 AM â€” Revisit temple for peaceful morning darshan
8:00 AM â€” Explore Pamban town, local markets
10:00 AM â€” Depart`,
  dos: `Do's:
â€¢ Bathe at Agni Theertham before temple entry â€” it's tradition
â€¢ Complete all 22 theerthams â€” carry a change of dry clothes
â€¢ Visit Dhanushkodi â€” the landscape is surreal and deeply connected to the Ramayana
â€¢ Wear clothes that can get wet for the theertham bath

Don'ts:
â€¢ Don't skip the 22 theerthams bath â€” it's the unique offering of this Dham
â€¢ Don't swim deep at Agni Theertham â€” currents can be strong
â€¢ Don't take vehicles beyond the permitted point at Dhanushkodi
â€¢ Don't visit during cyclone warnings (Novâ€“Dec occasionally)`,
  bestTime: `Octâ€“Apr: Best weather (25â€“35Â°C), sea is calm
Mayâ€“Jul: Hot and humid (35â€“40Â°C) but manageable
Novâ€“Dec: Cyclone season â€” check weather before travel
The island has a tropical coastal climate â€” expect warm weather year-round.`,
  contacts: `Ramanathaswamy Temple Office: +91-4573-221-223
TTDC: +91-4573-221-373
Rameswaram Railway: 139`,
  devoteeTips: `â€¢ The 22 theerthams bath takes about 1.5â€“2 hours â€” be prepared to be drenched in cold well water
â€¢ Carry 2 sets of spare clothes â€” you'll need them after the theerthams
â€¢ The Dhanushkodi trip is best done by shared auto â€” road ends midway, you walk the rest
â€¢ Early morning at Agni Theertham with the sunrise is magical
â€¢ The temple corridors are the longest in India â€” walk slowly and take in the architecture
â€¢ If you can see Adam\'s Bridge on a clear day from Dhanushkodi, it\'s a deeply moving experience
â€¢ The wind at Dhanushkodi can be intense â€” hold onto hats and loose items`
},
{
  id:'udupi', name:'Sri Udupi Krishna', icon:'ðŸªˆ',
  location:'Udupi, Karnataka, India', tag:'divya-desam', tagLabel:'Madhva Heritage',
  overview: `Udupi is home to the famous Sri Krishna Matha (monastery), established by the great Vaishnava acharya Sri Madhvacharya in the 13th century. The presiding deity is Lord Krishna as a small child (Bala Krishna), holding a churning rod.

The unique Kanakana Kindi (small window) through which devotees take darshan is famous â€” it originates from the story of the devotee Kanakadasa who, being denied entry, prayed from behind the temple, and the wall broke open so he could see Krishna.

Udupi represents the Dvaita (dualistic) Vaishnava tradition and has been a center of Vedantic scholarship for over 700 years.`,
  scriptural: `â€¢ Madhvacharya (1238â€“1317 CE) founded the Krishna temple and the Ashta Mathas (eight monasteries) system.
â€¢ The deity was found by Madhvacharya in a ball of gopichandana (sacred clay) that arrived on a ship.
â€¢ The Paryaya system â€” where the headship of the temple rotates among 8 mathas every 2 years â€” has been followed for over 700 years.
â€¢ Madhvacharya's commentaries on Brahma Sutras, Bhagavad Gita, and Bhagavatam established the Dvaita school of Vedanta.
â€¢ Vadiraja Tirtha, Vyasatirtha, and other great Madhva saints enriched the tradition from Udupi.
â€¢ ISKCON's philosophy shares significant common ground with Madhva's Dvaita tradition â€” Srila Prabhupada acknowledged Madhva in our sampradaya lineage (Brahma-Madhva-Gaudiya).`,
  howToReach: `City: Udupi, Karnataka, India
Nearest Airport: Mangalore International Airport â€” ~60 km
Nearest Railway: Udupi Railway Station â€” ~4 km from Krishna Matha
From Bangalore: ~8 hours by road, overnight bus or train
From Mangalore: ~1.5 hours by road, local trains available
Local Transport: Auto-rickshaws, city buses
Tip: Udupi is well connected by the Konkan Railway. The coastal route from Goa/Mumbai is scenic.`,
  darshan: `Sri Krishna Matha:
â€¢ Mangala Pooja: 5:30 AM
â€¢ Morning Darshan: 6:00 AM â€“ 1:00 PM
â€¢ Madhyahna Pooja: 12:00 PM
â€¢ Chamara Seva: 12:30 PM
â€¢ Evening Darshan: 4:00 PM â€“ 8:30 PM
â€¢ Maha Pooja: 7:30 PM
â€¢ Ratri Pooja: 8:30 PM

Darshan through the Kanakana Kindi (window) is the traditional and special way.
Best time: Early morning (6:00â€“7:30 AM) or during Maha Pooja.`,
  festivals: `â€¢ Paryaya Festival (even years, January) â€” Grand ceremony of peethadhipathi (head priest) transfer. Once in 2 years. Massive.
â€¢ Krishna Janmashtami (Aug/Sep) â€” Grand celebration with Utsava murthy procession
â€¢ Madhva Navami (Jan/Feb) â€” Disappearance of Sri Madhvacharya
â€¢ Ratha Yatra â€” Annual chariot festival
â€¢ Makara Sankranti â€” Harvest festival with special pujas
Best time to visit: Octâ€“Mar. Paryaya year (next: Jan 2028) is extraordinary.`,
  accommodation: `Matha Guest Houses: Each of the 8 mathas runs guest houses â€” very affordable, includes meals
Hotels in Udupi: Multiple options (â‚¹500â€“3000/night)
Malpe Beach Resorts: ~6 km, beach-side options for a relaxed stay
Tip: Staying at a matha guest house gives the most authentic experience â€” wake up to temple bells and receive prasadam meals.`,
  prasadam: `Krishna Matha Free Meals: All 8 mathas serve free meals daily to thousands. The Damodar Matha and other mathas rotate kitchen duty.
Udupi Cuisine: World famous! The entire "Udupi restaurant" concept originated here. Dosa, idli, sambar â€” all sattvik.
Mitra Samaj: Famous local restaurant
Woodlands: Traditional Udupi meals
Tip: Udupi IS the origin of South Indian vegetarian cuisine. Every meal here is an experience. No onion/garlic in traditional matha food.`,
  seva: `â€¢ Abhisheka to Bala Krishna
â€¢ Anna Daana (food offering sponsorship)
â€¢ Tulabhara (weighing against grains/flowers as offering)
â€¢ Special pujas on festival days
Contact the current Paryaya Matha office.`,
  keyPlaces: [
    {name:'Sri Krishna Matha', desc:'Main temple. Bala Krishna deity discovered by Madhvacharya. Kanakana Kindi darshan.'},
    {name:'Ashta Mathas', desc:'Eight monasteries around the temple established by Madhva\'s direct disciples. Each takes turns managing the temple.'},
    {name:'Madhva Sarovara', desc:'Sacred tank where Madhvacharya is said to have manifested the Krishna deity from gopichandana clay.'},
    {name:'Anantheshwara Temple', desc:'Ancient temple predating Krishna Matha. Lord Shiva. Madhvacharya studied here as a child.'},
    {name:'Chandramouleshwara Temple', desc:'Where Madhvacharya took sannyasa. Ancient and serene.'},
    {name:'Malpe Beach', desc:'~6 km. Beautiful beach. Boat to St. Mary\'s Island (basalt rock columns â€” geological wonder).'},
    {name:'Manipal', desc:'~5 km. University town with museums, planetarium, and the Manipal End Point viewpoint.'},
    {name:'Pajaka Kshetra', desc:'~10 km. Birthplace of Sri Madhvacharya. Small temple and house marking the spot.'},
  ],
  itinerary: `Day 1 â€” Udupi:
5:30 AM â€” Morning pooja at Krishna Matha
7:00 AM â€” Breakfast prasadam at one of the mathas
8:30 AM â€” Visit all Ashta Mathas (walking tour around the temple)
10:00 AM â€” Anantheshwara Temple, Chandramouleshwara Temple
11:30 AM â€” Madhva Sarovara
12:00 PM â€” Lunch at matha (free prasadam)
3:00 PM â€” Malpe Beach, boat to St. Mary's Island (if time)
6:00 PM â€” Return for Maha Pooja (7:30 PM)
8:30 PM â€” Dinner at a traditional Udupi restaurant

Day 2 â€” Surroundings:
7:00 AM â€” Pajaka Kshetra (Madhvacharya's birthplace)
10:00 AM â€” Manipal (museum, viewpoint)
12:00 PM â€” Lunch, depart or explore local markets`,
  dos: `Do's:
â€¢ Take darshan through Kanakana Kindi â€” it's the hallmark experience of Udupi
â€¢ Eat at a matha guest house â€” the free prasadam tradition is 700+ years old
â€¢ Learn about the Paryaya system â€” it's a unique democratic institution in Hinduism
â€¢ Try the famous Udupi dosa â€” this is where it originated!

Don'ts:
â€¢ Don't wear shorts or sleeveless tops in the temple area
â€¢ Don't skip the matha meals â€” they are simple, delicious, and sacred
â€¢ Don't visit Malpe Beach during monsoon â€” rough seas
â€¢ Don't confuse Udupi restaurants outside with the authentic matha food â€” the original is much simpler and purer`,
  bestTime: `Octâ€“Mar: Ideal weather (22â€“33Â°C), pleasant coastal climate
Aprâ€“May: Warm but manageable
Junâ€“Sep: Heavy monsoon â€” very rainy but the landscape is lush green
Paryaya years (even years, January) offer the grandest celebrations.`,
  contacts: `Sri Krishna Matha: +91-820-252-1422
Udupi Tourism: udupi.nic.in
Railway Station: 139`,
  devoteeTips: `â€¢ The matha guest houses are the best-kept secret â€” â‚¹100â€“300/night with meals included
â€¢ If visiting during Paryaya, book months ahead and prepare for massive crowds
â€¢ The Kanakana Kindi darshan at 5:30 AM with the oil lamp is hauntingly beautiful
â€¢ Udupi is compact â€” everything is walkable within 2â€“3 km
â€¢ Buy sandalwood products and traditional bronze items from local shops
â€¢ St. Mary's Island boat trip is worth it if weather permits â€” unique geological formations
â€¢ Madhvacharya is in our Brahma-Madhva-Gaudiya sampradaya â€” this is our heritage too!`
}
];

// User/admin can add custom dhamas
let customDhamas = JSON.parse(localStorage.getItem('customDhamas') || '[]');
function getAllDhamas() { return [...DHAMAS, ...customDhamas]; }

function renderDhamas(filter) {
  const q = (filter !== undefined ? filter : document.getElementById('dhamSearchInp')?.value || '').trim().toLowerCase();
  const all = getAllDhamas();
  const pool = q ? all.filter(d =>
    d.name.toLowerCase().includes(q) ||
    d.location.toLowerCase().includes(q) ||
    (d.tagLabel||'').toLowerCase().includes(q)
  ) : all;

  const grid = document.getElementById('dhamasGrid');
  if (!pool.length) {
    grid.innerHTML = `<div style="grid-column:1/-1;padding:40px 16px;text-align:center;">
      <div style="font-size:2.5rem;margin-bottom:8px;">ðŸ›•</div>
      <div style="font-size:0.85rem;color:var(--text3);">${q ? 'No dhamas match "'+q+'"' : 'No dhamas added yet.'}</div>
    </div>`;
    return;
  }

  const admin = hasPermission('dhamas');
  grid.innerHTML = pool.map(d => {
    const isCustom = d.id.startsWith('custom_');
    const delBtn = admin && isCustom
      ? `<button class="dham-card-del" onclick="event.stopPropagation();deleteCustomDham('${d.id}')" title="Delete">âœ•</button>`
      : '';
    return `<div class="dham-card" onclick="openDhamDetail('${d.id}')">
      ${delBtn}
      <div class="dham-card-img">${d.icon || 'ðŸ›•'}</div>
      <div class="dham-card-body">
        <div class="dham-card-name">${d.name}</div>
        <div class="dham-card-loc">ðŸ“ ${d.location}</div>
        ${d.tag ? `<span class="dham-card-tag ${d.tag}">${d.tagLabel || d.tag}</span>` : ''}
      </div>
    </div>`;
  }).join('');
  updateDhamAdminUI();
}

function deleteCustomDham(id) {
  if (!hasPermission('dhamas')) return;
  if (!confirm('Delete this Dham?')) return;
  customDhamas = customDhamas.filter(d => d.id !== id);
  localStorage.setItem('customDhamas', JSON.stringify(customDhamas));
  renderDhamas();
  showToast('Dham deleted');
}

let _dhamDetailPrevScreen = 'dhamas';

// Rich text formatter for dham content
function _fmtDhamText(text) {
  if (!text) return '';
  const lines = text.split('\n');
  let html = '';
  let inPara = false;

  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    const trimmed = line.trim();

    // Empty line = paragraph break
    if (!trimmed) {
      if (inPara) { html += '</div>'; inPara = false; }
      continue;
    }

    // Bullet point line (â€¢ or -)
    if (/^[â€¢\-]\s/.test(trimmed)) {
      if (inPara) { html += '</div>'; inPara = false; }
      const bulletText = trimmed.replace(/^[â€¢\-]\s*/, '');
      html += `<div class="dham-bullet"><span>${_fmtInline(bulletText)}</span></div>`;
      continue;
    }

    // Time pattern: "6:00 AM â€” Activity" or "â€¢ Mangala Aarti: 4:30 AM"
    const timeMatch = trimmed.match(/^(\d{1,2}:\d{2}\s*(?:AM|PM)?)\s*[â€”â€“\-]\s*(.+)/i);
    if (timeMatch) {
      if (inPara) { html += '</div>'; inPara = false; }
      html += `<div class="dham-time-line"><span class="dham-time-badge">${timeMatch[1]}</span><span class="dham-time-desc">${_fmtInline(timeMatch[2])}</span></div>`;
      continue;
    }

    // "Tip:" line
    if (/^Tip:/i.test(trimmed)) {
      if (inPara) { html += '</div>'; inPara = false; }
      html += `<div class="dham-tip-box">ðŸ’¡ ${_fmtInline(trimmed)}</div>`;
      continue;
    }

    // Section subheader (line ending with : and next line is not empty)
    if (/^[A-Z].*:$/.test(trimmed) && trimmed.length < 60) {
      if (inPara) { html += '</div>'; inPara = false; }
      html += `<div style="font-weight:700;color:var(--text);font-size:0.84rem;margin-top:10px;margin-bottom:4px;">${_fmtInline(trimmed)}</div>`;
      continue;
    }

    // Regular paragraph text
    if (!inPara) {
      html += '<div class="dham-para">';
      inPara = true;
    } else {
      html += '\n';
    }
    html += _fmtInline(trimmed);
  }
  if (inPara) html += '</div>';
  return html;
}

// Inline formatting helper
function _fmtInline(text) {
  // Bold **text** or terms before colons in info lines
  return text
    .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
    .replace(/((?:City|Nearest Airport|Nearest Railway|From \w+|Local Transport|Website|Temple open|Note|Do'?s|Don'?ts):\s*)/g, '<span class="dham-info-label">$1</span>');
}

function openDhamDetail(id) {
  const d = getAllDhamas().find(x => x.id === id);
  if (!d) return;
  document.getElementById('dhamDetailTitle').textContent = d.name;

  const sections = [
    { icon:'ðŸ•‰ï¸', title:'Overview',                          accent:'purple', content: d.overview, open:true },
    { icon:'ðŸ“–', title:'Scriptural & Historical Significance',accent:'gold',   content: d.scriptural },
    { icon:'ðŸ—ºï¸', title:'Location & How to Reach',            accent:'blue',   content: d.howToReach },
    { icon:'ðŸ™', title:'Temple Timings & Darshan',            accent:'green',  content: d.darshan },
    { icon:'ðŸŽª', title:'Festivals & Special Days',            accent:'orange', content: d.festivals },
    { icon:'ðŸ¨', title:'Accommodation',                       accent:'teal',   content: d.accommodation },
    { icon:'ðŸš', title:'Prasadam & Food',                     accent:'gold',   content: d.prasadam },
    { icon:'ðŸ’', title:'Seva & Donations',                    accent:'rose',   content: d.seva },
    { icon:'ðŸ“', title:'Key Places to Visit',                 accent:'purple', content: null, places: d.keyPlaces },
    { icon:'ðŸ“‹', title:'Suggested Itinerary',                 accent:'blue',   content: d.itinerary },
    { icon:'âœ…', title:"Do's & Don'ts",                       accent:'green',  content: d.dos },
    { icon:'ðŸŒ¤ï¸', title:'Best Time to Visit',                  accent:'orange', content: d.bestTime },
    { icon:'ðŸ“ž', title:'Important Contacts',                  accent:'teal',   content: d.contacts },
    { icon:'ðŸ’¡', title:'Devotee Tips',                        accent:'gold',   content: d.devoteeTips },
  ];

  let html = `<div class="dham-hero">
    <div class="dham-hero-icon">${d.icon || 'ðŸ›•'}</div>
    <div class="dham-hero-name">${d.name}</div>
    <div class="dham-hero-loc">ðŸ“ ${d.location}</div>
  </div>
  <div class="dham-sections-wrap">`;

  sections.forEach((sec, idx) => {
    if (!sec.content && !sec.places) return;
    const openCls = sec.open ? ' open' : '';
    html += `<div class="dham-section${openCls}" data-accent="${sec.accent}">
      <div class="dham-section-hdr" onclick="this.parentElement.classList.toggle('open')">
        <div class="dham-section-icon">${sec.icon}</div>
        <div class="dham-section-title">${sec.title}</div>
        <div class="dham-section-chevron">â–¼</div>
      </div>
      <div class="dham-section-body">`;

    if (sec.places && sec.places.length) {
      html += sec.places.map((p,i) => `
        <div class="dham-place-item">
          <div class="dham-place-num">${i+1}</div>
          <div class="dham-place-text"><strong>${p.name}</strong>${p.desc}</div>
        </div>`).join('');
    } else if (sec.content) {
      if (sec.title.includes('Itinerary')) {
        const days = sec.content.split(/(?=Day \d)/);
        html += days.map(day => {
          const lines = day.trim().split('\n');
          const label = lines[0];
          const body = lines.slice(1).join('\n').trim();
          return `<div class="dham-itinerary-day">
            <div class="dham-itinerary-label">${label}</div>
            <div>${_fmtDhamText(body)}</div>
          </div>`;
        }).join('');
      } else {
        html += `<div>${_fmtDhamText(sec.content)}</div>`;
      }
    }
    html += `</div></div>`;
  });

  html += `</div>`;

  document.getElementById('dhamDetailBody').innerHTML = html;

  _dhamDetailPrevScreen = document.querySelector('.screen.active')?.id?.replace('screen-','') || 'dhamas';
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-dham-detail').classList.add('active');
  document.getElementById('headerDate').textContent = d.name;
  document.getElementById('headerMasa').style.display = 'none';
  document.getElementById('headerIcons').style.display = 'none';
  document.getElementById('dhamDetailBody').scrollTop = 0;
}

function closeDhamDetail() {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-' + _dhamDetailPrevScreen).classList.add('active');
  if (_dhamDetailPrevScreen === 'dhamas') {
    document.getElementById('headerDate').textContent = 'Holy Dhamas';
    document.getElementById('headerMasa').style.display = 'none';
  }
}

// ===== ADMIN: ADD DHAM =====
function openAddDham() {
  if (!hasPermission('dhamas')) { showToast('Dhamas admin access required'); return; }
  // Clear form
  ['dhamFName','dhamFLoc','dhamFIcon','dhamFOverview','dhamFScript','dhamFReach',
   'dhamFDarshan','dhamFFest','dhamFAccom','dhamFFood','dhamFSeva','dhamFPlaces',
   'dhamFItin','dhamFDos','dhamFBest','dhamFContacts','dhamFTips'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.value = '';
  });
  document.getElementById('dhamFTag').value = '';
  document.getElementById('addDhamModal').classList.add('open');
}

function saveNewDham() {
  if (!hasPermission('dhamas')) return;
  const name = document.getElementById('dhamFName').value.trim();
  const loc  = document.getElementById('dhamFLoc').value.trim();
  const overview = document.getElementById('dhamFOverview').value.trim();
  if (!name || !loc || !overview) { showToast('Name, Location, and Overview are required'); return; }

  const tagVal = document.getElementById('dhamFTag').value;
  const TAG_LABELS = {'char-dham':'Char Dham','divya-desam':'Divya Desam','iskcon':'ISKCON','shakti-peetha':'Shakti Peetha'};

  // Parse key places
  const placesRaw = document.getElementById('dhamFPlaces').value.trim();
  const keyPlaces = placesRaw ? placesRaw.split('\n').filter(l=>l.trim()).map(line => {
    const parts = line.split('|');
    return { name: (parts[0]||'').trim(), desc: (parts[1]||'').trim() };
  }) : [];

  const dham = {
    id: 'custom_' + Date.now(),
    name, location: loc,
    icon: document.getElementById('dhamFIcon').value.trim() || 'ðŸ›•',
    tag: tagVal, tagLabel: TAG_LABELS[tagVal] || '',
    overview,
    scriptural: document.getElementById('dhamFScript').value.trim(),
    howToReach: document.getElementById('dhamFReach').value.trim(),
    darshan: document.getElementById('dhamFDarshan').value.trim(),
    festivals: document.getElementById('dhamFFest').value.trim(),
    accommodation: document.getElementById('dhamFAccom').value.trim(),
    prasadam: document.getElementById('dhamFFood').value.trim(),
    seva: document.getElementById('dhamFSeva').value.trim(),
    keyPlaces,
    itinerary: document.getElementById('dhamFItin').value.trim(),
    dos: document.getElementById('dhamFDos').value.trim(),
    bestTime: document.getElementById('dhamFBest').value.trim(),
    contacts: document.getElementById('dhamFContacts').value.trim(),
    devoteeTips: document.getElementById('dhamFTips').value.trim(),
  };

  customDhamas.push(dham);
  localStorage.setItem('customDhamas', JSON.stringify(customDhamas));
  closeModal('addDhamModal');
  renderDhamas();
  showToast('Dham added âœ“');
}

// Update dham add button visibility
function updateDhamAdminUI() {
  const btn = document.getElementById('dhamAddBtn');
  if (btn) btn.style.display = hasPermission('dhamas') ? '' : 'none';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTO UPDATE NOTIFICATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function _appContentHash() {
  // Generate a simple hash from the page's own script content
  const scripts = document.querySelectorAll('script:not([src])');
  let content = '';
  scripts.forEach(s => content += s.textContent);
  // Also include key structural HTML (categories, settings sections, etc.)
  const mainEl = document.getElementById('screen-settings');
  if (mainEl) content += mainEl.innerHTML.length;
  const songsEl = document.getElementById('screen-songs');
  if (songsEl) content += songsEl.innerHTML.length;
  // djb2 hash
  let hash = 5381;
  for (let i = 0; i < content.length; i++) {
    hash = ((hash << 5) + hash + content.charCodeAt(i)) & 0xFFFFFFFF;
  }
  return hash.toString(36);
}

function checkForAppUpdate() {
  try {
    const currentHash = _appContentHash();
    const storedHash = localStorage.getItem('_appHash');
    if (!storedHash) {
      // First time using the app â€” just store hash, don't show banner
      localStorage.setItem('_appHash', currentHash);
      return;
    }
    if (storedHash !== currentHash) {
      // App has been updated â€” show banner after a short delay
      setTimeout(() => {
        const banner = document.getElementById('updateBanner');
        if (banner) banner.classList.add('show');
        // Auto-dismiss after 8 seconds
        setTimeout(() => dismissUpdateBanner(), 4000);
      }, 1200);
    }
  } catch(e) {}
}

function dismissUpdateBanner() {
  const banner = document.getElementById('updateBanner');
  if (banner) banner.classList.remove('show');
  // Save current hash so banner doesn't show again
  try {
    localStorage.setItem('_appHash', _appContentHash());
  } catch(e) {}
}

// ===================================================================
// SEVAKART â€” Devotee Service Directory
// ===================================================================
const SK_CATEGORIES = [
  {id:'Deity Services', icon:'ðŸª·', name:'Deity Services'},
  {id:'Prasadam & Catering', icon:'ðŸ²', name:'Prasadam'},
  {id:'Kirtan & Events', icon:'ðŸŽµ', name:'Kirtan & Events'},
  {id:'Devotional Products', icon:'ðŸ“¿', name:'Products'},
  {id:'Education', icon:'ðŸ“–', name:'Education'},
  {id:'Professional Services', icon:'ðŸ’¼', name:'Professional'},
  {id:'Temple Supplies', icon:'ðŸ›•', name:'Temple'},
  {id:'Yatra & Travel', icon:'ðŸš', name:'Yatra'}
];

// Data storage
let skListings = JSON.parse(localStorage.getItem('skListings') || '[]');
let skReviews = JSON.parse(localStorage.getItem('skReviews') || '[]');
let skReports = JSON.parse(localStorage.getItem('skReports') || '[]');
let _skFilter = {category:'', city:''};
let _skViewingId = null;
let _skPhotoData = [null,null,null];
let _skPhotoSlot = 0;
let _skReviewRating = 0;
let _skRejectingId = null;
let _skEditingId = null;

function _skSave() {
  localStorage.setItem('skListings', JSON.stringify(skListings));
  localStorage.setItem('skReviews', JSON.stringify(skReviews));
  localStorage.setItem('skReports', JSON.stringify(skReports));
  // Sync to server
  _skSyncToServer();
}

// Sync to Google Sheets (reuses SONGS_API_URL endpoint)
async function _skSyncToServer() {
  try {
    const userEmail = (gUser && gUser.email) ? gUser.email : '';
    await fetch(SONGS_API_URL, {
      method:'POST',
      headers:{'Content-Type':'text/plain'},
      body: JSON.stringify({
        action:'saveSevakart',
        listings: skListings,
        reviews: skReviews,
        reports: skReports,
        updatedBy: userEmail
      })
    });
  } catch(e) { /* offline fallback */ }
}

async function _skFetchFromServer() {
  try {
    const resp = await fetch(SONGS_API_URL + '?type=sevakart');
    const data = await resp.json();
    if (data.success && data.listings) {
      skListings = data.listings;
      if (data.reviews) skReviews = data.reviews;
      if (data.reports) skReports = data.reports;
      localStorage.setItem('skListings', JSON.stringify(skListings));
      localStorage.setItem('skReviews', JSON.stringify(skReviews));
      localStorage.setItem('skReports', JSON.stringify(skReports));
    }
  } catch(e) { /* offline - use localStorage */ }
}

function _skGetApprovedListings() {
  return skListings.filter(l => l.status === 'approved');
}

function _skGetRating(listingId) {
  const revs = skReviews.filter(r => r.listingId === listingId);
  if (!revs.length) return {avg:0, count:0};
  const sum = revs.reduce((a,r) => a + r.rating, 0);
  return {avg: (sum/revs.length).toFixed(1), count: revs.length};
}

function _skStarStr(rating) {
  const full = Math.floor(rating);
  let s = '';
  for (let i=0;i<5;i++) s += i < full ? 'â˜…' : 'â˜†';
  return s;
}

// ---- Render Home ----
function skRenderHome() {
  // Categories grid
  const catGrid = document.getElementById('skCategoriesGrid');
  catGrid.innerHTML = SK_CATEGORIES.map(c =>
    `<div class="sk-cat-card" onclick="skFilterByCategory('${c.id}')">
      <div class="sk-cat-icon">${c.icon}</div>
      <div class="sk-cat-name">${c.name}</div>
    </div>`
  ).join('');

  // Filter chips in modal
  const filterCats = document.getElementById('skFilterCats');
  filterCats.innerHTML = SK_CATEGORIES.map(c =>
    `<div class="sk-filter-chip ${_skFilter.category===c.id?'active':''}" onclick="this.classList.toggle('active');skToggleFilterCat('${c.id}')">${c.icon} ${c.name}</div>`
  ).join('');

  skRenderListings();
}

function skRenderListings() {
  const container = document.getElementById('skListingsContainer');
  const empty = document.getElementById('skEmptyState');
  const titleEl = document.getElementById('skListingsTitle');
  const query = (document.getElementById('skSearchInp')?.value || '').toLowerCase();

  let listings = _skGetApprovedListings();

  // Apply filters
  if (_skFilter.category) {
    listings = listings.filter(l => l.category === _skFilter.category);
    titleEl.textContent = _skFilter.category;
  } else {
    titleEl.textContent = 'Featured Listings';
  }
  if (_skFilter.city) {
    listings = listings.filter(l => l.city.toLowerCase().includes(_skFilter.city.toLowerCase()));
  }
  if (query) {
    listings = listings.filter(l =>
      l.bizName.toLowerCase().includes(query) ||
      l.city.toLowerCase().includes(query) ||
      l.category.toLowerCase().includes(query) ||
      (l.shortDesc||'').toLowerCase().includes(query)
    );
  }

  if (!listings.length) {
    container.innerHTML = '';
    empty.style.display = '';
    return;
  }
  empty.style.display = 'none';

  container.innerHTML = listings.map(l => {
    const r = _skGetRating(l.id);
    const img = l.photos && l.photos[0]
      ? `<img src="${l.photos[0]}" alt="">`
      : (SK_CATEGORIES.find(c=>c.id===l.category)?.icon || 'ðŸª”');
    return `<div class="sk-listing-card" onclick="skOpenDetail('${l.id}')">
      <div class="sk-listing-img">${typeof img === 'string' && img.startsWith('<') ? img : img}</div>
      <div class="sk-listing-body">
        <div class="sk-listing-top">
          <div class="sk-listing-name">${l.bizName}</div>
          ${l.verified ? '<div class="sk-listing-verified">âœ“ Verified</div>' : ''}
        </div>
        <div class="sk-listing-desc">${l.shortDesc||''}</div>
        <div class="sk-listing-meta">
          <span class="sk-listing-city">ðŸ“ ${l.city}</span>
          ${r.count ? `<span class="sk-listing-rating">${_skStarStr(r.avg)} ${r.avg} (${r.count})</span>` : ''}
          <span class="sk-listing-cat-tag">${l.category}</span>
        </div>
      </div>
    </div>`;
  }).join('');
}

function skFilterListings() { skRenderListings(); }
function skFilterByCategory(cat) {
  _skFilter.category = _skFilter.category === cat ? '' : cat;
  skRenderListings();
}
function skToggleFilterCat(cat) { _skFilter.category = _skFilter.category === cat ? '' : cat; }
function skApplyFilter() {
  _skFilter.city = document.getElementById('skFilterCity').value;
  closeModal('skFilterModal');
  skRenderListings();
}
function skClearFilter() {
  _skFilter = {category:'',city:''};
  document.getElementById('skFilterCity').value = '';
  closeModal('skFilterModal');
  skRenderListings();
}

// ---- Detail View ----
function skOpenDetail(id) {
  const l = skListings.find(x => x.id === id);
  if (!l) return;
  _skViewingId = id;

  document.getElementById('skDetailHTitle').textContent = l.bizName;
  const content = document.getElementById('skDetailContent');

  const r = _skGetRating(id);
  const reviews = skReviews.filter(rv => rv.listingId === id).slice(-3).reverse();
  const isSkAdmin = hasPermission('sevakart');
  const userEmail = gUser?.email?.toLowerCase() || '';
  const hasReviewed = skReviews.some(rv => rv.listingId === id && rv.userEmail === userEmail);
  const hasContacted = localStorage.getItem('skContacted:'+id);

  // Gallery
  const photos = (l.photos||[]).filter(Boolean);
  let galleryHTML = '';
  if (photos.length) {
    galleryHTML = `<div class="sk-detail-gallery"><img src="${photos[0]}" alt="" id="skGalleryImg">
      ${photos.length > 1 ? `<div class="sk-detail-gallery-dots">${photos.map((_,i) =>
        `<div class="sk-detail-gallery-dot ${i===0?'active':''}" onclick="document.getElementById('skGalleryImg').src='${photos[i]}';document.querySelectorAll('.sk-detail-gallery-dot').forEach((d,j)=>d.classList.toggle('active',j===${i}))"></div>`
      ).join('')}</div>` : ''}
    </div>`;
  } else {
    const catIcon = SK_CATEGORIES.find(c=>c.id===l.category)?.icon || 'ðŸª”';
    galleryHTML = `<div class="sk-detail-gallery"><div class="sk-detail-gallery-placeholder">${catIcon}</div></div>`;
  }

  content.innerHTML = `
    ${galleryHTML}
    <div class="sk-detail-body">
      <div class="sk-detail-name">${l.bizName}</div>
      <div class="sk-detail-badges">
        <span class="sk-detail-cat">${l.category}</span>
        <span class="sk-detail-city-tag">ðŸ“ ${l.city}</span>
        ${l.verified ? '<span class="sk-detail-verified">âœ“ Verified Devotee</span>' : ''}
      </div>
      ${r.count ? `<div class="sk-detail-rating-row">
        <span class="sk-detail-stars">${_skStarStr(r.avg)}</span>
        <span class="sk-detail-rating-num">${r.avg} Â· ${r.count} review${r.count>1?'s':''}</span>
      </div>` : ''}
      <div class="sk-detail-desc">${l.fullDesc || l.shortDesc || ''}</div>
      ${l.years ? `<div class="sk-detail-years">ðŸ• ${l.years} years in service</div>` : ''}

      <div class="sk-detail-section">
        <div class="sk-detail-section-title">Contact</div>
        <div class="sk-contact-btns">
          ${l.whatsapp || l.mobile ? `<a class="sk-contact-btn whatsapp" href="https://wa.me/${(l.whatsapp||l.mobile).replace(/[^0-9]/g,'')}" target="_blank" rel="noopener" onclick="localStorage.setItem('skContacted:${id}','1')">ðŸ’¬ WhatsApp</a>` : ''}
          ${l.mobile ? `<a class="sk-contact-btn call" href="tel:${l.mobile}" onclick="localStorage.setItem('skContacted:${id}','1')">ðŸ“ž Call</a>` : ''}
          ${l.email ? `<a class="sk-contact-btn email" href="mailto:${l.email}">âœ‰ Email</a>` : ''}
          ${l.website ? `<a class="sk-contact-btn website" href="${l.website}" target="_blank" rel="noopener">ðŸ”— Website</a>` : ''}
        </div>
        <div class="sk-disclaimer">SevaKart facilitates connection. All transactions happen directly between users.</div>
      </div>

      <div class="sk-detail-section">
        <div class="sk-detail-section-title">Reviews</div>
        ${reviews.length ? reviews.map(rv => `
          <div class="sk-review-card">
            <div class="sk-review-top">
              <span class="sk-review-user">${rv.userName||'Devotee'}</span>
              <span class="sk-review-stars">${_skStarStr(rv.rating)}</span>
            </div>
            ${rv.text ? `<div class="sk-review-text">${rv.text}</div>` : ''}
            <div class="sk-review-date">${rv.date||''}</div>
          </div>
        `).join('') : '<div style="font-size:0.8rem;color:var(--text3);margin-bottom:8px;">No reviews yet.</div>'}
        ${!hasReviewed && hasContacted && isSignedIn() ? `<button class="sk-add-review-btn" onclick="skOpenReview()">â­ Write a Review</button>` : ''}
        ${!hasReviewed && !hasContacted && isSignedIn() ? '<div style="font-size:0.72rem;color:var(--text3);margin-top:4px;">Contact the service first to leave a review.</div>' : ''}
        ${!isSignedIn() ? '<div style="font-size:0.72rem;color:var(--text3);margin-top:4px;">Sign in to leave a review.</div>' : ''}
      </div>

      <button class="sk-report-btn" onclick="skOpenReport()">ðŸš© Report this listing</button>

      ${isSkAdmin ? `<div class="sk-detail-section">
        <div class="sk-detail-section-title">ðŸ›¡ï¸ Admin Actions</div>
        <div style="font-size:0.72rem;color:var(--text3);margin-bottom:8px;">Status: <strong>${l.status}</strong> ${l.verified?'Â· âœ“ Verified':''}</div>
        <div class="sk-admin-actions">
          ${l.status!=='approved' ? `<button class="sk-admin-btn approve" onclick="skAdminAction('approve')">âœ“ Approve</button>` : ''}
          ${l.status!=='rejected' ? `<button class="sk-admin-btn reject" onclick="skAdminAction('reject')">âœ• Reject</button>` : ''}
          ${!l.verified ? `<button class="sk-admin-btn verify" onclick="skAdminAction('verify')">ðŸ… Verify</button>` : `<button class="sk-admin-btn verify" onclick="skAdminAction('unverify')">Remove Badge</button>`}
          ${l.status!=='suspended' ? `<button class="sk-admin-btn suspend" onclick="skAdminAction('suspend')">â¸ Suspend</button>` : `<button class="sk-admin-btn approve" onclick="skAdminAction('approve')">Unsuspend</button>`}
          <button class="sk-admin-btn delete" onclick="skAdminAction('delete')">ðŸ—‘ Delete</button>
        </div>
      </div>` : ''}
    </div>
  `;

  // Switch screen
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('screen-sevakart-detail').classList.add('active');
}

function skCloseDetail() {
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('screen-sevakart').classList.add('active');
  _skViewingId = null;
}

function skBackToMain() {
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('screen-sevakart').classList.add('active');
}

// ---- My Listings ----
function skShowMyListings() {
  if (!isSignedIn()) { showToast('Please sign in first'); return; }
  const container = document.getElementById('skMyListingsContainer');
  const email = gUser.email.toLowerCase();
  const mine = skListings.filter(l => l.ownerEmail === email);

  if (!mine.length) {
    container.innerHTML = '<div class="sk-empty"><div class="sk-empty-icon">ðŸ“‹</div><div>You haven\'t listed any services yet.</div></div>';
  } else {
    container.innerHTML = mine.map(l => {
      const statusCls = l.status || 'pending';
      return `<div class="sk-listing-card" onclick="skOpenDetail('${l.id}')">
        <div class="sk-listing-body">
          <div class="sk-listing-top">
            <div class="sk-listing-name">${l.bizName}</div>
            <div class="sk-listing-status ${statusCls}">${statusCls.toUpperCase()}</div>
          </div>
          <div class="sk-listing-desc">${l.shortDesc||''}</div>
          <div class="sk-listing-meta">
            <span class="sk-listing-city">ðŸ“ ${l.city}</span>
            <span class="sk-listing-cat-tag">${l.category}</span>
          </div>
        </div>
      </div>`;
    }).join('');
  }

  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('screen-sevakart-mylistings').classList.add('active');
}

// ---- Pending/Reported for Admin ----
function skShowPendingListings() {
  const container = document.getElementById('skMyListingsContainer');
  const pending = skListings.filter(l => l.status === 'pending');
  document.querySelector('#screen-sevakart-mylistings .sk-detail-htitle').textContent = 'Pending Approvals';

  if (!pending.length) {
    container.innerHTML = '<div class="sk-empty"><div class="sk-empty-icon">âœ…</div><div>No pending listings.</div></div>';
  } else {
    container.innerHTML = pending.map(l => `<div class="sk-listing-card" onclick="skOpenDetail('${l.id}')">
      <div class="sk-listing-body">
        <div class="sk-listing-top"><div class="sk-listing-name">${l.bizName}</div>
          <div class="sk-listing-status pending">PENDING</div></div>
        <div class="sk-listing-desc">${l.shortDesc||''}</div>
        <div class="sk-listing-meta"><span class="sk-listing-city">ðŸ“ ${l.city}</span>
          <span class="sk-listing-cat-tag">${l.category}</span></div>
      </div>
    </div>`).join('');
  }

  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('screen-sevakart-mylistings').classList.add('active');
}

function skShowReportedListings() {
  const container = document.getElementById('skMyListingsContainer');
  document.querySelector('#screen-sevakart-mylistings .sk-detail-htitle').textContent = 'Reported Listings';
  const unresolvedReports = skReports.filter(r => !r.resolved);
  const reportedIds = [...new Set(unresolvedReports.map(r => r.listingId))];
  const reported = skListings.filter(l => reportedIds.includes(l.id));

  if (!reported.length) {
    container.innerHTML = '<div class="sk-empty"><div class="sk-empty-icon">âœ…</div><div>No reported listings.</div></div>';
  } else {
    container.innerHTML = reported.map(l => {
      const rCount = unresolvedReports.filter(r=>r.listingId===l.id).length;
      return `<div class="sk-listing-card" onclick="skOpenDetail('${l.id}')">
        <div class="sk-listing-body">
          <div class="sk-listing-top"><div class="sk-listing-name">${l.bizName}</div>
            <div class="sk-listing-status rejected">ðŸš© ${rCount} report${rCount>1?'s':''}</div></div>
          <div class="sk-listing-desc">${l.shortDesc||''}</div>
        </div>
      </div>`;
    }).join('');
  }

  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('screen-sevakart-mylistings').classList.add('active');
}

// ---- Admin Actions ----
function skAdminAction(action) {
  if (!hasPermission('sevakart')) { showToast('SevaKart admin access required'); return; }
  const l = skListings.find(x => x.id === _skViewingId);
  if (!l) return;

  switch(action) {
    case 'approve':
      l.status = 'approved';
      showToast('Listing approved âœ“');
      break;
    case 'reject':
      _skRejectingId = _skViewingId;
      document.getElementById('skRejectModal').classList.add('open');
      return;
    case 'verify':
      l.verified = true;
      showToast('Verified badge added âœ“');
      break;
    case 'unverify':
      l.verified = false;
      showToast('Verified badge removed');
      break;
    case 'suspend':
      l.status = 'suspended';
      showToast('Listing suspended');
      break;
    case 'delete':
      if (!confirm('Permanently delete this listing?')) return;
      skListings = skListings.filter(x => x.id !== _skViewingId);
      _skSave();
      skCloseDetail();
      skRenderHome();
      showToast('Listing deleted');
      return;
  }
  _skSave();
  skOpenDetail(_skViewingId); // Refresh detail
}

function skConfirmReject() {
  const reason = document.getElementById('skRejectReason').value.trim();
  if (!reason) { showToast('Please provide a reason'); return; }
  const l = skListings.find(x => x.id === _skRejectingId);
  if (l) {
    l.status = 'rejected';
    l.rejectReason = reason;
    _skSave();
  }
  closeModal('skRejectModal');
  document.getElementById('skRejectReason').value = '';
  if (_skViewingId === _skRejectingId) skOpenDetail(_skViewingId);
  showToast('Listing rejected');
}

// ---- Listing Form ----
let _skFormStep = 1;

function skStartListing() {
  if (!isSignedIn()) { showToast('Please sign in to list a service'); return; }
  _skEditingId = null;
  _skFormStep = 1;
  _skPhotoData = [null,null,null];
  // Reset form
  document.getElementById('skElig1').checked = false;
  document.getElementById('skElig2').checked = false;
  document.getElementById('skBizName').value = '';
  document.getElementById('skContactName').value = gUser.name || '';
  document.getElementById('skMobile').value = '';
  document.getElementById('skWASame').checked = true;
  document.getElementById('skWA').value = '';
  document.getElementById('skWA').disabled = true;
  document.getElementById('skEmail').value = gUser.email || '';
  document.getElementById('skCity').value = '';
  document.getElementById('skCategory').value = '';
  document.getElementById('skShortDesc').value = '';
  document.getElementById('skFullDesc').value = '';
  document.getElementById('skYears').value = '';
  document.getElementById('skWebsite').value = '';
  document.getElementById('skTerms').checked = false;
  _skUpdatePhotoSlots();
  _skUpdateStepUI();
  document.getElementById('skListModalTitle').textContent = 'ðŸª” List Your Service';
  document.getElementById('skListModal').classList.add('open');
}

function _skUpdateStepUI() {
  document.querySelectorAll('.sk-form-step').forEach((s,i) => {
    s.classList.toggle('active', i === _skFormStep - 1);
  });
  document.querySelectorAll('#skStepIndicator .sk-step-dot').forEach((d,i) => {
    d.className = 'sk-step-dot' + (i === _skFormStep-1 ? ' active' : (i < _skFormStep-1 ? ' done' : ''));
  });
}

function skNextStep(from) {
  if (from === 1) {
    if (!document.getElementById('skElig1').checked || !document.getElementById('skElig2').checked) {
      showToast('Please confirm both eligibility checks'); return;
    }
    _skFormStep = 2;
  } else if (from === 2) {
    // Validate
    const bn = document.getElementById('skBizName').value.trim();
    const cn = document.getElementById('skContactName').value.trim();
    const mob = document.getElementById('skMobile').value.trim();
    const city = document.getElementById('skCity').value.trim();
    const cat = document.getElementById('skCategory').value;
    const sd = document.getElementById('skShortDesc').value.trim();
    if (!bn||!cn||!mob||!city||!cat||!sd) { showToast('Please fill all required fields (*)'); return; }
    _skFormStep = 3;
    _skBuildPreview();
  }
  _skUpdateStepUI();
}

function skPrevStep(from) {
  _skFormStep = from - 1;
  _skUpdateStepUI();
}

function _skBuildPreview() {
  const p = document.getElementById('skPreviewContainer');
  const fields = [
    ['Business Name', document.getElementById('skBizName').value],
    ['Contact', document.getElementById('skContactName').value],
    ['Mobile', document.getElementById('skMobile').value],
    ['City', document.getElementById('skCity').value],
    ['Category', document.getElementById('skCategory').value],
    ['Description', document.getElementById('skShortDesc').value],
  ];
  const full = document.getElementById('skFullDesc').value;
  if (full) fields.push(['Full Description', full]);
  const yrs = document.getElementById('skYears').value;
  if (yrs) fields.push(['Years in Service', yrs]);

  p.innerHTML = '<div style="font-size:0.85rem;color:var(--text2);margin-bottom:10px;">Review your listing:</div>' +
    fields.map(([lbl,val]) => `<div class="sk-preview-card"><div class="sk-preview-label">${lbl}</div><div class="sk-preview-value">${val}</div></div>`).join('');
}

// Photo handling
function skPickPhoto(slot) {
  _skPhotoSlot = slot;
  document.getElementById('skPhotoInput').click();
}

function skHandlePhoto(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    // Compress if needed
    const img = new Image();
    img.onload = function() {
      const canvas = document.createElement('canvas');
      const maxW = 600;
      let w = img.width, h = img.height;
      if (w > maxW) { h = h * maxW / w; w = maxW; }
      canvas.width = w; canvas.height = h;
      canvas.getContext('2d').drawImage(img, 0, 0, w, h);
      _skPhotoData[_skPhotoSlot] = canvas.toDataURL('image/jpeg', 0.7);
      _skUpdatePhotoSlots();
    };
    img.src = e.target.result;
  };
  reader.readAsDataURL(file);
  event.target.value = '';
}

function skRemovePhoto(slot) {
  _skPhotoData[slot] = null;
  _skUpdatePhotoSlots();
}

function _skUpdatePhotoSlots() {
  const slots = document.querySelectorAll('#skPhotoUpload .sk-photo-slot');
  slots.forEach((slot, i) => {
    if (_skPhotoData[i]) {
      slot.innerHTML = `<img src="${_skPhotoData[i]}" alt=""><button class="sk-photo-remove" onclick="event.stopPropagation();skRemovePhoto(${i})">âœ•</button>`;
    } else {
      slot.innerHTML = 'ï¼‹';
    }
  });
}

function skSubmitListing() {
  if (!document.getElementById('skTerms').checked) { showToast('Please agree to Terms & Conditions'); return; }
  if (!isSignedIn()) { showToast('Please sign in'); return; }

  const mobile = document.getElementById('skMobile').value.trim();
  const waSame = document.getElementById('skWASame').checked;

  const listing = {
    id: _skEditingId || ('sk_' + Date.now() + '_' + Math.random().toString(36).substr(2,5)),
    bizName: document.getElementById('skBizName').value.trim(),
    contactName: document.getElementById('skContactName').value.trim(),
    mobile: mobile,
    whatsapp: waSame ? mobile : (document.getElementById('skWA').value.trim() || mobile),
    email: document.getElementById('skEmail').value.trim(),
    city: document.getElementById('skCity').value.trim(),
    category: document.getElementById('skCategory').value,
    shortDesc: document.getElementById('skShortDesc').value.trim(),
    fullDesc: document.getElementById('skFullDesc').value.trim(),
    years: document.getElementById('skYears').value || '',
    website: document.getElementById('skWebsite').value.trim(),
    photos: _skPhotoData.filter(Boolean),
    ownerEmail: gUser.email.toLowerCase(),
    ownerName: gUser.name || '',
    status: 'pending',
    verified: false,
    createdAt: new Date().toISOString(),
  };

  if (_skEditingId) {
    const idx = skListings.findIndex(l => l.id === _skEditingId);
    if (idx >= 0) {
      listing.status = skListings[idx].status;
      listing.verified = skListings[idx].verified;
      listing.createdAt = skListings[idx].createdAt;
      skListings[idx] = listing;
    }
  } else {
    skListings.push(listing);
  }

  _skSave();
  closeModal('skListModal');
  showToast(_skEditingId ? 'Listing updated âœ“' : 'Listing submitted for approval âœ“');
  skRenderHome();
}

// ---- Reviews ----
function skOpenReview() {
  if (!isSignedIn()) { showToast('Please sign in'); return; }
  _skReviewRating = 0;
  document.getElementById('skReviewText').value = '';
  document.querySelectorAll('#skReviewStars span').forEach(s => { s.textContent = 'â˜†'; s.classList.remove('filled'); });
  document.getElementById('skReviewModal').classList.add('open');
}

function skSetReviewRating(n) {
  _skReviewRating = n;
  document.querySelectorAll('#skReviewStars span').forEach((s,i) => {
    s.textContent = i < n ? 'â˜…' : 'â˜†';
    s.classList.toggle('filled', i < n);
  });
}

function skSubmitReview() {
  if (!_skReviewRating) { showToast('Please select a rating'); return; }
  if (!isSignedIn()) { showToast('Please sign in'); return; }
  const email = gUser.email.toLowerCase();

  // Check one review per user
  if (skReviews.some(r => r.listingId === _skViewingId && r.userEmail === email)) {
    showToast('You have already reviewed this listing'); return;
  }

  const review = {
    id: 'rv_' + Date.now(),
    listingId: _skViewingId,
    userEmail: email,
    userName: gUser.name || 'Devotee',
    rating: _skReviewRating,
    text: document.getElementById('skReviewText').value.trim(),
    date: new Date().toLocaleDateString('en-IN', {day:'numeric',month:'short',year:'numeric'}),
  };

  skReviews.push(review);
  _skSave();
  closeModal('skReviewModal');
  showToast('Review submitted âœ“');
  skOpenDetail(_skViewingId);
}

// ---- Reports ----
function skOpenReport() {
  if (!isSignedIn()) { showToast('Please sign in to report'); return; }
  document.getElementById('skReportReason').value = '';
  document.getElementById('skReportDetails').value = '';
  document.getElementById('skReportModal').classList.add('open');
}

function skSubmitReport() {
  const reason = document.getElementById('skReportReason').value;
  if (!reason) { showToast('Please select a reason'); return; }

  const report = {
    id: 'rp_' + Date.now(),
    listingId: _skViewingId,
    reason: reason,
    details: document.getElementById('skReportDetails').value.trim(),
    reportedBy: gUser?.email || 'anonymous',
    date: new Date().toISOString(),
    resolved: false,
  };

  skReports.push(report);
  _skSave();
  closeModal('skReportModal');
  showToast('Report submitted. Thank you.');
}

// Fetch SevaKart data on load
setTimeout(_skFetchFromServer, 2000);

// ===================================================================
// ===== CENTRALIZED ADMIN DASHBOARD =====
function renderAdminDashboard() {
  if (!isAdmin()) return;

  // Gather data from all features
  const sections = [];

  // --- SevaKart ---
  if (hasPermission('sevakart') || isAdmin()) {
    const skPending = (typeof skListings !== 'undefined') ? skListings.filter(l => l.status === 'pending') : [];
    const skApproved = (typeof skListings !== 'undefined') ? skListings.filter(l => l.status === 'approved') : [];
    const skVerified = (typeof skListings !== 'undefined') ? skListings.filter(l => l.verified) : [];
    const skRep = (typeof skReports !== 'undefined') ? skReports.filter(r => !r.resolved) : [];
    const skTotal = (typeof skListings !== 'undefined') ? skListings.length : 0;

    sections.push({
      id: 'sevakart',
      icon: 'ðŸª”',
      iconClass: 'sevakart',
      name: 'SevaKart',
      pendingCount: skPending.length,
      stats: [
        { num: skTotal, label: 'Total', cls: '' },
        { num: skPending.length, label: 'Pending', cls: skPending.length ? 'pending' : '' },
        { num: skVerified.length, label: 'Verified', cls: 'ok' },
        { num: skRep.length, label: 'Reported', cls: skRep.length ? 'pending' : '' }
      ],
      actions: [
        { label: 'ðŸ“ Pending Listings', onclick: 'skShowPendingListings()', primary: true },
        { label: 'ðŸš© Reported', onclick: 'skShowReportedListings()', primary: false }
      ],
      pendingItems: skPending.slice(0, 5).map(l => ({
        name: l.bizName || 'Untitled',
        meta: l.category + ' Â· ' + l.city,
        approveAction: `skOpenDetail('${l.id}')`,
        isLink: true
      }))
    });
  }

  // --- Prayer Circle ---
  if (hasPermission('prayer') || isAdmin()) {
    const pcPending = pcRequests.filter(r => r.status === 'pending');
    const pcApproved = pcRequests.filter(r => r.status === 'approved');
    const pcAnswered = pcRequests.filter(r => r.answered);
    const pcRep = pcReports.filter(r => !r.resolved);
    const pcTotal = pcRequests.length;

    sections.push({
      id: 'prayer',
      icon: 'ðŸ™',
      iconClass: 'prayer',
      name: 'Prayer Circle',
      pendingCount: pcPending.length,
      stats: [
        { num: pcTotal, label: 'Total', cls: '' },
        { num: pcPending.length, label: 'Pending', cls: pcPending.length ? 'pending' : '' },
        { num: pcAnswered.length, label: 'Answered', cls: 'ok' },
        { num: pcRep.length, label: 'Reported', cls: pcRep.length ? 'pending' : '' }
      ],
      actions: [
        { label: 'ðŸ“ Pending Prayers', onclick: 'pcShowPending()', primary: true },
        { label: 'ðŸš© Reported', onclick: 'pcShowReported()', primary: false }
      ],
      pendingItems: pcPending.slice(0, 5).map(r => ({
        id: r.id,
        name: r.title || 'Untitled',
        meta: r.category + ' Â· by ' + (r.anonymous ? 'Anonymous' : r.name),
        approveAction: `pcAdminApprove('${r.id}')`,
        rejectAction: `pcAdminStartReject('${r.id}')`,
        isLink: false
      }))
    });
  }

  // Update summary
  const totalPending = sections.reduce((s, sec) => s + sec.pendingCount, 0);
  const totalReported = sections.reduce((s, sec) => {
    const repStat = sec.stats.find(st => st.label === 'Reported');
    return s + (repStat ? repStat.num : 0);
  }, 0);
  const totalApproved = sections.reduce((s, sec) => {
    const appStat = sec.stats.find(st => st.label === 'Total');
    return s + (appStat ? appStat.num : 0);
  }, 0);

  document.getElementById('admTotalPending').textContent = totalPending;
  document.getElementById('admTotalPending').className = 'adm-summary-num' + (totalPending > 0 ? ' pending' : ' ok');
  document.getElementById('admTotalReported').textContent = totalReported;
  document.getElementById('admTotalApproved').textContent = totalApproved;

  // Render sections
  const container = document.getElementById('admSectionsContainer');
  if (!sections.length) {
    container.innerHTML = '<div class="adm-empty">No features assigned to your admin role.</div>';
    return;
  }

  container.innerHTML = sections.map(sec => `
    <div class="adm-section${sec.pendingCount > 0 ? ' expanded' : ''}" id="admSec-${sec.id}">
      <div class="adm-section-header" onclick="admToggleSection('${sec.id}')">
        <div class="adm-section-icon ${sec.iconClass}">${sec.icon}</div>
        <div class="adm-section-info">
          <div class="adm-section-name">${sec.name}</div>
          <div class="adm-section-status">${sec.pendingCount > 0 ? sec.pendingCount + ' pending approval' : 'All clear âœ“'}</div>
        </div>
        <div class="adm-section-badge ${sec.pendingCount === 0 ? 'zero' : ''}">${sec.pendingCount}</div>
        <div class="adm-section-arrow">â–¼</div>
      </div>
      <div class="adm-section-body">
        <div class="adm-section-content">
          <div class="adm-stats">
            ${sec.stats.map(st => `
              <div class="adm-stat">
                <div class="adm-stat-num" ${st.cls ? 'style="color:' + (st.cls === 'pending' ? '#f39c12' : st.cls === 'ok' ? '#2ecc71' : 'var(--text)') + '"' : ''}>${st.num}</div>
                <div class="adm-stat-lbl">${st.label}</div>
              </div>
            `).join('')}
          </div>
          <div class="adm-actions">
            ${sec.actions.map(a => `
              <button class="adm-action-btn${a.primary ? ' primary' : ''}" onclick="${a.onclick}">${a.label}</button>
            `).join('')}
          </div>
          ${sec.pendingItems.length > 0 ? `
            <div class="adm-pending-list">
              <div style="font-size:0.7rem;font-weight:600;color:var(--text3);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;">Recent Pending</div>
              ${sec.pendingItems.map(item => `
                <div class="adm-pending-item" ${item.isLink ? `onclick="${item.approveAction}"` : ''}>
                  <div class="adm-pending-item-info">
                    <div class="adm-pending-item-name">${item.name}</div>
                    <div class="adm-pending-item-meta">${item.meta}</div>
                  </div>
                  ${!item.isLink ? `
                    <div class="adm-pending-item-actions">
                      <button class="adm-pending-approve" onclick="event.stopPropagation();${item.approveAction};renderAdminDashboard()">âœ“</button>
                      <button class="adm-pending-reject" onclick="event.stopPropagation();${item.rejectAction}">âœ•</button>
                    </div>
                  ` : ''}
                </div>
              `).join('')}
            </div>
          ` : ''}
        </div>
      </div>
    </div>
  `).join('');

  // --- Users Section (only for admins with 'users' permission) ---
  if (hasPermission('users') || isSuperAdmin()) {
    const usersHtml = `
      <div class="adm-section expanded" id="admSec-users">
        <div class="adm-section-header" onclick="admToggleSection('users')">
          <div class="adm-section-icon users">ðŸ‘¥</div>
          <div class="adm-section-info">
            <div class="adm-section-name">App Users</div>
            <div class="adm-section-status" id="admUsersStatus">Loading...</div>
          </div>
          <div class="adm-section-badge zero" id="admUsersBadge">â€“</div>
          <div class="adm-section-arrow">â–¼</div>
        </div>
        <div class="adm-section-body">
          <div class="adm-section-content">
            <div class="adm-stats" id="admUsersStats">
              <div class="adm-stat"><div class="adm-stat-num" id="admUsTotal">â€“</div><div class="adm-stat-lbl">Total</div></div>
              <div class="adm-stat"><div class="adm-stat-num" style="color:#2ecc71" id="admUsActive">â€“</div><div class="adm-stat-lbl">Active</div></div>
              <div class="adm-stat"><div class="adm-stat-num" style="color:#f39c12" id="admUsInactive">â€“</div><div class="adm-stat-lbl">Inactive</div></div>
              <div class="adm-stat"><div class="adm-stat-num" style="color:var(--lavender)" id="admUsNew">â€“</div><div class="adm-stat-lbl">New (7d)</div></div>
            </div>
            <div class="adm-actions">
              <button class="adm-action-btn primary" onclick="switchScreen('userlist',null)" style="grid-column:1/-1;">ðŸ‘¥ View All Users</button>
            </div>
          </div>
        </div>
      </div>
    `;
    container.innerHTML += usersHtml;
    // Fetch user stats asynchronously
    admFetchUserStats();
  }
}

// Fetch user stats for admin dashboard summary
let _admCachedUsers = null;
async function admFetchUserStats() {
  try {
    const resp = await fetch(SONGS_API_URL + '?type=userStats');
    const data = await resp.json();
    if (!data.success) return;

    _admCachedUsers = data.users || [];
    const now = Date.now();
    const h24 = 24 * 60 * 60 * 1000;
    const d7 = 7 * 24 * 60 * 60 * 1000;
    const total = _admCachedUsers.length;
    const active = _admCachedUsers.filter(u => (now - new Date(u.lastSeen).getTime()) < h24).length;
    const inactive = total - active;
    const newUsers = _admCachedUsers.filter(u => (now - new Date(u.registered).getTime()) < d7).length;

    document.getElementById('admUsTotal').textContent = total;
    document.getElementById('admUsActive').textContent = active;
    document.getElementById('admUsInactive').textContent = inactive;
    document.getElementById('admUsNew').textContent = newUsers;
    document.getElementById('admUsersStatus').textContent = total + ' users Â· ' + active + ' active now';
    document.getElementById('admUsersBadge').textContent = total;
    document.getElementById('admUsersBadge').className = 'adm-section-badge zero';
  } catch(e) {
    document.getElementById('admUsersStatus').textContent = 'Failed to load';
  }
}

// ===== USER LIST SCREEN =====
let _ulFilter = 'all';
let _ulUsers = [];

async function ulFetchAndRender() {
  const container = document.getElementById('ulListContainer');
  container.innerHTML = '<div class="ul-empty">Loading user data...</div>';

  try {
    // Use cached data if available (from admin dashboard), else fetch fresh
    if (_admCachedUsers && _admCachedUsers.length) {
      _ulUsers = _admCachedUsers;
    } else {
      const resp = await fetch(SONGS_API_URL + '?type=userStats');
      const data = await resp.json();
      if (!data.success) throw new Error(data.error || 'Failed');
      _ulUsers = data.users || [];
      _admCachedUsers = _ulUsers;
    }

    _ulFilter = 'all';
    document.getElementById('ulSearchInput').value = '';
    ulRenderList();
  } catch(e) {
    container.innerHTML = '<div class="ul-empty">Failed to load user data. Please try again.</div>';
  }
}

function ulRenderList() {
  const now = Date.now();
  const h24 = 24 * 60 * 60 * 1000;
  const searchTerm = (document.getElementById('ulSearchInput')?.value || '').toLowerCase();

  // Classify users
  let users = _ulUsers.map(u => {
    const lastSeenMs = new Date(u.lastSeen).getTime();
    const registeredMs = new Date(u.registered).getTime();
    const isActive = (now - lastSeenMs) < h24;
    return { ...u, isActive, lastSeenMs, registeredMs };
  });

  // Filter
  if (_ulFilter === 'active') users = users.filter(u => u.isActive);
  if (_ulFilter === 'inactive') users = users.filter(u => !u.isActive);

  // Search
  if (searchTerm) {
    users = users.filter(u => (u.name || '').toLowerCase().includes(searchTerm) || (u.email || '').toLowerCase().includes(searchTerm));
  }

  // Sort: active first, then by last seen (most recent first)
  users.sort((a, b) => {
    if (a.isActive && !b.isActive) return -1;
    if (!a.isActive && b.isActive) return 1;
    return b.lastSeenMs - a.lastSeenMs;
  });

  // Update summary counts (always from full list)
  const allActive = _ulUsers.filter(u => (now - new Date(u.lastSeen).getTime()) < h24).length;
  document.getElementById('ulTotal').textContent = _ulUsers.length;
  document.getElementById('ulActive').textContent = allActive;
  document.getElementById('ulInactive').textContent = _ulUsers.length - allActive;

  // Update filter chip states
  document.querySelectorAll('.ul-filter-chip').forEach(c => {
    const f = c.textContent.includes('Active') && !c.textContent.includes('Inactive') ? 'active' :
              c.textContent.includes('Inactive') ? 'inactive' : 'all';
    c.classList.toggle('active', f === _ulFilter);
  });

  const container = document.getElementById('ulListContainer');
  if (!users.length) {
    container.innerHTML = '<div class="ul-empty">No users found</div>';
    return;
  }

  container.innerHTML = users.map(u => {
    const initial = (u.name || u.email || '?').charAt(0).toUpperCase();
    const displayName = u.name || u.email.split('@')[0];
    const lastSeenText = _ulTimeAgo(u.lastSeenMs);
    const joinedText = _ulTimeAgo(u.registeredMs);

    return `<div class="ul-user">
      <div class="ul-avatar ${u.isActive ? 'active-user' : 'inactive-user'}">${initial}</div>
      <div class="ul-user-info">
        <div class="ul-user-name">${displayName}</div>
        <div class="ul-user-email">${u.email}</div>
        <div class="ul-user-meta">
          <span class="ul-user-meta-item">Joined ${joinedText}</span>
        </div>
      </div>
      <div class="ul-user-right">
        <div class="ul-user-status ${u.isActive ? 'active' : 'inactive'}">${u.isActive ? 'Active' : 'Inactive'}</div>
        <div class="ul-user-lastseen">Last: ${lastSeenText}</div>
      </div>
    </div>`;
  }).join('');
}

function ulSetFilter(f) {
  _ulFilter = f;
  ulRenderList();
}

function ulFilterList() {
  ulRenderList();
}

function _ulTimeAgo(ms) {
  const diff = Date.now() - ms;
  const mins = Math.floor(diff / 60000);
  if (mins < 1) return 'Just now';
  if (mins < 60) return mins + 'm ago';
  const hrs = Math.floor(mins / 60);
  if (hrs < 24) return hrs + 'h ago';
  const days = Math.floor(hrs / 24);
  if (days < 30) return days + 'd ago';
  const months = Math.floor(days / 30);
  return months + 'mo ago';
}

function admToggleSection(id) {
  const sec = document.getElementById('admSec-' + id);
  if (sec) sec.classList.toggle('expanded');
}

// PRAYER CIRCLE
// ===================================================================
let pcRequests = JSON.parse(localStorage.getItem('pcRequests') || '[]');
let pcPrayers = JSON.parse(localStorage.getItem('pcPrayers') || '[]');
let pcReports = JSON.parse(localStorage.getItem('pcReports') || '[]');
let _pcCatFilter = '';
let _pcStatusFilter = '';  // '' | 'urgent' | 'answered' | 'pending'
let _pcCurrentDetailId = null;
let _pcWritePrayerId = null;
let _pcReportId = null;
let _pcRejectId = null;

const PC_CATEGORIES = ['Health','Family','Career','Spiritual Growth','Crisis','Other'];
const PC_CAT_ICONS = {Health:'ðŸ’š',Family:'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§',Career:'ðŸ’¼','Spiritual Growth':'ðŸ™',Crisis:'ðŸ†˜',Other:'ðŸ“¿'};
const PC_CAT_CLASS = {Health:'cat-health',Family:'cat-family',Career:'cat-career','Spiritual Growth':'cat-spiritual',Crisis:'cat-crisis',Other:'cat-other'};

function _pcGenId() {
  return 'PR-' + Date.now().toString(36).toUpperCase() + Math.random().toString(36).substring(2,6).toUpperCase();
}

function _pcTimeAgo(ts) {
  const diff = Date.now() - ts;
  const mins = Math.floor(diff/60000);
  if (mins < 1) return 'Just now';
  if (mins < 60) return mins + 'm ago';
  const hrs = Math.floor(mins/60);
  if (hrs < 24) return hrs + 'h ago';
  const days = Math.floor(hrs/24);
  if (days < 7) return days + 'd ago';
  return new Date(ts).toLocaleDateString('en-US', {month:'short', day:'numeric'});
}

function _pcSave() {
  localStorage.setItem('pcRequests', JSON.stringify(pcRequests));
  localStorage.setItem('pcPrayers', JSON.stringify(pcPrayers));
  localStorage.setItem('pcReports', JSON.stringify(pcReports));
  _pcSyncToServer();
}

async function _pcSyncToServer() {
  try {
    const userEmail = (gUser && gUser.email) ? gUser.email : '';
    await fetch(SONGS_API_URL, {
      method:'POST',
      headers:{'Content-Type':'text/plain'},
      body: JSON.stringify({
        action:'savePrayerCircle',
        requests: pcRequests,
        prayers: pcPrayers,
        reports: pcReports,
        updatedBy: userEmail
      })
    });
  } catch(e) { /* offline fallback */ }
}

async function _pcFetchFromServer() {
  try {
    const resp = await fetch(SONGS_API_URL + '?type=prayercircle');
    const data = await resp.json();
    if (data.success && data.requests) {
      pcRequests = data.requests;
      if (data.prayers) pcPrayers = data.prayers;
      if (data.reports) pcReports = data.reports;
      localStorage.setItem('pcRequests', JSON.stringify(pcRequests));
      localStorage.setItem('pcPrayers', JSON.stringify(pcPrayers));
      localStorage.setItem('pcReports', JSON.stringify(pcReports));
    }
  } catch(e) { /* offline - use localStorage */ }
}

// Content moderation filter
function _pcModerateContent(text) {
  const badWords = ['damn','hell','shit','fuck','ass','bitch','bastard','crap','hate','kill','die','stupid'];
  let clean = text;
  badWords.forEach(w => {
    const re = new RegExp('\\b' + w + '\\b', 'gi');
    clean = clean.replace(re, '*'.repeat(w.length));
  });
  return clean;
}

function pcOpenSubmitModal() {
  if (!gUser || !gUser.email) { showToast('Please sign in to submit a prayer request'); return; }
  // Reset form
  document.getElementById('pcReqName').value = (gUser && gUser.name) ? gUser.name : '';
  document.getElementById('pcReqName').disabled = false;
  document.getElementById('pcReqAnon').checked = false;
  document.getElementById('pcReqFor').value = 'self';
  document.getElementById('pcReqCategory').value = 'Health';
  document.getElementById('pcReqTitle').value = '';
  document.getElementById('pcReqDesc').value = '';
  document.getElementById('pcReqUrgency').value = 'normal';
  document.getElementById('pcReqConsent').checked = false;
  document.getElementById('pcSubmitModal').classList.add('open');
}

function pcSubmitRequest() {
  const name = document.getElementById('pcReqName').value.trim();
  const isAnon = document.getElementById('pcReqAnon').checked;
  const forWhom = document.getElementById('pcReqFor').value;
  const category = document.getElementById('pcReqCategory').value;
  const title = document.getElementById('pcReqTitle').value.trim();
  const desc = document.getElementById('pcReqDesc').value.trim();
  const urgency = document.getElementById('pcReqUrgency').value;
  const consent = document.getElementById('pcReqConsent').checked;

  if (!consent) { showToast('Please provide your consent to continue'); return; }
  if (!title) { showToast('Please enter a title for your prayer'); return; }
  if (!desc) { showToast('Please describe your prayer request'); return; }

  // Admins get auto-approved; non-admins need admin approval
  const isAdminUser = hasPermission('prayer') || isAdmin();
  const autoApprove = isAdminUser;

  const req = {
    id: _pcGenId(),
    name: isAnon ? 'Anonymous' : (name || 'A Devotee'),
    email: (gUser && gUser.email) ? gUser.email : '',
    anonymous: isAnon,
    forWhom,
    category,
    title: _pcModerateContent(title),
    description: _pcModerateContent(desc),
    urgency,
    public: true,
    status: autoApprove ? 'approved' : 'pending',
    prayedBy: [],
    timestamp: Date.now(),
    answered: false,
    updates: []
  };

  pcRequests.unshift(req);
  _pcSave();
  closeModal('pcSubmitModal');

  if (autoApprove) {
    showToast('ðŸ™ Prayer request published! ID: ' + req.id);
  } else {
    showToast('ðŸ™ Submitted! Your prayer will appear once approved by an admin. ID: ' + req.id);
  }
  pcRenderFeed();

  // In-app notification to signed-in users (simulated â€” real push via server)
  _pcNotifyNewRequest(req);
}

function _pcNotifyNewRequest(req) {
  // Only notify admins for pending requests
  if (req.status !== 'pending') return;

  // Build list of admin emails who have prayer permission
  const adminEmails = [];
  try {
    const allAdmins = _getAdminList();
    const perms = _getAdminPermissions();
    allAdmins.forEach(email => {
      const eLower = email.toLowerCase();
      // Super admin always gets notified
      if (eLower === SUPER_ADMIN_EMAIL.toLowerCase()) { adminEmails.push(eLower); return; }
      const userPerms = perms[eLower];
      // Legacy admins without specific perms, or admins with prayer perm
      if (!userPerms || userPerms.includes('prayer')) adminEmails.push(eLower);
    });
  } catch(e) { adminEmails.push(SUPER_ADMIN_EMAIL.toLowerCase()); }

  const displayName = req.anonymous ? 'A devotee' : req.name;
  const truncTitle = req.title.length > 60 ? req.title.substring(0, 57) + '...' : req.title;

  fetch(SONGS_API_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain' },
    body: JSON.stringify({
      action: 'notifyPrayerPending',
      adminEmails: adminEmails,
      title: 'ðŸ™ New Prayer Request Pending',
      body: displayName + ' has submitted a prayer request: "' + truncTitle + '". Please review and approve.',
      tag: 'prayer-pending-' + req.id
    })
  }).catch(e => {});
}

function _pcNotifyApproved(req) {
  const displayName = req.anonymous ? 'A devotee' : req.name;

  fetch(SONGS_API_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain' },
    body: JSON.stringify({
      action: 'notifyPrayerApproved',
      title: 'ðŸ™ New Prayer Request â€” Please Pray',
      body: displayName + ' is seeking prayers for ' + req.category + '. Open Prayer Circle to offer your support.',
      tag: 'prayer-approved-' + req.id
    })
  }).catch(e => {});
}

function _pcGetApprovedPublic() {
  return pcRequests.filter(r => r.status === 'approved');
}

function pcSetCatFilter(cat) {
  _pcCatFilter = cat;
  document.querySelectorAll('.pc-stat-chip').forEach(c => {
    c.classList.toggle('active', c.textContent.includes(cat) || (!cat && c.textContent === 'All'));
  });
  pcRenderFeed();
}

function pcCycleFilter() {
  const btn = document.querySelector('.pc-filter-btn');
  const filters = ['','urgent','answered','needs'];
  const labels = ['All â–¾','Urgent â–¾','Answered â–¾','Needs Prayer â–¾'];
  const idx = filters.indexOf(_pcStatusFilter);
  const next = (idx + 1) % filters.length;
  _pcStatusFilter = filters[next];
  btn.textContent = labels[next];
  pcRenderFeed();
}

function pcFilterFeed() {
  pcRenderFeed();
}

function pcRenderFeed() {
  const container = document.getElementById('pcFeedContainer');
  const empty = document.getElementById('pcEmptyState');
  const query = (document.getElementById('pcSearchInp')?.value || '').toLowerCase();

  let items = _pcGetApprovedPublic();

  // Apply category filter
  if (_pcCatFilter) items = items.filter(r => r.category === _pcCatFilter);

  // Apply status filter
  if (_pcStatusFilter === 'urgent') items = items.filter(r => r.urgency === 'urgent' && !r.answered);
  else if (_pcStatusFilter === 'answered') items = items.filter(r => r.answered);
  else if (_pcStatusFilter === 'needs') items = items.filter(r => !r.answered);

  // Apply search
  if (query) items = items.filter(r =>
    r.title.toLowerCase().includes(query) ||
    r.description.toLowerCase().includes(query) ||
    r.category.toLowerCase().includes(query) ||
    r.name.toLowerCase().includes(query)
  );

  // Sort: urgent first, then by timestamp
  items.sort((a,b) => {
    if (a.urgency === 'urgent' && b.urgency !== 'urgent' && !a.answered) return -1;
    if (b.urgency === 'urgent' && a.urgency !== 'urgent' && !b.answered) return 1;
    return b.timestamp - a.timestamp;
  });

  if (!items.length) {
    container.innerHTML = '';
    empty.style.display = '';
    return;
  }
  empty.style.display = 'none';

  const userEmail = (gUser && gUser.email) ? gUser.email.toLowerCase() : '';
  container.innerHTML = items.map(r => {
    const prayerCount = r.prayedBy ? r.prayedBy.length : 0;
    const hasPrayed = userEmail && r.prayedBy && r.prayedBy.includes(userEmail);
    const catClass = PC_CAT_CLASS[r.category] || 'cat-other';
    const catIcon = PC_CAT_ICONS[r.category] || 'ðŸ“¿';
    const cardClass = r.answered ? 'answered' : (r.urgency === 'urgent' ? 'urgent' : '');
    const avatar = r.anonymous ? 'ðŸ™' : (r.name ? r.name.charAt(0).toUpperCase() : 'ðŸ™');
    const writtenPrayers = pcPrayers.filter(p => p.requestId === r.id);

    return `<div class="pc-card ${cardClass}" onclick="pcOpenDetail('${r.id}')">
      <div class="pc-card-top">
        <div class="pc-card-avatar">${avatar}</div>
        <div class="pc-card-meta">
          <div class="pc-card-author">${r.anonymous ? 'Anonymous Devotee' : r.name}</div>
          <div class="pc-card-time">${_pcTimeAgo(r.timestamp)} Â· ${r.forWhom === 'self' ? 'For self' : 'For someone'}</div>
        </div>
      </div>
      <div class="pc-card-badges">
        <span class="pc-badge ${catClass}">${catIcon} ${r.category}</span>
        ${r.urgency==='urgent' && !r.answered ? '<span class="pc-badge urgent-tag">ðŸ”´ Urgent</span>' : ''}
        ${r.answered ? '<span class="pc-badge answered-tag">âœ… Prayer Answered</span>' : ''}
        ${!r.answered && r.updates && r.updates.some(u=>u.type==='update') ? '<span class="pc-badge needs-tag">ðŸ”„ Updated</span>' : ''}
      </div>
      <div class="pc-card-title">${r.title}</div>
      <div class="pc-card-desc">${r.description}</div>
      <div class="pc-card-footer" onclick="event.stopPropagation()">
        <button class="pc-pray-btn ${hasPrayed?'prayed':''}" onclick="event.stopPropagation();pcQuickPray('${r.id}')">
          ðŸ™ ${hasPrayed ? 'Prayed' : 'Offer Prayer'}
        </button>
        <button class="pc-write-btn" onclick="event.stopPropagation();pcOpenWritePrayer('${r.id}')">âœï¸ Write</button>
        <span class="pc-pray-count">${prayerCount} ðŸ™${writtenPrayers.length ? ' Â· ' + writtenPrayers.length + ' âœï¸' : ''}</span>
      </div>
    </div>`;
  }).join('');
}

function pcQuickPray(reqId) {
  if (!gUser || !gUser.email) { showToast('Please sign in to offer a prayer'); return; }
  const req = pcRequests.find(r => r.id === reqId);
  if (!req) return;
  const email = gUser.email.toLowerCase();
  if (!req.prayedBy) req.prayedBy = [];
  if (req.prayedBy.includes(email)) {
    showToast('You have already prayed for this request');
    return;
  }
  req.prayedBy.push(email);
  _pcSave();
  showToast('ðŸ™ Your prayer has been offered. Hare Krishna!');
  pcRenderFeed();
  if (_pcCurrentDetailId === reqId) pcRenderDetail(reqId);
}

function pcOpenWritePrayer(reqId) {
  if (!gUser || !gUser.email) { showToast('Please sign in to write a prayer'); return; }
  _pcWritePrayerId = reqId;
  document.getElementById('pcWritePrayerText').value = '';
  document.getElementById('pcWritePrayerModal').classList.add('open');
}

function pcSubmitWrittenPrayer() {
  const text = document.getElementById('pcWritePrayerText').value.trim();
  if (!text) { showToast('Please write your prayer'); return; }

  const prayer = {
    id: Date.now().toString(36),
    requestId: _pcWritePrayerId,
    author: gUser.name || 'A Devotee',
    email: gUser.email.toLowerCase(),
    text: _pcModerateContent(text),
    timestamp: Date.now()
  };

  pcPrayers.push(prayer);

  // Also count as a prayer
  const req = pcRequests.find(r => r.id === _pcWritePrayerId);
  if (req && !req.prayedBy.includes(gUser.email.toLowerCase())) {
    req.prayedBy.push(gUser.email.toLowerCase());
  }

  _pcSave();
  closeModal('pcWritePrayerModal');
  showToast('ðŸ™ Your prayer has been offered. Hare Krishna!');
  pcRenderFeed();
  if (_pcCurrentDetailId === _pcWritePrayerId) pcRenderDetail(_pcWritePrayerId);
}

function pcOpenDetail(reqId) {
  _pcCurrentDetailId = reqId;
  pcRenderDetail(reqId);
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-prayer-detail').classList.add('active');
  history.pushState({screen:'prayer-detail'}, '', '');
}

function pcRenderDetail(reqId) {
  const req = pcRequests.find(r => r.id === reqId);
  if (!req) return;
  const body = document.getElementById('pcDetailBody');
  const prayerCount = req.prayedBy ? req.prayedBy.length : 0;
  const userEmail = (gUser && gUser.email) ? gUser.email.toLowerCase() : '';
  const hasPrayed = userEmail && req.prayedBy && req.prayedBy.includes(userEmail);
  const isOwner = userEmail && req.email && req.email.toLowerCase() === userEmail;
  const isAdminUser = hasPermission('prayer');
  const catClass = PC_CAT_CLASS[req.category] || 'cat-other';
  const catIcon = PC_CAT_ICONS[req.category] || 'ðŸ“¿';
  const writtenPrayers = pcPrayers.filter(p => p.requestId === reqId);

  let html = `
    <div class="pc-detail-card">
      <div class="pc-card-top" style="margin-bottom:12px;">
        <div class="pc-card-avatar" style="width:38px;height:38px;font-size:1.1rem;">${req.anonymous ? 'ðŸ™' : (req.name ? req.name.charAt(0).toUpperCase() : 'ðŸ™')}</div>
        <div class="pc-card-meta">
          <div class="pc-card-author" style="font-size:0.82rem;">${req.anonymous ? 'Anonymous Devotee' : req.name}</div>
          <div class="pc-card-time">${_pcTimeAgo(req.timestamp)} Â· Prayer ID: ${req.id}</div>
        </div>
      </div>
      <div class="pc-card-badges" style="margin-bottom:12px;">
        <span class="pc-badge ${catClass}">${catIcon} ${req.category}</span>
        <span class="pc-badge" style="background:rgba(255,255,255,0.06);color:var(--text2);">${req.forWhom === 'self' ? 'ðŸ§˜ For Self' : 'ðŸ’› For Someone Else'}</span>
        ${req.urgency==='urgent' && !req.answered ? '<span class="pc-badge urgent-tag">ðŸ”´ Urgent</span>' : ''}
        ${req.answered ? '<span class="pc-badge answered-tag">âœ… Prayer Answered</span>' : ''}
      </div>
      <div class="pc-detail-title">${req.title}</div>
      <div class="pc-detail-desc">${req.description}</div>
      <div style="font-size:0.72rem;color:var(--text3);margin-bottom:14px;">${prayerCount} devotee${prayerCount!==1?'s':''} prayed Â· ${writtenPrayers.length} written prayer${writtenPrayers.length!==1?'s':''}</div>
      <div class="pc-detail-actions">
        <button class="pc-detail-pray-btn ${hasPrayed?'prayed':''}" onclick="pcQuickPray('${req.id}')">
          ðŸ™ ${hasPrayed ? 'Already Prayed' : 'Offer Prayer'}
        </button>
        <button class="pc-write-btn" style="padding:12px 16px;" onclick="pcOpenWritePrayer('${req.id}')">âœï¸ Write a Prayer</button>
      </div>
    </div>`;

  // Written prayers
  if (writtenPrayers.length) {
    html += `<div class="pc-prayers-section">
      <div class="pc-prayers-title">âœï¸ Written Prayers (${writtenPrayers.length})</div>
      ${writtenPrayers.map(p => `
        <div class="pc-prayer-item">
          <div class="pc-prayer-author">${p.author}</div>
          <div class="pc-prayer-text">"${p.text}"</div>
          <div class="pc-prayer-time">${_pcTimeAgo(p.timestamp)}</div>
        </div>
      `).join('')}
    </div>`;
  }

  // Updates
  if (req.updates && req.updates.length) {
    html += `<div class="pc-updates-section">
      <div class="pc-prayers-title">ðŸ’¬ Updates</div>
      ${req.updates.map(u => `
        <div class="pc-update-item">
          <div class="pc-update-type">${u.type === 'gratitude' ? 'ðŸ’› Gratitude' : 'ðŸ”„ Update'}</div>
          <div class="pc-update-text">${u.text}</div>
          <div class="pc-update-time">${_pcTimeAgo(u.timestamp)}</div>
        </div>
      `).join('')}
    </div>`;
  }

  // Owner actions
  if (isOwner && !req.answered) {
    html += `<div class="pc-owner-actions">
      <div class="pc-owner-title">Your Request â€” Update Status</div>
      <div class="pc-owner-btns">
        <button class="pc-owner-btn answered" onclick="pcMarkAnswered('${req.id}')">âœ… Prayer Answered</button>
        <button class="pc-owner-btn" onclick="pcOpenUpdateModal('${req.id}')">ðŸ’¬ Post Update</button>
      </div>
    </div>`;
  } else if (isOwner && req.answered) {
    html += `<div class="pc-owner-actions">
      <div class="pc-owner-title">Your Request â€” Status</div>
      <div class="pc-owner-btns">
        <button class="pc-owner-btn" onclick="pcMarkNeedsPrayers('${req.id}')">ðŸ™ Still Need Prayers</button>
        <button class="pc-owner-btn" onclick="pcOpenUpdateModal('${req.id}')">ðŸ’¬ Post Gratitude</button>
      </div>
    </div>`;
  }

  // Admin actions
  if (isAdminUser) {
    html += `<div class="pc-admin-section" style="margin-top:16px;">
      <div class="pc-admin-title">ðŸ›¡ï¸ Admin Actions</div>
      <div class="pc-admin-btns">
        ${req.status!=='approved' ? `<button class="pc-admin-btn" onclick="pcAdminApprove('${req.id}')">âœ… Approve</button>` : ''}
        <button class="pc-admin-btn" onclick="pcAdminStartReject('${req.id}')">âŒ Reject</button>
        <button class="pc-admin-btn" onclick="pcAdminHighlight('${req.id}')">${req.urgency==='urgent'?'Remove Urgent':'âš¡ Mark Urgent'}</button>
        <button class="pc-admin-btn" onclick="pcAdminRemove('${req.id}')">ðŸ—‘ï¸ Remove</button>
      </div>
    </div>`;
  }

  // Report button
  html += `<button class="pc-report-btn" onclick="pcOpenReport('${req.id}')">ðŸš© Report this request</button>`;

  body.innerHTML = html;
}

function pcCloseDetail() {
  _pcCurrentDetailId = null;
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-prayer').classList.add('active');
  pcRenderFeed();
}

function pcMarkAnswered(reqId) {
  const req = pcRequests.find(r => r.id === reqId);
  if (!req) return;
  req.answered = true;
  req.answeredAt = Date.now();
  _pcSave();
  showToast('âœ… Marked as Prayer Answered!');
  pcRenderDetail(reqId);
}

function pcMarkNeedsPrayers(reqId) {
  const req = pcRequests.find(r => r.id === reqId);
  if (!req) return;
  req.answered = false;
  _pcSave();
  showToast('ðŸ™ Marked as Still Needing Prayers');
  pcRenderDetail(reqId);
}

function pcOpenUpdateModal(reqId) {
  _pcCurrentDetailId = reqId;
  document.getElementById('pcUpdateType').value = 'update';
  document.getElementById('pcUpdateText').value = '';
  document.getElementById('pcUpdateModal').classList.add('open');
}

function pcSubmitUpdate() {
  const type = document.getElementById('pcUpdateType').value;
  const text = document.getElementById('pcUpdateText').value.trim();
  if (!text) { showToast('Please enter your message'); return; }

  const req = pcRequests.find(r => r.id === _pcCurrentDetailId);
  if (!req) return;
  if (!req.updates) req.updates = [];
  req.updates.push({
    type,
    text: _pcModerateContent(text),
    timestamp: Date.now()
  });
  _pcSave();
  closeModal('pcUpdateModal');
  showToast(type === 'gratitude' ? 'ðŸ’› Gratitude posted!' : 'ðŸ’¬ Update posted!');
  pcRenderDetail(_pcCurrentDetailId);
}

function pcOpenReport(reqId) {
  _pcReportId = reqId;
  document.getElementById('pcReportReason').value = 'inappropriate';
  document.getElementById('pcReportDetails').value = '';
  document.getElementById('pcReportModal').classList.add('open');
}

function pcSubmitReport() {
  const reason = document.getElementById('pcReportReason').value;
  const details = document.getElementById('pcReportDetails').value.trim();
  const report = {
    id: Date.now().toString(36),
    requestId: _pcReportId,
    reason,
    details,
    email: (gUser && gUser.email) ? gUser.email : '',
    timestamp: Date.now(),
    resolved: false
  };
  pcReports.push(report);
  _pcSave();
  closeModal('pcReportModal');
  showToast('ðŸš© Report submitted. Thank you.');
}

// My requests
function pcShowMyRequests() {
  if (!gUser || !gUser.email) { showToast('Please sign in to view your requests'); return; }
  const email = gUser.email.toLowerCase();
  const myReqs = pcRequests.filter(r => r.email && r.email.toLowerCase() === email);

  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-prayer-my').classList.add('active');
  history.pushState({screen:'prayer-my'}, '', '');

  const container = document.getElementById('pcMyRequestsContainer');
  if (!myReqs.length) {
    container.innerHTML = '<div class="pc-empty"><div class="pc-empty-icon">ðŸ“‹</div><div class="pc-empty-text">You haven\'t submitted any prayer requests yet.</div></div>';
    return;
  }

  container.innerHTML = myReqs.map(r => {
    const prayerCount = r.prayedBy ? r.prayedBy.length : 0;
    const catIcon = PC_CAT_ICONS[r.category] || 'ðŸ“¿';
    return `<div class="pc-card ${r.answered?'answered':r.urgency==='urgent'?'urgent':''}" onclick="pcOpenDetail('${r.id}')" style="margin-bottom:10px;">
      <div class="pc-card-badges">
        <span class="pc-badge ${PC_CAT_CLASS[r.category]||'cat-other'}">${catIcon} ${r.category}</span>
        ${r.answered ? '<span class="pc-badge answered-tag">âœ… Answered</span>' : ''}
        ${r.status==='pending' ? '<span class="pc-badge needs-tag">â³ Pending Review</span>' : ''}
        ${r.status==='rejected' ? '<span class="pc-badge urgent-tag">âŒ Rejected</span>' : ''}
      </div>
      <div class="pc-card-title">${r.title}</div>
      <div class="pc-card-time">${_pcTimeAgo(r.timestamp)} Â· ${prayerCount} ðŸ™</div>
    </div>`;
  }).join('');
}

function pcBackToMain() {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-prayer').classList.add('active');
  pcRenderFeed();
}

// Admin functions
function pcShowPending() {
  _pcStatusFilter = '';
  _pcCatFilter = '';
  const allPending = pcRequests.filter(r => r.status === 'pending');
  const container = document.getElementById('pcFeedContainer');
  const empty = document.getElementById('pcEmptyState');
  if (!allPending.length) {
    container.innerHTML = '';
    empty.style.display = '';
    return;
  }
  empty.style.display = 'none';
  container.innerHTML = allPending.map(r => {
    const catIcon = PC_CAT_ICONS[r.category] || 'ðŸ“¿';
    return `<div class="pc-card" onclick="pcOpenDetail('${r.id}')" style="margin-bottom:10px;">
      <div class="pc-card-badges">
        <span class="pc-badge ${PC_CAT_CLASS[r.category]||'cat-other'}">${catIcon} ${r.category}</span>
        <span class="pc-badge needs-tag">â³ Pending</span>
      </div>
      <div class="pc-card-title">${r.title}</div>
      <div class="pc-card-desc">${r.description}</div>
      <div style="display:flex;gap:8px;margin-top:10px;">
        <button class="pc-action-btn" onclick="event.stopPropagation();pcAdminApprove('${r.id}')" style="padding:8px 14px;font-size:0.72rem;">âœ… Approve</button>
        <button class="pc-action-btn secondary" onclick="event.stopPropagation();pcAdminStartReject('${r.id}')" style="padding:8px 14px;font-size:0.72rem;">âŒ Reject</button>
      </div>
    </div>`;
  }).join('');
}

function pcShowReported() {
  const unresolvedReports = pcReports.filter(r => !r.resolved);
  const container = document.getElementById('pcFeedContainer');
  const empty = document.getElementById('pcEmptyState');
  if (!unresolvedReports.length) {
    container.innerHTML = '';
    empty.style.display = '';
    empty.querySelector('.pc-empty-text').textContent = 'No reported content.';
    return;
  }
  empty.style.display = 'none';
  container.innerHTML = unresolvedReports.map(rpt => {
    const req = pcRequests.find(r => r.id === rpt.requestId);
    if (!req) return '';
    return `<div class="pc-card" style="margin-bottom:10px;border-color:rgba(192,57,43,0.3);">
      <div class="pc-card-badges">
        <span class="pc-badge urgent-tag">ðŸš© ${rpt.reason}</span>
      </div>
      <div class="pc-card-title">${req.title}</div>
      <div class="pc-card-desc">${rpt.details || 'No details provided'}</div>
      <div style="display:flex;gap:8px;margin-top:10px;">
        <button class="pc-action-btn secondary" onclick="pcOpenDetail('${req.id}')" style="padding:8px 14px;font-size:0.72rem;">View Request</button>
        <button class="pc-action-btn secondary" onclick="pcResolveReport('${rpt.id}')" style="padding:8px 14px;font-size:0.72rem;">âœ“ Resolve</button>
      </div>
    </div>`;
  }).join('');
}

function pcResolveReport(reportId) {
  const rpt = pcReports.find(r => r.id === reportId);
  if (rpt) rpt.resolved = true;
  _pcSave();
  showToast('Report resolved');
  pcShowReported();
}

function pcAdminApprove(reqId) {
  const req = pcRequests.find(r => r.id === reqId);
  if (!req) return;
  req.status = 'approved';
  _pcSave();
  showToast('âœ… Prayer request approved');
  pcRenderFeed();
  if (_pcCurrentDetailId === reqId) pcRenderDetail(reqId);

  // Send push notification to all signed-in users
  _pcNotifyApproved(req);
}

function pcAdminStartReject(reqId) {
  _pcRejectId = reqId;
  document.getElementById('pcRejectReason').value = '';
  document.getElementById('pcAdminRejectModal').classList.add('open');
}

function pcAdminReject() {
  const reason = document.getElementById('pcRejectReason').value.trim();
  const req = pcRequests.find(r => r.id === _pcRejectId);
  if (!req) return;
  req.status = 'rejected';
  req.rejectReason = reason;
  _pcSave();
  closeModal('pcAdminRejectModal');
  showToast('âŒ Prayer request rejected');
  pcRenderFeed();
}

function pcAdminHighlight(reqId) {
  const req = pcRequests.find(r => r.id === reqId);
  if (!req) return;
  req.urgency = req.urgency === 'urgent' ? 'normal' : 'urgent';
  _pcSave();
  showToast(req.urgency === 'urgent' ? 'âš¡ Marked as urgent' : 'Urgency removed');
  pcRenderDetail(reqId);
}

function pcAdminRemove(reqId) {
  if (!confirm('Are you sure you want to remove this prayer request?')) return;
  pcRequests = pcRequests.filter(r => r.id !== reqId);
  _pcSave();
  showToast('Prayer request removed');
  pcCloseDetail();
}

// Fetch prayer circle data on load
setTimeout(_pcFetchFromServer, 2500);

function init() {
  // Load settings
  const s = JSON.parse(localStorage.getItem('settings')||'{}');
  Object.entries(s).forEach(([k,v])=>{ const el=document.getElementById(k); if(el)el.checked=v; });

  initJumpSelects();
  renderCalendar();

  // Restore Google session and update admin UI
  restoreGoogleSession();
  updateAdminUI();

  // Select today
  const td = new Date();
  curYear=td.getFullYear(); curMonth=td.getMonth();
  selectDay(td);
  startAlertTicker();

  // Start on home screen â€” hide header, show brand bar
  const header = document.querySelector('.header');
  if (header) header.style.display = 'none';
  updateHomeScreen();

  // Check if app was updated since last visit
  checkForAppUpdate();
}

init();
</script>

<!-- PWA Service Worker Registration -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js')
      .then(reg => {
        console.log('[PWA] Service Worker registered, scope:', reg.scope);
        // Check for updates
        reg.addEventListener('updatefound', () => {
          const newWorker = reg.installing;
          newWorker.addEventListener('statechange', () => {
            if (newWorker.state === 'activated') {
              showToast('App updated! Refresh for latest version.');
            }
          });
        });
      })
      .catch(() => {}); // SW only works on deployed site
  });
}
</script>
</body>
</html>
